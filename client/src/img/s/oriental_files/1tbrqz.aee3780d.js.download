(this.$WP=this.$WP||[]).push(["1tbrqz",(e,i)=>{var t,o,a,r,n,l,d,s,c,u,p,m,h,_,v,E,g,R,C,T,w,I,f,S,y,b,N,P,k,O,A,D,U,M,L,V,W,x,B,z,F,H,G,q,Y,j,K,$,Q,X,J,Z,ee,ei,et,eo,ea,er,en,el,ed,es,ec,eu,ep,em,eh,e_,ev,eE,eg,eR,eC,eT,ew,eI,ef,eS,ey,eb,eN,eP,ek,eO,eA,eD,eU,eM,eL,eV,eW,ex,eB,ez,eF,eH,eG={__key:34789774465105,id:"1fa420261851c634f3095a8a0797ec69",loc:{},definitions:[]},eq=e=>{var[,i]=p(eG),t=o((e,t,o,a,r)=>{e[r]?.caption?i({textsToModerate:[{checks:["PROFANITY"],text:e[r].caption}]}).then(i=>{!function(i){var n=i.data?.TextPreModeration_moderateBatchV2;if(n?.length===1){if(n[0]?.decision==="NOT_OK"&&n[0].results?.some(e=>e?.check==="PROFANITY"&&"PRESENT"===e.classification)){var l=n[0].results.find(e=>e?.check==="PROFANITY"&&"PRESENT"===e.classification)?.tokens;t(e.map(i=>i.id===e[r]?.id?{...i,hasProfanity:null!=l,profanityTokens:l}:i))}else o(a)}else o(a)}(i)}):o(a)},[i]),a=o((e,t,o,a)=>{var r=e.map(e=>({checks:["PROFANITY"],text:e.caption}));r?.some(e=>e?.text?.length>0)?i({textsToModerate:r}).then(i=>{!function(i){var r=i.data?.TextPreModeration_moderateBatchV2;if(r){var n=[];r.forEach((i,t)=>{var o=i?.results?.find(e=>e?.check==="PROFANITY"&&"PRESENT"===e.classification)?.tokens;n.push({...e[t],hasProfanity:null!=o,profanityTokens:o})}),t(n)}else o(a)}(i)}):o(a)},[i]);return o((i,o=()=>{},r=null,n=null)=>n?t(e,i,o,r,n):a(e,i,o,r),[t,a,e])},eY={container:"BlJbG",card:"UEqmh Gi Pj PX Pw PJ",thumbnail:"uSrYC",menuTriggerContainer:"xgqOf",menuTrigger:"BMEVx",imagesBelowContainer:"yYpQb Mk",likesContainer:"SYFFK u",title:"o",subTitle:"o",textContainer:"YUuQs",content:"I",textElipssis:"o W q"},ej=e=>{var{locationTitle:i,locationSubtitle:t,thumbnails:o,rating:r,variant:n,useCardStyle:l,upvotes:d,menuActions:s,onRatingClick:c,onCardClick:u,link:p}=e,{localize:m}=I(),[v,E]=a(r||0),g=h("div",{className:l?eY.card:void 0,children:_("div",{className:eY.container,children:[o&&"imageLeft"===n&&h("div",{className:eY.thumbnail,children:h(N,{source:o[0]?.source,height:"100%",width:"100%",aspectRatio:"1:1"})}),_("div",{className:eY.content,children:[_("div",{className:eY.textContainer,children:[h("div",{className:eY.title,children:h(T,{variant:"title-04",children:h("div",{className:eY.textElipssis,children:i})})}),s&&h("div",{className:eY.menuTriggerContainer,children:h("div",{className:eY.menuTrigger,children:h(A,{options:s,menuVariant:"trailing-top-caret",label:m.string("sng_review_options"),mode:"menu",fullscreenMobile:!0,trigger:({active:e,onKeyDown:i,ariaAttributes:t,ref:o,onClick:a})=>h(R,{ref:o,ariaAttributes:t,onKeyDown:e=>{e.preventDefault(),i&&i(e)},variant:"clear",icon:P,size:"small","aria-label":e?m.string("sng_close_options_menu"):m.string("sng_open_options_menu"),onClick:e=>{e.preventDefault(),a&&a(e),u&&u()}})})})})]}),h("div",{className:eY.textContainer,children:h("div",{className:eY.subTitle,children:h(T,{marginY:"spacing-01",variant:"supporting-01",children:h("div",{className:eY.textElipssis,children:t})})})}),c&&h("div",{onClick:e=>e.stopPropagation(),role:"presentation",children:h(k,{name:"Traveler rating",rating:v,showRatingLabel:!1,onClick:(e,i)=>{E(i),c&&c(i),u&&u()},size:"large"})}),void 0!==d&&d>0&&h(T,{marginY:"spacing-01",variant:"supporting-01",children:_("span",{className:eY.likesContainer,children:[h(b,{size:14}),m.string("user_review_found_this_helpful",{number:d})]})}),o&&"imagesBelow"===n&&h("div",{className:eY.imagesBelowContainer,children:o.map(e=>h(N,{source:e.source,width:50,height:50},e.id))})]})]})});return p?h(D,{theme:"none",onClick:()=>{u&&u()},href:p,children:g}):g},eK=({title:e,items:i,options:t,desktopLayoutColumns:o="three-columns",initialItemsToShow:l,itemsToShowMultiplier:d,onShowMoreClick:s})=>{var{localize:c}=I(),u=y(),[p,m]=a(l),g=r(()=>p?i.slice(0,p):i,[i,p]),R=void 0!==p&&i.length>p;return n(()=>{window.scrollTo({top:0,left:0,behavior:"smooth"})},["MOBILE"===u]),_(v,{children:[Array.isArray(e)?h("div",{className:"IZNJo _T",children:h("div",{className:"nYPXR",children:e.map(e=>h("span",{children:h(T,{marginBottom:"spacing-04",variant:"title-03",children:e})},e))})}):h(T,{marginBottom:"spacing-04",variant:"title-03",children:e}),h("div",{className:E("nKQoO",{PLXqA:"two-columns"===o,woNgg:"three-columns"===o}),children:g.map(e=>h(ed,{...t,...e},e.id))}),d&&R&&_(C,{onClick:()=>{s&&s(),m(p+d)},marginTop:"spacing-04",children:[c("airm_mobile_show_more")," "]})]})},e$={__key:0x9eaef4d8c8d,id:"09eaef4d8c8d109b78d6b315c709efb5",loc:{},definitions:[]},eQ={container:"FYdsq B1 Z BB Pk PY Px PK"},eX={__key:0x6c2b3b469db6,id:"6c2b3b469db6d51fe56c93bd224a1fc7",loc:{},definitions:[]},eJ=e=>{var{photos:i,rating:t,locationId:o,travelDate:a,tripType:r,content:n,title:l,questionsAndAnswers:d}=e;return{rating:t,locationId:o,travelDate:a,tripType:r,content:n,title:l,questionsAndAnswers:d,photoIds:i?.map(e=>e.id),photoCaptions:i?.map(e=>e.caption),photoCategories:i?.map(e=>e.categoryId)}},eZ=()=>{var[,e]=p(eX),i="MOBILE"===y(),t=U(),a=f();return o(o=>e({locale:a,taUnique:t,mobile:i,ipAddress:"",...eJ(o)}),[e,a,t,i])},e0=({desktopLayoutColumns:e,hideBorder:i,title:t,initialItemsToShow:o,itemsToShowMultiplier:a,onCardClick:r})=>{var n=M(),l=ec(),[{data:d}]=m({query:e$,variables:{userId:n||""},requestPolicy:"cache-and-network"}),s=d?.ReviewsProxy_getSuggestedLocationsToReviewForUser?.[0]?.suggestedLocations?.flat()?.filter(Boolean)?.filter(e=>e?.locationId)?.map(e=>({id:e.locationId,locationTitle:h(D,{theme:"standalone",target:"_blank",href:e.location?.url||"",children:e.location?.localizedName}),locationSubtitle:e.location?.parent?.additionalNames?.long,writeUserReviewUrl:e.location?.writeUserReviewUrl,thumbnails:e.location?.thumbnail?[{id:e.location.thumbnail.id||0,source:e.location.thumbnail.photoSizes}]:[],onRatingClick:i=>c(i,e.locationId)}))||[],c=(e,i)=>{var t=s.find(e=>e.id===i);l({locationId:i,rating:e}).then(()=>{window.location.href=t?.writeUserReviewUrl||""})};return 0===s.length?null:h("div",{className:i?void 0:eQ.container,children:h(es,{title:t,itemsToShowMultiplier:a,initialItemsToShow:o,items:s,options:{variant:"imageLeft",onCardClick:r},desktopLayoutColumns:e})})},e1={__key:91548404097567,id:"5343461b221f81c1a5ad0fb4ef3f4fda",loc:{},definitions:[]},e2=e=>{var[{data:i,error:t},o]=m({requestPolicy:"network-only",query:e1,variables:{photoIds:e.map(e=>e.id)},pause:0===e.length});return{photos:r(()=>{var o=i?.photos;return t||0===e.length?[]:o?.filter(Boolean).map(e=>({id:e?.id||0,caption:e?.caption||"",categoryId:null,source:e?.photoSizes?.filter(e=>e&&e.url&&e.width&&e.height).map(e=>({url:e?.url||"",width:e?.width||0,height:e?.height||0}))||[]}))||[]},[e,i,t]),refetch:o}},e4=e=>{var[i,t]=a([]),[r,l]=a([]),d=o(()=>{t(Array(e.length).fill(null)),e.forEach((e,i)=>{var o=new FileReader;o.addEventListener("load",()=>{if("string"==typeof o.result){var a=o.result,r=new Image;r.onload=()=>{var o={id:i,name:e.file.name,height:r.naturalHeight,width:r.naturalWidth,url:a};t(e=>{var t=[...e];return t[i]=o,t})},r.src=a}},!1),o.readAsDataURL(e.file)})},[e,t]);return n(()=>{d()},[d,e]),n(()=>{var t=i.filter(Boolean);t.length===e.length&&l(e.map((e,i)=>({id:i,caption:e.description,categoryId:e.categoryId||null,source:[t[i]],profanityTokens:e.profanityTokens})))},[e,i]),r},e3="USER_REVIEW_TRACKING",e6=()=>{var e=x.get(e3);return e||(e=`UserReview-${B()}`,x.set(e3,e)),e},e5=(e=ev)=>{var{draftId:i,reviewId:t,geoId:o,locationId:n,partnerId:d,mcid:s,pid:c}=e,u=l(new Set([])),p=l(new Set([])),{page:m,params:h}=L(),[_]=a(e6()),v=o||("geoId"in h?h.geoId:null),E=n||("detailId"in h?h.detailId:null),g=V(),R=W(),C=r(()=>({team:"Review",geoId:v,impressionKey:_,locationId:E,page:m,customData:JSON.stringify({fromKey:_,locationID:E,reviewID:t,draftID:i,partnerId:d,pid:c,mcid:s})}),[m,v,E,i,t,_,d,c,s]);return r(()=>({logImpression:(e,i,t={})=>{i&&u.current.has(e)||(R({...C,...e_[e],...t}),u.current=new Set(u.current).add(e))},logInteraction:(e,i,t={})=>{i&&p.current.has(e)||(g({...C,...eh[e],...t,actionType:"click"}),p.current=new Set(p.current).add(e))}}),[g,R,C])},e8={__key:0xf83849d49d0e,id:"f83849d49d0ee97d0e3259065c7b060e",loc:{},definitions:[]},e9=e=>{var[{data:i}]=m({query:e8,variables:{locationId:e||0},pause:!e});return r(()=>i?.locations?.map(e=>({id:e?.locationId,poiName:e?.localizedName,poiLocation:e?.parent?.additionalNames?.long,street:e?.localizedStreetAddress?.street,image:e?.thumbnail?.photoSizes,writeUserReviewUrl:e?.writeUserReviewUrl,rating:e?.reviewSummary?.rating,reviewCount:e?.reviewSummary?.count,award:e?.locationV2?.bestAwardForActiveYearV2?.awardType?{type:e?.locationV2?.bestAwardForActiveYearV2?.awardType,year:e?.locationV2?.bestAwardForActiveYearV2?.year}:null,relatedLocations:e?.relatedLocations?.map(e=>({id:e?.locationId,poiName:e?.localizedName,poiLocation:e?.parent?.additionalNames?.long,image:e?.thumbnail?.photoSizes,writeUserReviewUrl:e?.writeUserReviewUrl}))||[]}))?.[0],[i])},e7={container:"bhIWD",parentPoiContainer:"XiCpG f Mn MK Px",ratingContainer:"FGKgp f u",thumbnail:"SopVu",awardContainer:"AydSl",relatedItemContainer:"GaLho f"},ie=({children:e,...i})=>h(eR.Provider,{value:i,children:e}),ii=({locationId:e,setLocationId:i,skipProviderNavigation:t})=>{var{localize:l}=I(),{page:s}=L(),{logImpression:c,logInteraction:u}=eE(),[p,m]=a({dropdownValue:"",inputValue:""}),[v,E]=a(!1),[R,C]=a(!1),w="MOBILE"===y(),f=o(e=>{null!==e&&C(!0)},[]);n(()=>{switch(s){case"UserReview":c("USER_REVIEW_TOUR_SELECTION_MODAL_LANDER",!0);break;case"UserReviewEdit":c("USER_REVIEW_TOUR_SELECTION_CHANGE_ACTIVITY",!0);break;default:c("USER_REVIEW_TOUR_SELECTION_PROVIDER_PAGE",!0)}},[s,c]);var{useAttractionLocationData:S}=d(eR),b=S(e),P=r(()=>b?.relatedLocations.map(e=>({displayName:e?.poiName||"",value:e?.id?.toString()||"",customContent:_("div",{className:e7.relatedItemContainer,children:[h("div",{className:e7.thumbnail,children:h(N,{source:e?.image,height:"100%",width:"100%",aspectRatio:"1:1"})}),_("div",{children:[h(T,{variant:"supporting-03",children:e?.poiName}),h(T,{variant:"supporting-02",children:e?.poiLocation})]})]})}))||[],[b]),k=r(()=>b?.relatedLocations.find(e=>e?.id===Number(p.dropdownValue)),[p,b]);n(()=>{k&&u("USER_REVIEW_TOUR_SELECTION_MODAL_SEARCH_SELECTED")},[k,u]);var A=v?b?.writeUserReviewUrl:k?.writeUserReviewUrl,D=e=>{e&&(window.location.href=e)},U=()=>{u("USER_REVIEW_TOUR_SELECTION_MODAL_CLOSE"),i(null)},M=e=>{e&&(u("USER_REVIEW_TOUR_SELECTION_MODAL_DONT_REMEMBER"),m({dropdownValue:"",inputValue:""})),E(e)};return b&&null!==e?_(z,{onClose:U,title:l.string("activity_selection_modal_title"),children:[!R&&h("input",{ref:f}),_("div",{className:e7.container,children:[_("div",{className:e7.parentPoiContainer,children:[_("div",{className:e7.thumbnail,children:[h(N,{source:b.image,height:"100%",width:"100%",aspectRatio:"1:1"}),b.award&&h("div",{className:e7.awardContainer,children:h(q,{size:"small",color:b.award?"green":"yellow",year:b?.award?.year||void 0})})]}),_("div",{children:[h(T,{variant:"title-04",marginBottom:"spacing-01",children:b.poiName}),b.rating&&b.reviewCount&&_("div",{className:e7.ratingContainer,children:[b?.rating>0&&h(O,{size:"small",rating:b.rating}),h(T,{variant:"supporting-02",children:b.reviewCount})]}),_(T,{variant:"supporting-01",marginTop:"spacing-01",children:[b.street,b.street&&", ",b.poiLocation]})]})]}),h(T,{marginBottom:"spacing-04",variant:"title-04",children:l.string("activity_selection_modal_subtitle")}),h(F,{disabled:v,marginBottom:"spacing-04",iconVariant:"singleChevron",value:p,menuLabel:l.string("tour_selector_placeholder"),placeholder:w?void 0:l.string("tour_selector_placeholder_desktop"),dropdownOptions:P,onChange:e=>{u("USER_REVIEW_TOUR_SELECTION_MODAL_SEARCH_START",!0),m(e)},fullWidthMenu:!0}),h(G,{value:"close-button",checked:v,onToggle:(e,i)=>M(i),label:h(T,{variant:"body-01",children:l.string("tour_selector_other_checkbox_label")})}),h(g,{marginTop:"spacing-04",disabled:!k&&!v,onClick:()=>{v?u("USER_REVIEW_TOUR_SELECTION_MODAL_CTA_DONT_REMEMBER"):u("USER_REVIEW_TOUR_SELECTION_MODAL_CTA_SEARCH_SELECTED"),t&&v||D(A),U()},children:l.string("button_continue")})]})]}):null},it=()=>{var e="MOBILE"===y(),{os:i}=Y(),t="IOS"===i.family;return e&&t?h("meta",{name:"viewport",content:"width=device-width, initial-scale=1, maximum-scale=1"}):h("meta",{})},io=()=>{var e="write_a_review_form_web_experiences_1666008828",i=j({experimentKeys:[e]});return null!=i&&"test"===i[e]},ia={__key:0x5cbcea9009e6,id:"5cbcea9009e607ae660ab10e348af62f",loc:{},definitions:[]},ir=()=>{var[{data:e,fetching:i},t]=m({query:ia,variables:{userId:M()||"",taUnique:U()},requestPolicy:"cache-and-network"});return{draftsData:r(()=>e?.ReviewsProxy_getReviewDraftsForUser?.flat()?.filter(Boolean)?.map(e=>({locationId:e?.locationId,locationTitle:e?.location?.localizedName,locationSubtitle:e?.location?.parent?.additionalNames?.long,date:e?.lastUpdatedDate?new Date(e?.lastUpdatedDate):null,rating:e?.rating||0,writeUserReviewUrl:e?.location?.writeUserReviewUrl||"",url:e?.location?.url||"",placeType:e?.location?.placeType||null,accommodationCategory:e?.location?.accommodationCategory||null,thumbnails:e?.location?.thumbnail?[{id:e.location.thumbnail.id||0,source:e.location.thumbnail.photoSizes}]:[],location:{localizedName:e?.location?.localizedName||"",thumbnail:{photoSizeDynamic:e?.location?.thumbnail?.photoSizeDynamic}},content:e?.content||"",title:e?.title||"",tripType:e?.tripType,travelDate:e?.travelDate||"",photos:e?.photoIds?.map((i,t)=>({id:i||-1,caption:e?.photoCaptions?.[t]||"",categoryId:e?.photoCategories?.[t]||null}))||[],questionsAndAnswers:e?.questionsAndAnswers?.map(e=>({question:e?.question||"",answer:e?.answer||""}))||[]}))||[],[e]),fetching:i,refetch:t}},il=e=>{var[{data:i},t]=m({query:e$,variables:{userId:M()||""},requestPolicy:"cache-and-network"}),o=(e,i)=>e?.flat()?.filter(Boolean)?.filter(e=>e?.locationId)?.slice(0,i)?.map(e=>({heading:e?.location?.localizedName,key:String(e?.locationId),locationId:e?.locationId,image:e?.location?.thumbnail?.photoSizeDynamic})),a={id:"your_drafts",header:h(w,{id:"ur_search_your_drafts_all_caps"}),items:o(e,5)};return{placeholderItems:[{id:"recently_viewed",header:h(w,{id:"dual_search_recently_viewed_all_caps"}),items:o(i?.ReviewsProxy_getSuggestedLocationsToReviewForUser?.[0]?.suggestedLocations,5-(a?.items?.length||0))},a],refetch:t}};function id(e,i){if(!i||!e)return!1;var t=i.match(/\b(\w+)\b/g),o=t?.map(e=>e.toLowerCase()),a=new Set(e),r=new Set(o?.filter(e=>a.has(e)));return r?.size>0}var is=50,ic=({onClose:e,onReselect:i,variant:t,photoLimit:o=is})=>{var{localize:a}=I();return h(z,{onClose:e,title:a.string("user_review_add_photos_limit_title"),primaryButton:h(g,{variant:"primary",onClick:e,children:a.string("aw_done_ffffe1e5")}),secondaryButton:i?h(g,{variant:"secondary",onClick:i,children:a.string("user_review_add_photos_limit_secondary_cta")}):void 0,children:_(T,{variant:"body-01",children:["RATE_LIMITED"===t&&a.string("user_review_add_photos_rate_limited_text"),"LIMIT_REACHED"===t&&a.string("user_review_add_photos_limit_reached_text",{limit:o})]})})},iu=()=>{var{localize:e}=I();return[{value:"16",displayName:e.string("war_hotel_photo_category_dining")},{value:"17",displayName:e.string("war_hotel_photo_category_hotel_and_ground")},{value:"18",displayName:e.string("war_hotel_photo_category_room")},{value:"19",displayName:e.string("war_hotel_photo_category_bathroom")},{value:"20",displayName:e.string("war_hotel_photo_category_pool")},{value:"21",displayName:e.string("war_hotel_photo_category_view")},{value:"22",displayName:e.string("war_hotel_photo_category_family_area")},{value:"23",displayName:e.string("war_hotel_photo_category_buisness_center")},{value:"100",displayName:e.string("war_hotel_photo_category_other")}]},ip={container:"gFCIC Mk Pj PX Pw PJ",fullWidth:"IIaJy",headerContainer:"jIpsz f u",showDetailsButtonContainer:"NB",link:"kgkQe _F Wb",descriptionBelowText:"Taidn f e",descriptionInline:"kVaUQ f"},im=({uploadProgress:e,fullWidth:i})=>{var{localize:t}=I(),[o,l]=a(!1),[d,s]=a(!1),c="MOBILE"===y(),u=`${t.string("mobile_help_center_url")}/articles/200615067`,{uploadFiles:p}=X(),{maxCount:m,processedCount:v,errors:{networkErrors:g,fileSizeErrorNames:R,fileTypeErrorNames:w}}=e;n(()=>{l(!1);var e=setInterval(()=>l(!0),5e3);return()=>clearInterval(e)},[e]);var f=r(()=>m===v,[m,v]),b=r(()=>g.length+R.length+w.length,[g,R,w]),N=r(()=>b>0,[b]);n(()=>{s&&s(!1)},[f,s]);var P=N&&f,{detailsButtonText:k,detailsButtonIcon:O}=d?{detailsButtonText:c?t.string("user_review_upload_details_cta_hide_mobile"):t.string("user_review_upload_details_cta_hide"),detailsButtonIcon:h(ei,{size:16})}:{detailsButtonText:c?t.string("user_review_upload_details_cta_show_mobile"):t.string("user_review_upload_details_cta_show"),detailsButtonIcon:h(ee,{size:16})};return 0===m?null:_("div",{className:E(ip.container,{[ip.fullWidth]:i}),children:[_("div",{className:ip.headerContainer,children:[f?N?h(Q,{size:16,color:"dangerIcon"}):h($,{size:16,color:"verifiedCheckMarkIcon"}):h(K,{variant:"xsmall"}),_("div",{className:!f&&o?ip.descriptionBelowText:ip.descriptionInline,children:[h(T,{variant:"title-05",children:f?N?t.string("rs_offline_status_error"):t.string("user_review_upload_complete"):o?t.string("user_review_long_upload_progress"):t.string("user_review_upload_progress")}),h(T,{color:"placeholderText",variant:"input-03",children:f?N?c?t.string("user_review_upload_number_failed_mobile",{numberFailed:b,numberMax:m}):t.string("user_review_upload_number_failed",{numberFailed:b,numberMax:m}):c?t.string("user_review_upload_number_uploaded",{numberComplete:v,numberMax:m}):1===v?t.string("user_review_upload_single_success"):t.string("user_review_upload_number_success",{numberSuccess:m,numberMax:m}):c?t.string("user_review_upload_number_uploaded_mobile",{numberComplete:v,numberMax:m}):t.string("user_review_upload_number_uploaded",{numberComplete:v,numberMax:m})})]}),P&&!c&&h("div",{className:ip.showDetailsButtonContainer,children:_(C,{variant:"primary-small",onClick:()=>s(e=>!e),children:[k,O]})})]}),d&&N&&_("div",{children:[g.length>0&&_(T,{marginTop:"spacing-02",color:"placeholderText",variant:"input-02",children:[t.string("user_review_upload_file_network_error",{items:g.map(e=>e.fileName).join(", ")}),h(C,{onClick:()=>{p(g.map(e=>({...e.definition,uploadId:e.uploadId})))},marginLeft:"spacing-01",children:h(T,{color:"placeholderText",variant:"input-02",children:t.string("tf_web_generic_retry")})})]}),R.length>0&&h(T,{marginTop:"spacing-02",color:"placeholderText",variant:"input-02",children:t.string("user_review_upload_file_size_error",{items:R.join(", ")})}),w.length>0&&h(T,{marginTop:"spacing-02",color:"placeholderText",variant:"input-02",children:t.string("user_review_upload_file_type_error",{items:w.join(", ")})}),h(T,{marginTop:"spacing-02",color:"placeholderText",variant:"input-02",children:h(S,{id:"user_review_upload_guidelines",args:{link:`"${u}"`,class:`"${ip.link}"`,target:'"_blank"'}})})]}),P&&c&&_(C,{marginTop:"spacing-03",variant:"primary-small",onClick:()=>s(e=>!e),children:[k,O]})]})},ih=({imageSize:e,cropCoordinates:i,setCropCoordinates:t,children:o})=>{var[r,n]=a(null),[l]=a(eP.map(()=>s())),d=(e,i,t)=>e<i?i:e>t?t:e,c=(o,a,r)=>{if(null!==r&&e){var{horizontalPosition:n,verticalPosition:l}=eP[r],s="right"===n?"width":"left",c="bottom"===l?"height":"top",u={...i,[s]:i[s]+o,[c]:i[c]+a,...n&&"left"===n&&{width:i.width-o},...l&&"top"===l&&{height:i.height-a}};if(u.width>20&&u.height>20){var p=!n&&!l;t(u={top:d(u.top,0,e.height-(p?u.height:20)),left:d(u.left,0,e.width-(p?u.width:20)),width:p?u.width:d(u.width,20,e.width-u.left),height:p?u.height:d(u.height,20,e.height-u.top)})}}},u=e=>{if(null!=r){var i=l[r].current;if(i){var{horizontalPosition:t,verticalPosition:o}=eP[r],a=e.clientX-i.getBoundingClientRect().left,n=e.clientY-i.getBoundingClientRect().top;c(!t&&o?0:a,!o&&t?0:n,r)}}},p=()=>{null!=r&&n(null)};return e?_("div",{onTouchMove:e=>{null!=r&&1===e.touches.length&&u(e.touches[0])},onTouchEnd:p,onMouseMove:e=>{null!=r&&(e.preventDefault(),u(e))},onMouseLeave:e=>{null!=r&&(u(e),p())},onMouseUp:p,role:"presentation",tabIndex:-1,className:"YVPpE",children:[h("div",{className:"xDUbl Z1",style:i,children:eP.map(({horizontalPosition:e,verticalPosition:i},t)=>h(ek,{ref:l[t],verticalPosition:i,horizontalPosition:e,index:t,handleDragEnd:p,handlePointMovement:c,setMovingPointIndex:n},`${e||""} ${i||""}`))}),h("div",{className:"TFcIN o",children:h("div",{className:"LAGYZ z",style:i})}),h("div",{children:o})]}):o},i_=[{name:"3:4",factor:3/4},{name:"1:1",factor:1},{name:"4:3",factor:4/3}],iv=e=>({options:r(()=>{if(!e)return[];var i={width:e.width/2,height:e.height/2};return i_.map(t=>{var o=Math.min(e.width,e.height),a=o*t.factor,r=Math.max(e.width,e.height);a>r&&(o=(a=r)/t.factor);var n=e.height>e.width?a:o,l=e.height>e.width?o:a;return{...t,value:{left:i.width-l/2,top:i.height-n/2,width:l,height:n}}})},[e]),isOptionActive:(e,i)=>!!e&&i.value.top===e.top&&i.value.left===e.left&&i.value.width===e.width&&i.value.height===e.height}),iE=({image:e,setImage:i,onClose:t,setCropCoordinates:o,resetCrop:a,getCropOptionIcon:r,cropImages:s})=>{var{localize:c}=I(),{tracking:u}=d(en),p=l(null),m=l(null),{options:v,isOptionActive:E}=eA(e?.imageSize);return n(()=>{var t=m.current;!p.current&&e?(p.current=new ResizeObserver(()=>{if(m?.current&&void 0!==e){var{height:t,width:o}=m.current.getBoundingClientRect();0!==o&&0!==t&&e.imageSize?.width!==o&&e.imageSize?.height!==t&&i({...e,imageSize:{width:o,height:t},cropCoordinates:{...eM,width:o,height:t}})}}),t&&p?.current&&p.current.observe(t)):p?.current&&void 0===e&&t&&(p.current.unobserve(t),p.current=null)},[m,p,e,i]),_(z,{onClose:t,children:[h(T,{marginBottom:"spacing-04",variant:"title-02",children:c.string("user_review_crop_photo")}),_("div",{className:"f",children:[h("div",{className:"IGWiO Gp f u",children:h("div",{ref:m,children:h(eO,{imageSize:e?.imageSize,cropCoordinates:e?.cropCoordinates||eM,setCropCoordinates:e=>{u?.onCropPhotoModalCropSizeChange&&u.onCropPhotoModalCropSizeChange(),o(e)},children:h("div",{className:"uEckD",children:h(N,{source:e?.originalPhoto.source,height:"100%"})})})})}),_("div",{className:"ToTHp PM f e",children:[h("div",{className:"iOajs f",children:v.map(i=>h(et,{dataAttributes:{"data-automation":`crop-photo-${i.name}-button`},onClick:()=>{u?.onCropPhotoModalCropSizeClick&&u.onCropPhotoModalCropSizeClick(i.name),o(i.value)},marginLeft:"spacing-02",selected:E(e?.cropCoordinates,i),children:h(T,{variant:"button-03",children:_("div",{className:"vEvEN f e u c Q1",children:[h("div",{className:"SmzWy",children:r(i.factor)}),h("span",{children:i.name})]})})},i.name))}),_("div",{className:"jbanq f u",children:[h(C,{onClick:()=>{u?.onCropPhotoModalCropReset&&u.onCropPhotoModalCropReset(),a()},dataAttributes:{"data-automation":"reset-crop-button"},children:c.string("user_review_reset_crop")}),h(g,{dataAttributes:{"data-automation":"save-crop-button"},variant:"secondary",onClick:s,children:c("btn_save")})]})]})]})]})},ig={imageContainer:"TBuUg Gp f u",image:"QnhiX",cropOption:"XLghM f e u c",cropIcon:"jtwBK",footerButtons:"qPglN f u",header:"ErUsv f",footer:"Gzfal f e",scrollableImagesContainer:"vpmPK _t _h",imagesContainer:"vJoAb",cropOptions:"XwuHV f",activeImage:"ccqJd z"},iR=({image:e,setImage:i,onClose:t,setCropCoordinates:o,resetCrop:s,getCropOptionIcon:c,cropImages:u})=>{var{localize:p}=I(),{croppingPhotos:m,tracking:v}=d(en),R=r(()=>m.filter(e=>!e?.processed),[m]),[w,f]=a(0),S=l(null),y=l(null),b=l(null),{options:P,isOptionActive:k}=eA(e?.imageSize);n(()=>{var t=y.current;!S.current&&e?(S.current=new ResizeObserver(()=>{if(y?.current&&void 0!==e){var{height:t,width:o}=y.current.getBoundingClientRect();0!==o&&0!==t&&e.imageSize?.width!==o&&e.imageSize?.height!==t&&i({...e,imageSize:{width:o,height:t},cropCoordinates:{...eM,width:o,height:t}})}}),t&&S?.current&&S.current.observe(t)):S?.current&&void 0===e&&t&&(S.current.unobserve(t),S.current=null)},[y,S,e,w,i]),n(()=>{if(R.length>0){if(void 0===e){var t=R[w];if(t)i(t);else{var o=R.findIndex(e=>!e.deleted);-1!==o&&f(o)}}else R[w]?.originalPhoto.id!==e?.originalPhoto.id&&i(void 0)}},[w,e,R,i,f]);var O=r(()=>50*R.length+(R.length-1)*8,[R.length]),A=e=>{f(e),b?.current&&b.current.scroll({left:58*e,behavior:"smooth"})};return h(z,{variant:"fixed-height-sticky-footer",stickyHeader:!0,onClose:t,title:_("div",{className:ig.header,children:[h(C,{onClick:()=>{v?.onCropPhotoModalCropReset&&v.onCropPhotoModalCropReset(),s()},dataAttributes:{"data-automation":"reset-crop-button"},children:p.string("user_review_reset_crop")}),h("div",{className:ig.cropOptions,children:P.map(i=>h(et,{dataAttributes:{"data-automation":`crop-photo-${i.name}-button`},onClick:()=>{v?.onCropPhotoModalCropSizeClick&&v.onCropPhotoModalCropSizeClick(i.name),o(i.value)},marginLeft:"spacing-02",selected:k(e?.cropCoordinates,i),children:h(T,{variant:"button-03",children:_("div",{className:ig.cropOption,children:[h("div",{className:ig.cropIcon,children:c(i.factor)}),h("span",{children:i.name})]})})},i.name))})]}),footer:_("div",{className:ig.footer,children:[R.length>1&&h("div",{ref:b,className:ig.scrollableImagesContainer,children:h("div",{style:{width:O},className:ig.imagesContainer,children:R.map((e,i)=>e.deleted?null:h("div",{onClick:()=>{A(i)},role:"button",onKeyDown:e=>{"Enter"===e.key&&A(i)},tabIndex:0,children:h("div",{className:E(ig.imageContainer,{[ig.activeImage]:i===w}),children:h("div",{className:ig.image,children:h(N,{source:e.originalPhoto.source,height:"100%"})})})},e.originalPhoto.id))})}),_("div",{className:ig.footerButtons,children:[h(g,{dataAttributes:{"data-automation":"remove-photo-button"},variant:"secondary",onClick:()=>{e&&i({...e,deleted:!0,processed:!0})},children:p("user_review_crop_photo_remove")}),h(g,{dataAttributes:{"data-automation":"save-crop-button"},onClick:u,children:p("btn_save")})]})]}),children:h("div",{className:ig.imageContainer,children:h("div",{ref:y,children:h(eO,{imageSize:e?.imageSize,cropCoordinates:e?.cropCoordinates||eM,setCropCoordinates:e=>{v?.onCropPhotoModalCropSizeChange&&v.onCropPhotoModalCropSizeChange(),o(e)},children:h("div",{className:ig.image,children:h(N,{source:e?.originalPhoto.source,height:"100%"})})})})})})},iC={width:0,height:0},iT=()=>{var{setCroppingPhotos:e,croppingPhotos:i,tracking:t}=d(en),[r,s]=a(i[0]),c=l([]),u="MOBILE"===y(),p=o(()=>{t?.onCropPhotoModalClose&&t.onCropPhotoModalClose(),e([])},[t,e]),m=e=>{void 0!==r&&s({...r,cropCoordinates:e})};n(()=>{var t=i.find(e=>e.originalPhoto.id===r?.originalPhoto.id);r&&t&&!eo(r,t)&&e(i.map(e=>e.originalPhoto.id===r.originalPhoto.id?r:e))},[r,i,e]);var E=()=>m({...eM,height:r?.imageSize?.height||iC.height,width:r?.imageSize?.width||iC.width}),g=e=>h("div",{className:"AzHsi",style:{width:e>1?8*e:8,height:e>1?8:8/e}}),R=()=>{i.forEach((e,i)=>{e.deleted||C(e,i)})},C=(i,t)=>{var{cropCoordinates:o,originalPhoto:a,imageSize:r}=i,n=c.current[t];if(n&&o&&r&&(0!==o.top||0!==o.left||o.height!==r.height||o.width!==r.width)){e(e=>e.map((e,i)=>i===t?{...e,processed:!1}:e));var{url:l,width:d}=a.source[a.source.length-1],s=d/r.width,u=o.width*s,p=o.height*s;n.width=u,n.height=p;var m=new Image;m.crossOrigin="",m.addEventListener("load",()=>{var i=n.getContext("2d");i&&(i.clearRect(0,0,o.width,o.height),i.drawImage(m,o.left*s,o.top*s,o.width*s,o.height*s,0,0,u,p),n.toBlob(i=>{i&&(i.lastModified=new Date().getTime(),i.name=`${a.id}_crop.png`,e(e=>e.map((e,o)=>o===t?{...e,file:i,processed:!0}:e)))},void 0,1))}),m.setAttribute("src",l)}else e(e=>e.map((e,i)=>i===t?{...e,processed:!0}:e))};return _(v,{children:[u?h(eU,{image:r,setImage:s,setCropCoordinates:m,onClose:p,cropImages:R,getCropOptionIcon:g,resetCrop:E}):h(eD,{image:r,setImage:s,setCropCoordinates:m,onClose:p,cropImages:R,getCropOptionIcon:g,resetCrop:E}),h("div",{className:"_",children:i.map((e,i)=>e.deleted?null:h("canvas",{ref:e=>{c.current[i]=e}},e.originalPhoto.id))})]})},iw={container:"vYDSu",header:"kSqYi",title:"SZBYP c",imageContainer:"hEQrs _S u",image:"pGmMM",errorText:"Fs",footer:"VthlD u",footerActions:"EOWdL",textField:"CZyrh Q _g z R4 Cj",error:"BvmxG"},iI=({onClose:e,onSave:i})=>{var{localize:t}=I(),{photos:n,setPhotos:s,setCroppingPhotos:c,isHotel:u,tracking:p,uploadModalMobilePhotoIds:m,checkForCaptionProfanity:v}=d(en),[C,w]=a(null),[f,S]=a(0),y=l(null),b=eb(),P=n.find(e=>e.id===m[f]),k=o(()=>{c(n.filter(e=>m.includes(e.id)))},[n,m,c]),O=r(()=>{var e=n.find(e=>e.id===P?.id);return e?.hasProfanity?t.string("phoenix_war_profanity_error_message"):null},[n,P,t]),D=o(e=>{s(e)},[s]);return h(z,{variant:"fixed-height-sticky-footer",stickyHeader:!0,title:_("div",{className:iw.header,children:[h("div",{className:iw.title,children:h(T,{variant:"title-04",children:1===m.length?t.string("user_review_add_caption_title"):t.string("user_review_add_captions_title",{index:f+1,count:m.length})})}),h(R,{variant:"clear",icon:ea,"aria-label":t.string("common_Close"),size:"small",onClick:e})]}),footer:_("div",{className:iw.footer,children:[h("div",{className:iw.footerActions,children:C&&t("ds_textarea_maximum_characters",{numCount:n.find(e=>e.id===C)?.caption?.length||0,numLimit:ib})}),h("div",{className:iw.footerActions,children:h(g,{variant:"secondary",dataAttributes:{"data-automation":"next-photo-button"},onClick:f===m.length-1?i:()=>{S(f+1)},children:f===m.length-1?t.string("tavrs_common_save"):t.string("common_Next")})})]}),onClose:e,closeButtonPosition:"none",children:_("div",{className:iw.container,children:[h("div",{onClick:()=>{p?.onPhotoClick&&p.onPhotoClick(),k()},role:"button",onKeyDown:e=>{"Enter"===e.key&&(p?.onPhotoClick&&p.onPhotoClick(),k())},tabIndex:0,"data-automation":`crop-photo-${f}-modal-button`,children:h("div",{className:iw.imageContainer,children:h("div",{className:iw.image,children:h(N,{errorRefetchOptions:{interval:2e3,maxCount:30},source:P?.source,height:"100%"})})})}),u&&_("div",{children:[h(T,{marginTop:"spacing-03",marginBottom:"spacing-03",variant:"title-03",children:t.string("war_photos_category_selection_placeholder")}),h(A,{mode:"select",label:t.string("war_photos_category_selection_chooseone"),trigger:e=>h(et,{icon:e.active?ei:ee,iconPosition:"trailing",onKeyDown:e.onKeyDown,onClick:e.onClick,disabled:e.disabled,...e.ariaAttributes,ref:e.ref,children:""!==e.children?e.children:e.placeholder??null}),placeholder:t.string("war_photos_category_selection_chooseone"),value:String(P?.categoryId),options:b,onChange:e=>{s(n.map(i=>i.id===P?.id?{...P,categoryId:+e}:i))}})]}),h(T,{marginTop:"spacing-04",variant:"title-03",children:t.string("user_review_add_caption_label")}),h(T,{marginTop:"spacing-03",variant:"body-01",children:h("textarea",{id:`photo-${f}-caption`,className:E(iw.textField,{[iw.error]:O}),ref:y,onFocus:()=>w(P?.id||null),placeholder:t.string("user_review_add_caption"),rows:5,onBlur:()=>{!O&&P?.caption&&v(D,()=>{},void 0,f)},onChange:e=>{var i=e.target.value;e.target.value.length<=ib&&(p?.onAddCaption&&p.onAddCaption(i),s(n.map(i=>i.id===P?.id?{...P,caption:e.target.value}:i)))},value:P?.caption||"",maxLength:ib})}),O&&h("div",{className:iw.errorText,role:"alert","aria-controls":`photo-${f}-caption`,children:h(T,{variant:"supporting-02",color:"dangerText",marginTop:"spacing-02",children:O})})]})})},iS={container:"ZUCuS",header:"HIRRr",addPhotosButton:"cenCM u",imagesContainer:"sBBXd",imageContainer:"YmmrD _S u Re o",imageAndAttributeContainer:"gAxKd",imagesAttributes:"btHwj PF",image:"ATXuz",failedUploadOverlay:"olZnW u",failedUploadOverlayContent:"lFDgs _S c u e",deleteButton:"FtTTq",footer:"UaYji e",link:"bzvTa _F Wb",submitButtonContainer:"CnloW"},iy=({onClose:e,onSave:i})=>{var{localize:t}=I(),{photos:l,photoDefinitions:c,setPhotos:u,setCroppingPhotos:p,isHotel:m,tracking:v,setUploadModalOpenState:E,checkForCaptionProfanity:C,uploadProgress:w,setUploadResult:f}=d(en),{open:y,uploadFiles:b,photosResultQueue:P}=X(),{termsOfUse:k}=er(),[O,D]=a(null),U=eb(),M=r(()=>l.map(()=>s()),[l]),L=o(e=>{e.current&&e.current.scrollIntoView({behavior:"smooth"})},[]),[V,W]=a("CheckProfanity"),x=o(e=>{W("CloseModal"),i(),e&&e.target.dispatchEvent(new Event("click"))},[W,i]),B=o(e=>{u(e);var i=e.findIndex(e=>e.hasProfanity);i>-1&&i<M.length?L(M[i]):x()},[u,M,L,x]),F=(e,i)=>{e.preventDefault(),e.stopPropagation();var t=[...l],o=t.splice(i,1);u(t),0===t.length&&E(!1),o[0]?.uploadId&&f(e=>e.map(e=>e.uploadId===o[0].uploadId?{...e,isDeleted:!0}:e))},[G,q]=a(!1),Y=o(()=>{var e=l.findIndex(e=>e?.hasProfanity);e>-1&&e<M.length&&L(M[e])},[l,L,M]);n(()=>{G||Y(),q(!0)},[G,Y]);var j=e=>e?.hasProfanity?"error":e.uploadDefinition?"disabled":void 0,K=l.filter(e=>!e.uploadDefinition).length;return _(z,{variant:"fixed-height-sticky-footer",stickyHeader:!0,title:h("div",{className:iS.header,children:h(T,{variant:"title-02",children:t.string("user_review_add_photos")})}),footer:_("div",{className:iS.footer,children:[_("div",{className:iS.submitButtonContainer,children:[h(g,{variant:"secondary",dataAttributes:{"data-automation":"add-more-photos-button"},onClick:()=>{v?.onAddMoreClick&&v.onAddMoreClick(),y()},children:h("div",{className:iS.addPhotosButton,children:t.string("user_review_add_more_photos")})}),_(g,{disabled:0===K||P.length>0,dataAttributes:{"data-automation":"attach-photos-button"},onClick:e=>{"CheckProfanity"===V?(e.preventDefault(),C(B,x,e)):W("CheckProfanity")},children:[0===K&&t.string("user_review_attach_photos_cta"),1===K&&t.string("user_review_attach_photo"),K>1&&t.string("user_review_attach_photos",{number:K})]})]}),h(T,{variant:"supporting-02",children:h(S,{id:"user_review_photo_upload_terms_with_url",args:{link:`"${k}"`,class:`"${iS.link}"`,target:'"_blank"'}})})]}),onClose:e,children:[h(eN,{uploadProgress:w}),h("div",{className:iS.container,children:h("div",{className:iS.imagesContainer,children:l.map((e,i)=>_("div",{ref:M[i],className:iS.imageAndAttributeContainer,children:[h("div",{onClick:()=>{0===P.length&&(v?.onPhotoClick&&v.onPhotoClick(),e.uploadDefinition?b(c):p([e]))},role:"button",onKeyDown:i=>{"Enter"===i.key&&0===P.length&&(v?.onPhotoClick&&v.onPhotoClick(),e.uploadDefinition?b(c):p([e]))},tabIndex:0,"data-automation":`crop-photo-${i}-modal-button`,children:_("div",{className:iS.imageContainer,children:[e.uploadDefinition&&h("div",{className:iS.failedUploadOverlay,children:_("div",{className:iS.failedUploadOverlayContent,children:[h(T,{variant:"supporting-01",color:"onDarkText",children:t.string("user_review_upload_failed_photo_text")}),h(T,{variant:"supporting-01",color:"onDarkText",children:h("u",{children:t.string("user_review_upload_retry_text",{number:l.filter(e=>!!e.uploadDefinition).length})})})]})}),h("div",{className:iS.deleteButton,children:h(R,{dataAttributes:{"data-automation":`delete-photo-${i}-modal-button`},variant:"dark",icon:ea,"aria-label":t.string("b2b_delete_photo"),size:"small",onClick:e=>{v?.onDeletePhoto&&v.onDeletePhoto(),F(e,i)}})}),h("div",{className:iS.image,children:h(N,{errorRefetchOptions:{interval:2e3,maxCount:30},source:l?.find(i=>i.id===e.id)?.source,height:"100%"})})]})}),_("div",{className:iS.imagesAttributes,children:[" ",m&&h(A,{disabled:!!e.uploadDefinition,mode:"select",label:t.string("war_photos_category_selection_placeholder"),trigger:e=>h(et,{icon:e.active?ei:ee,iconPosition:"trailing",onKeyDown:e.onKeyDown,onClick:e.onClick,disabled:e.disabled,...e.ariaAttributes,ref:e.ref,children:""!==e.children?e.children:e.placeholder??null}),placeholder:t.string("war_photos_category_selection_placeholder"),value:String(e.categoryId),options:U,onChange:e=>{u(l.map(t=>t.id===l[i].id?{...l[i],categoryId:+e}:t))}}),h(H,{id:`photo-${i}-caption`,state:j(e),errorText:l[i]?.hasProfanity?t.string("phoenix_war_profanity_error_message"):void 0,marginTop:m?"spacing-02":void 0,placeholder:t.string("user_review_add_caption"),value:l[i]?.caption,onBlur:()=>D(null),onFocus:()=>D(e.id),onChange:e=>{var t=e.target.value;v?.onAddCaption&&v.onAddCaption(t),u(l.map(t=>t.id===l[i].id?{...l[i],caption:e.target.value}:t))},maxLength:ib,characterCountType:O===e.id?"max":void 0,variant:"two-line"})]})]},e.id))})})]})},ib=300,iN=({skipModalRender:e})=>{var{croppingPhotos:i,tracking:t,setUploadModalOpenState:a}=d(en),l="MOBILE"===y(),s=r(()=>i.length>0&&!i?.some(e=>"processed"in e),[i]);n(()=>{s&&t?.onCropPhotoModalOpen&&t.onCropPhotoModalOpen()},[s,t]);var c=o(()=>{a(!1)},[a]),u=o(()=>{t?.onUploadModalSave&&t.onUploadModalSave(),c()},[c,t]),p=o(()=>{t?.onCloseClick&&t.onCloseClick(),c()},[c,t]);return s?h(eL,{}):e?null:l?h(eV,{onSave:u,onClose:p}):h(eW,{onSave:u,onClose:p})},iP=e=>-(e+1),ik=({children:e,photos:i,onChange:t,tracking:l,isHotel:d,onPhotoUploadStatusChange:s})=>{var[c,u]=a([]),[p,m]=a(!1),[_,v]=a([]),[E,g]=a([]),R=r(()=>_.map(e=>e.uploadDefinition),[_]),{photos:C}=ep(i),T=em(R),w=el(i),I=o(e=>{var i=[],o=[];e.forEach(({id:e,caption:t,categoryId:a,hasProfanity:r,profanityTokens:n,uploadId:l,uploadDefinition:d},s)=>{var c={id:-1===e?iP(s):e,caption:t,categoryId:a,hasProfanity:r,profanityTokens:n,uploadId:l,uploadDefinition:d};c.uploadDefinition?i.push(c):o.push(c)}),v(i),t&&t(o)},[t]),f=o(e=>e?.originalPhoto?e:{originalPhoto:e},[]),S=o(e=>{"function"==typeof e?u(i=>e(i)):u(e.map(f))},[f]),y=o(e=>{m(e)},[m]),b=r(()=>{var e=i.map(e=>({...e,hasProfanity:id(e?.profanityTokens||null,e?.caption||null),source:C.find(i=>i.id===e.id)?.source||[]}));return _.forEach((i,t)=>{e.splice(iP(i.id),0,{...i,hasProfanity:id(i?.profanityTokens||null,i?.caption||null),source:T[t]?.source})}),e},[i,C,_,T]),N=r(()=>"boolean"!=typeof p?p:[],[p]),P=r(()=>{var e=E.filter(e=>!e.isDeleted),i=e.map(e=>e.uploadId),t=b.filter(e=>!i.includes(e.uploadId||"")).length,o=e.filter(e=>!!e.result),a=e.filter(e=>e.result?.error),r=a.map(e=>e.result);return{maxCount:c.length>0?b.length:t+i.length,processedCount:c.length>0?b.length-c.length+o.length:t+o.length,errors:{fileSizeErrorNames:r.filter(e=>e.error instanceof J).map(e=>e.fileName).filter(Boolean),fileTypeErrorNames:r.filter(e=>e.error instanceof Z).map(e=>e.fileName).filter(Boolean),networkErrors:a.filter(e=>!!e.result.definition).map(e=>({fileName:e.result.definition?.file.name,definition:e.result.definition,uploadId:e.uploadId})).filter(Boolean)}}},[b,c,E]);n(()=>{s&&s(P.maxCount>0&&P.maxCount!==P.processedCount)},[P,s]);var k=r(()=>({photos:b,setPhotos:I,photoDefinitions:R,croppingPhotos:c,setCroppingPhotos:S,uploadModalOpenState:p,uploadModalMobilePhotoIds:N,setUploadModalOpenState:y,checkForCaptionProfanity:w,tracking:l,isHotel:d,uploadProgress:P,setUploadResult:g,uploadResult:E}),[c,R,I,S,l,d,b,p,N,y,w,P,g,E]);return h(en.Provider,{value:k,children:e})},iO={__key:96555604628162,id:"57d11a83d2c21a5aa1a77133ad598d11",loc:{},definitions:[]},iA=()=>{var[{fetching:e},i]=p(iO);return[{fetching:e},e=>i(e)]},iD={__key:0xb8be056dd14d,id:"b8be056dd14d72540effb41d67863e02",loc:{},definitions:[]},iU=()=>{var[{fetching:e},i]=p(iD);return[{fetching:e},e=>i(e)]};return e("hasProfanityError",id),[()=>{en=t.createContext({photos:[],photoDefinitions:[],setPhotos:()=>{},croppingPhotos:[],setCroppingPhotos:()=>{},uploadModalOpenState:!1,uploadModalMobilePhotoIds:[],setUploadModalOpenState:()=>{},checkForCaptionProfanity:()=>void 0,tracking:void 0,isHotel:!1,uploadProgress:{maxCount:0,processedCount:0,errors:{fileSizeErrorNames:[],fileTypeErrorNames:[],networkErrors:[]}},uploadResult:[],setUploadResult:()=>{}}),el=eq,ed=ej,es=eK,ec=eZ,eu=e0,ep=e2,em=e4,eh={GLOBAL_NAVIGATION:{itemType:"WriteReview",itemName:"GlobalNav",customData:JSON.stringify({})},POI_WRITE_REVIEW_HEADER:{itemType:"WriteReview",itemName:"PoiHeader"},POI_WRITE_REVIEW_SECTION:{itemType:"WriteReview",itemName:"PoiReivewSection"},USER_REVIEW_LANDER_DRAFT:{actionSubType:"userReviewLanderClick",itemType:"userReviewLanderClick",itemName:"draft"},USER_REVIEW_LANDER_DRAFT_SHOW_MORE:{actionSubType:"userReviewLanderClick",itemType:"userReviewLanderClick",itemName:"showMore"},USER_REVIEW_LANDER_SUGGESTION:{actionSubType:"userReviewLanderClick",itemType:"userReviewLanderClick",itemName:"beenThere"},USER_REVIEW_LANDER_RECENT_REVIEWS_MENU:{actionSubType:"userReviewLanderClick",itemType:"userReviewLanderClick",itemName:"recentReview"},USER_REVIEW_LANDER_LEARN_MORE:{actionSubType:"userReviewLanderClick",itemType:"userReviewLanderClick",itemName:"learnMore"},USER_REVIEW_LANDER_ADD_LISTING:{actionSubType:"userReviewLanderClick",itemType:"userReviewLanderClick",itemName:"addListing"},USER_REVIEW_LANDER_RECENT_REVIEWS_SEE_ALL:{actionSubType:"userReviewLanderClick",itemType:"userReviewLanderClick",itemName:"seeAll"},USER_REVIEW_EDIT_BUBBLE_RATING:{actionSubType:"userReviewEditClick",itemType:"userReviewEditClick",itemName:"bubbleRating"},USER_REVIEW_EDIT_TRAVEL_DATE:{actionSubType:"userReviewEditClick",itemType:"userReviewEditClick",itemName:"visitDate"},USER_REVIEW_EDIT_REVIEW_TYPE:{actionSubType:"userReviewEditClick",itemType:"userReviewEditClick",itemName:"reviewType"},USER_REVIEW_EDIT_MEAL_TYPE:{actionSubType:"userReviewEditClick",itemType:"userReviewEditClick",itemName:"mealType"},USER_REVIEW_EDIT_SHIP_CABIN_TYPE:{actionSubType:"userReviewEditClick",itemType:"userReviewEditClick",itemName:"shipCabinType"},USER_REVIEW_EDIT_SHIP_DESTINATION:{actionSubType:"userReviewEditClick",itemType:"userReviewEditClick",itemName:"shipDestination"},USER_REVIEW_EDIT_SHIP_TRIP_TYPE:{actionSubType:"userReviewEditClick",itemType:"userReviewEditClick",itemName:"shipTripType"},USER_REVIEW_EDIT_VR_RECOMMENDATION:{actionSubType:"userReviewEditClick",itemType:"userReviewEditClick",itemName:"vrRecommendation"},USER_REVIEW_EDIT_AIRLINE_RECOMMENDATION_RATING:{actionSubType:"userReviewEditClick",itemType:"userReviewEditClick",itemName:"airlineRecommendationRating"},USER_REVIEW_EDIT_AIRLINE_TRIP_TYPE:{actionSubType:"userReviewEditClick",itemType:"userReviewEditClick",itemName:"airlineTripType"},USER_REVIEW_EDIT_AIRLINE_CLASS_OF_SERVICE:{actionSubType:"userReviewEditClick",itemType:"userReviewEditClick",itemName:"airlineClassOfService"},USER_REVIEW_EDIT_AIRLINE_FLYING_FROM:{actionSubType:"userReviewEditClick",itemType:"userReviewEditClick",itemName:"airlineFlyingFrom"},USER_REVIEW_EDIT_AIRLINE_FLYING_TO:{actionSubType:"userReviewEditClick",itemType:"userReviewEditClick",itemName:"airlineFlyingTo"},USER_REVIEW_EDIT_AIRLINE_FLIGHT_NUMBER:{actionSubType:"userReviewEditClick",itemType:"userReviewEditClick",itemName:"airlineFlightNumber"},USER_REVIEW_EDIT_TEXT_START:{actionSubType:"userReviewEditClick",itemType:"userReviewEditClick",itemName:"textBodyStart",itemId:"textBodyStart"},USER_REVIEW_EDIT_TEXT_COMPLETE:{actionSubType:"userReviewEditClick",itemType:"userReviewEditClick",itemName:"textBodyComplete",itemId:"textBodyComplete"},USER_REVIEW_EDIT_TITLE_START:{actionSubType:"userReviewEditClick",itemType:"userReviewEditClick",itemName:"TitleStart",itemId:"TitleStart"},USER_REVIEW_EDIT_PHOTO_UPLOAD_START:{actionSubType:"userReviewEditClick",itemType:"userReviewEditClick",itemName:"photoStart",itemId:"photoStart"},USER_REVIEW_EDIT_PHOTO_UPLOAD_CLOSE:{actionSubType:"userReviewPhotoModalClick",itemType:"userReviewPhotoModalClick",itemName:"closeCTA"},USER_REVIEW_EDIT_PHOTO_UPLOAD_ADD_MORE:{actionSubType:"userReviewPhotoModalClick",itemType:"userReviewPhotoModalClick",itemName:"addMorePhotosCTA"},USER_REVIEW_EDIT_PHOTO_UPLOAD_DELETE:{actionSubType:"userReviewPhotoModalClick",itemType:"userReviewPhotoModalClick",itemName:"deletePhotoCTA"},USER_REVIEW_EDIT_PHOTO_UPLOAD_ADD_CAPTION:{actionSubType:"userReviewPhotoModalClick",itemType:"userReviewPhotoModalClick",itemName:"addCaption"},USER_REVIEW_EDIT_PHOTO_UPLOAD_EDIT:{actionType:"click",actionSubType:"userReviewPhotoModalClick",itemType:"userReviewPhotoModalClick",itemName:"photoEdit"},USER_REVIEW_EDIT_CROP_PHOTO_MODAL_CLOSE:{actionSubType:"userReviewCropPhotoModalClick",itemType:"userReviewCropPhotoModalClick",itemName:"closeCTA"},USER_REVIEW_EDIT_CROP_PHOTO_MODAL_CROP_SIZE:{actionSubType:"userReviewCropPhotoModalClick",itemType:"userReviewCropPhotoModalClick",itemName:"cropSize"},USER_REVIEW_EDIT_CROP_PHOTO_MODAL_CROP_MANUAL:{actionSubType:"userReviewCropPhotoModalClick",itemType:"userReviewCropPhotoModalClick",itemName:"cropSize",itemId:"Manual"},USER_REVIEW_EDIT_CROP_PHOTO_MODAL_CROP_RESET:{actionSubType:"userReviewCropPhotoModalClick",itemType:"userReviewCropPhotoModalClick",itemName:"cropSize",itemId:"Reset"},USER_REVIEW_EDIT_CROP_PHOTO_MODAL_CROP_SAVE:{actionSubType:"userReviewCropPhotoModalClick",itemType:"userReviewCropPhotoModalClick",itemName:"cropSize",itemId:"Save"},USER_REVIEW_EDIT_PHOTO_UPLOAD_ATTACH:{actionSubType:"userReviewPhotoModalClick",itemType:"userReviewPhotoModalClick",itemName:"photoUpload"},USER_REVIEW_EDIT_TRUST_MODAL_ACCEPT:{actionSubType:"userReviewEditClick",itemType:"userReviewEditClick",itemName:"termsAgree",itemId:"termsAgree"},USER_REVIEW_EDIT_TRUST_MODAL_DECLINE:{actionSubType:"userReviewEditClick",itemType:"userReviewEditClick",itemName:"termsDecline",itemId:"termsDecline"},USER_REVIEW_EDIT_DRAFT_SUBMIT:{actionSubType:"userReviewEditClick",itemType:"userReviewEditClick",itemName:"submitClick",itemId:"submitClick"},USER_REVIEW_EDIT_ADDITIONAL_RATING:{actionSubType:"userReviewSubmitClick",itemType:"userReviewSubmitClickRate",itemName:"rateClick"},USER_REVIEW_EDIT_TIPS:{actionSubType:"userReviewSubmitClick",itemType:"userReviewSubmitClick",itemName:"tipsClick",itemId:"tipsClick"},USER_REVIEW_EDIT_TAGS:{actionSubType:"userReviewSubmitClick",itemType:"userReviewSubmitClickTag"},USER_REVIEW_EDIT_REVIEW_SUBMIT:{actionSubType:"userReviewSubmitClick",itemType:"userReviewSubmitClick",itemName:"submitClick",itemId:"submitClick"},USER_REVIEW_EDIT_CHANGE_ACTIVITY:{itemType:"userReviewEdit",itemName:"ChangeActivity"},USER_REVIEW_CELEBRATION_HOW_LONG:{itemType:"userReviewCelebration",itemName:"HowLong"},USER_REVIEW_CELEBRATION_PHONE_NUMBER:{itemType:"userReviewCelebration",itemName:"PhoneNumber"},USER_REVIEW_CELEBRATION_WEBSITE:{itemType:"userReviewCelebration",itemName:"Website"},USER_REVIEW_TOUR_SELECTION_MODAL_SEARCH_START:{itemType:"UserReviewTourSelectionModal",itemName:"SearchStart"},USER_REVIEW_TOUR_SELECTION_MODAL_SEARCH_SELECTED:{itemType:"UserReviewTourSelectionModal",itemName:"SearchSelected"},USER_REVIEW_TOUR_SELECTION_MODAL_DONT_REMEMBER:{itemType:"UserReviewTourSelectionModal",itemName:"IDontRemember"},USER_REVIEW_TOUR_SELECTION_MODAL_CTA_SEARCH_SELECTED:{itemType:"UserReviewTourSelectionModal",itemName:"CTA",actionSubType:"SearchSelected"},USER_REVIEW_TOUR_SELECTION_MODAL_CTA_DONT_REMEMBER:{itemType:"UserReviewTourSelectionModal",itemName:"CTA",actionSubType:"IDontRemember"},USER_REVIEW_TOUR_SELECTION_MODAL_CLOSE:{itemType:"UserReviewTourSelectionModal",itemName:"Close"},USER_REVIEW_TOUR_SELECTION_CTA_SEARCH_SELECTED:{itemType:"UserReviewTourSelection",itemName:"CTA",actionSubType:"SearchSelected"},USER_REVIEW_TOUR_SELECTION_CTA_DONT_REMEMBER:{itemType:"UserReviewTourSelection",itemName:"CTA",actionSubType:"IDontRemember"}},e_={GLOBAL_NAVIGATION:{itemType:"WriteReview",itemName:"GlobalNav",customData:JSON.stringify({})},POI_WRITE_REVIEW_HEADER:{itemType:"WriteReview",itemName:"PoiHeader"},POI_WRITE_REVIEW_SECTION:{itemType:"WriteReview",itemName:"PoiReivewSection"},USER_REVIEW_LANDER:{itemType:"userReviewLander",itemId:"userReviewLanderPage",itemName:"userReviewLanderPage"},USER_REVIEW_EDIT:{itemType:"userReviewEdit",itemId:"userReviewEditPage",itemName:"userReviewEditPage"},USER_REVIEW_EDIT_TRUST_MODAL:{itemType:"userReviewEdit",itemId:"userReviewEditTrustSafetyModal",itemName:"userReviewEditTrustSafetyModal"},USER_REVIEW_PHOTO_UPLOAD_MODAL:{itemType:"userReviewEdit",itemId:"userReviewPhotoModal",itemName:"userReviewPhotoModal"},USER_REVIEW_CROP_PHOTO_MODAL:{itemType:"userReviewEdit",itemId:"userReviewCropPhotoModal",itemName:"userReviewCropPhotoModal"},USER_REVIEW_SUBMIT:{itemType:"userReviewSubmit",itemId:"userReviewSubmitPage",itemName:"userReviewSubmitPage"},USER_REVIEW_CELEBRATION:{itemType:"userReviewCelebration",itemId:"userReviewCelebrationPage",itemName:"userReviewCelebrationPage"},USER_REVIEW_TOUR_SELECTION_MODAL_LANDER:{itemType:"UserReviewTourSelectionModal",itemName:"Lander"},USER_REVIEW_TOUR_SELECTION_PROVIDER_PAGE:{itemType:"UserReviewTourSelectionModal",itemName:"ProviderPage"},USER_REVIEW_TOUR_SELECTION_CHANGE_ACTIVITY:{itemType:"UserReviewTourSelectionModal",itemName:"UserReviewEditChangeActivity"}},ev={draftId:void 0,reviewId:void 0,partnerId:void 0,mcid:void 0,pid:void 0,geoId:null,locationId:null},eE=e5,eg=e9,eR=t.createContext({useAttractionLocationData:eg}),eC=ie,eT=ii,ew=it,eI=io,ef=ir,eS=il,ey=ic,eb=iu,eN=im,eP=["top",void 0,"bottom"].flatMap(e=>["left",void 0,"right"].map(i=>({verticalPosition:e,horizontalPosition:i}))),ek=c(function({index:e,horizontalPosition:i,verticalPosition:t,handleDragEnd:o,setMovingPointIndex:a,handlePointMovement:r},n){return h("div",{draggable:!1,className:E("OSJzt _S",{PMSaD:"top"===t,wEUGc:"bottom"===t,UQQUi:"left"===i,OjCBR:"right"===i}),role:"button",ref:n,tabIndex:0,onTouchStart:()=>{a(e)},onTouchEnd:o,onMouseDown:i=>{i.preventDefault(),a(e)},onKeyDown:o=>{["ArrowDown","ArrowLeft","ArrowUp","ArrowRight"].includes(o.key)&&o.preventDefault();var a=!i&&t?0:1,n=!t&&i?0:1;switch(o.key){case"ArrowDown":r(0,a,e);break;case"ArrowUp":r(0,-a,e);break;case"ArrowLeft":r(-n,0,e);break;case"ArrowRight":r(n,0,e)}},onKeyUp:o,children:h("div",{className:"aIfPz"})})}),eO=ih,eA=iv,eD=iE,eU=iR,eM={top:0,left:0,...iC},eL=iT,eV=iI,eW=iy,ex=iN,(eB=c(({renderDesktopView:e,renderMobileView:i,skipModalRender:t},r)=>{var{photos:l,croppingPhotos:s,setPhotos:c,setCroppingPhotos:p,uploadModalOpenState:m,setUploadModalOpenState:E,tracking:g,checkForCaptionProfanity:R,uploadResult:C,setUploadResult:T}=d(en),w="MOBILE"===y(),I=e=>{L?(V(!1),R(M,()=>{N(e)})):N(e)};u(r,()=>({uploadFiles:I,openPhotoUpload:b}));var f=o(e=>{var i=[...l],t=e.map(e=>e.uploadId),o=i.filter(e=>t.includes(e?.uploadId||""));i=l.map(e=>t.includes(e.uploadId||"")?null:e);var a=C.filter(e=>!!e.isDeleted).map(e=>e.uploadId);return e.filter(e=>!a.includes(e.uploadId)).forEach(e=>{var t=!!e.result?.mediaId;if(t||e.result?.definition){var a=i.findIndex(e=>null===e),r=-1!==a?a:i.length,n=o.find(i=>i?.uploadId===e.uploadId);i[r]={id:t?e.result.mediaId:-1,uploadId:e.uploadId,uploadDefinition:t?void 0:e.result?.definition,caption:n?n.caption:"",categoryId:n?n.categoryId:null}}}),i.filter(Boolean)},[l,C]),{photosResultQueue:S,open:b,uploadFiles:N,selectFiles:P}=X((e,i)=>{s.length>0?O(i):c(f(i))}),k=o(()=>{E(!1)},[E]),O=o((e=[])=>{if(s){g?.onCropPhotoModalSave&&g.onCropPhotoModalSave();var i=0;c(l.map(t=>{var o=s.find(e=>e.originalPhoto.id===t.id);if(o?.deleted)return null;if(o?.file){var a=e[i++],r=!!a?.result?.mediaId;return{id:r?a.result.mediaId:-1,caption:r?t.caption:"",categoryId:r?t.categoryId:null,uploadId:a.uploadId,uploadDefinition:r?void 0:a.result?.definition}}return t}).filter(Boolean)),p([])}},[g,s,p,l,c]),A=e=>{var i=l||[],t=i.splice(e,1);c(i),t[0]?.uploadId&&T(e=>e.map(e=>e.uploadId===t[0].uploadId?{...e,isDeleted:!0}:e))},D=()=>{g?.onDropzoneClick&&g.onDropzoneClick(),b()},U=(e=!0)=>{E(e)};n(()=>{g?.onModalOpen&&m&&g.onModalOpen()},[g,m]),n(()=>{var e=S.filter(e=>!!e.result);S.length>0&&(e.length!==C.filter(e=>!!e.result).length||C.every(e=>!!e.result))&&(c(f(e)),T(e=>{var i=e.filter(e=>e.isDeleted).map(e=>e.uploadId);return S.map(e=>i.includes(e.uploadId)?{...e,isDeleted:!0}:e)}))},[S,f,c,l,C,T]),n(()=>{k()},[w,k]),n(()=>{if(0===S.length&&s.length>0&&s.every(e=>e?.processed)){var e=s.map(e=>e?.file).filter(Boolean);e.length>0?P(e):O()}},[O,s,S,P,w]),n(()=>{s.length>0&&s.every(e=>"processed"in e)&&w&&m&&k()},[s,m,w,k]);var M=o(e=>{c(e)},[c]),[L,V]=a(!0);return n(()=>{m?V(!0):L&&(V(!1),R(M))},[m,V,L,R,M]),_(v,{children:[(!!m||s.length>0)&&h(ex,{skipModalRender:t}),w?i({onPhotoDelete:A,openAddPhotosModal:U,openPhotoUpload:D}):e({onPhotoDelete:A,openAddPhotosModal:U,openPhotoUpload:D})]})})).displayName="PhotoUpload",ez=eB,eF=ik,eH=iA,e({ActivitySelectionContext:eR,ActivitySelectionModal:eT,ActivitySelectionProvider:eC,ModerateBatch:eG,PHOTO_UPLOAD_LIMIT:is,PhotoUpload:ez,PhotoUploadContext:en,PhotoUploadLimitModal:ey,PhotoUploadProgress:eN,PhotoUploadProvider:eF,ReviewCard:ed,ReviewCards:es,ReviewSuggestions:eu,SubmitReview:iO,Viewport:ew,extractDraftFormValues:eJ,hasProfanityError:id,useAttractionLocationData:eg,useCheckForCaptionProfanity:el,useConstructPhotoElements:em,useDraftReviewsData:ef,useFetchPhotoElements:ep,useGetHotelCategoryDropdownOptions:eb,usePlaceholderQueryItems:eS,useSaveDraft:ec,useSubmitNonCoreFields:iU,useSubmitReview:eH,useUserReviewTracking:eE,useWarExperiencesToggle:eI})},[e=>(t=e,o=e.useCallback,a=e.useState,r=e.useMemo,n=e.useEffect,l=e.useRef,d=e.useContext,s=e.createRef,c=e.forwardRef,u=e.useImperativeHandle),e=>(p=e.useMutation,m=e.useQuery),e=>(h=e.jsx,_=e.jsxs,v=e.Fragment),e=>E=e.default,e=>(g=e.default,R=e.CircularButton,C=e.BorderlessButton),e=>T=e.default,e=>(w=e.default,I=e.useLocalize,f=e.useLocale,S=e.UnsafeLocalize),e=>y=e.useViewportCategory,e=>b=e.default,e=>N=e.default,e=>P=e.default,e=>(k=e.BubbleRatingInput,O=e.BubbleRating),e=>A=e.DropdownMenu,e=>D=e.default,e=>U=e.useDeviceId,e=>M=e.useUserId,e=>L=e.useRoute,e=>V=e.default,e=>W=e.default,e=>x=e.default,e=>B=e.uuid,e=>z=e.Modal,e=>(F=e.SearchableTextInput,H=e.TextArea),e=>G=e.Checkbox,e=>q=e.default,e=>Y=e.useUserAgent,e=>j=e.default,e=>K=e.Spinner,e=>$=e.default,e=>Q=e.default,e=>(X=e.useCustomPhotoUpload,J=e.FileSizeError,Z=e.FileTypeError),e=>ee=e.default,e=>ei=e.default,e=>et=e.ChipButton,e=>eo=e.default,e=>ea=e.default,e=>er=e.default]]},["1o4yt4","1mqwhq","121h32","fkji80","jppfwt","1essqv","17thqz","1ys6v1","1u47wj","34bu7w","1mvpl5","1bkeq2","1ntn26","lr6tb6","p5p2yo","52far5","fgwvq1","1r73jw","xg719z","19b9b1","1eww82","1i3sz5","1u3aio","frf6ac","p9ucm8","1nnprh","gugp1d","1qndsd","1kq4q2","gcjubj","1iahto","1i0z8n","14ilds","1b1clj","b5nukb","1qkjm8","1ypf49"]]);
