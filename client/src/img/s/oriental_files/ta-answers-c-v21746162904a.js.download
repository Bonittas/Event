require(['ta/rollupAmdShim'], function(rollupAmdShim) {rollupAmdShim.install(["answers/misc","answers/Question","answers/Answer","answers/minimal"],[]);});
if(window.requirejs && requirejs.taConfig)requirejs.taConfig({"deferred":{},"name":"build/concat/ta-answers","files":{"js3":{"src":{"answers":{"Answer":1,"minimal":1,"Question":1,"misc":1}}}},"_":{"baseUrl":"/"}});
define("answers/misc",["lib/jquery-amd","api-mod","overlays/Overlay","overlays/styles/modal","overlays/position","overlays/options/closeOnEscape","overlays/options/closeOnDocClick","overlays/options/autoReposition","overlays/styles/windowshade","overlays/options/ajax","ta/Core/TA.Store","utils/resourceLoader","ta/util/Cookie","ta/Core/TA.Record","ta/util/Error","utils/ajax","ta/Core/TA.LocalStorage","ta/Core/TA.Event","answers/minimal","ta/registration/RegOverlay","ta/registration/AuthCheck"],function(e,r,s,n,t,o,a,i,l,c,d,u,v,f,p,w,m,h,C,y,g){"use strict";var E={};E.checkForErrors=function(e,r){if(e.match(/^{/)){var c=JSON.parse(e),d=c.ERROR||c.ALERT;if(d){if(r){var u=new s(null,[n(null,"center","OverlayAjaxError",null,null,d),t.center([0,0]),i,o,a,l()]);return u.show(),!0}return d}if(c.REDIRECT)return window.location=c.REDIRECT,!0}return!1},E.getVerified=function(e){return"undefined"!=typeof travelAnswersUnverifiedCss&&u.load(travelAnswersUnverifiedCss),v.setPIDCookie(d.retrieve("answers.pid.owner.verification")),f.trackEventOnPage("answers_faq_owner_get_verified","owner_register_click",e),y.show({type:"dummy"},this,{flow:"OWNER",locationId:e,pid:"39538",userRequestedForce:"true",onClose:function(){location.reload()}}),!1},E.changeCount=function(r,s,n){e(s,r).each(function(r,s){var t=e(s).html().match(/(\D*)(\d*)(\D*)/);t[2]=parseInt(t[2],10)+n,e(s).html(t.slice(1).join(""))})},function(){var r;E.translate=function(u,v,f){r?(r.sourceElement=u,r.updateContent(v)):(r=new s(u,[n(u,"center","answersOverlay"),t.center([0,0]),i,o,a,l(),c(v,{resources:[f]})]),d.store("translationOverlay",r),e(r.container).css({"max-width":"90%",width:"800px"})),r.show()}}(),E.fetchNonIndexableQuestions=function(r,s){var n={"act":"fnnq","lcid":r,"ofst":s};E.ajax({data:n,evalScripts:!0,success:function(r){e("#QUESTION_LIST").append(r),ta.registration.runSuccessActionCookie()},error:function(e){p.record(null,"answers.fetchNonIndexableQuestions",null,{"ajaxError":e.response})}})},E.ajax=function(r){w(e.extend({url:"/AnswersAjax",method:"POST",dataType:"html",data:{altsessid:d.retrieve("altsessid")||""}},r))},E.pickTopicSort=function(e){return E.ajax({data:{"act":"pts","sortOrder":e.sortOrder},trackEvent:{module:"answers_faq_header",action:"answers_faq_sort",context:e.postSortUrl,value:e.sortOrder,noninteraction:!1},success:function(r,s){window.location.href=e.postSortUrl},error:function(e){}}),!1},E.handleCollapse=function(r,s){s=e(s);var n=s.closest("form").find(".submitWrap"),t=s.closest(".question");"focus"===r.type?(s.removeClass("collapsed"),n.removeClass("hidden"),e(".answerCTA",t).remove(),C.commonFocus(r,s.get(0))):d.retrieveOrStore("answers.preventBlur",!1)||s.val().trim()||(s.addClass("collapsed"),n.addClass("hidden")),d.store("answers.preventBlur",!1)},E.validationErrors=function(r,s){if(E.resetForm(s,!1),null!==r&&null!==r.responseText){var n=JSON.parse(r.responseText);if(null!==n.errors&&n.errors.length>0){var t=e("ul",s).first();n.errors.forEach(function(r){t.append(e("<li></li>").html("- "+r))}),t.show()}}else p.record(null,"answers.validationErrors",null,{"ajaxError":r.response})},E.disableForm=function(r){e(".postButton",r).hide(),e(".spinner",r).removeClass("hidden").addClass("submitSpinner")},E.resetForm=function(r,s){s&&(r.reset(),e("textarea",r).addClass("placeholder"));var n=e("ul",r).first();n.is(":visible")&&n.html("").hide(),e(".postButton",r).show(),e(".spinner",r).addClass("hidden").removeClass("submitSpinner")},E.askReviewerIntercept=function(e,r,a,u,v,f,p,w){var m={username:!0};if(g.isAuthorized(m)){var h=new s(e,[n(e,"center","answersOverlay"),t.center([0,0]),i,o,l(),c("/AnswersAjax",{reqParams:{act:"ari",lcid:r,altsessid:d.retrieve("altsessid")||"",screenname:a,reviewid:f,memberid:u,lang:v,subject:p}})]);h.on("hide",function(){d.remove("answers.messageTabLoaded"),d.remove("answers.pid.overlayType"),h.destroy()}),h.show()}else{if(!e)return!1;var C=arguments;E.logIn(null,w,function(){e.scrollIntoView(),E.askReviewerIntercept.apply(E,C)})}};var O={};return E.getOrStore=function(e,r){return 1==arguments.length?(O[e]=r,m.enabled&&(r?m.set(e,r,864e5):m.remove(e))):e in O||!m.enabled||(O[e]=m.get(e)),O[e]},E.logIn=function(e,r,s,n){var t={flow:n||"CONTENT_SUBMISSION",pid:r,userRequestedForce:!0,onSuccess:s};d.store("registration.ga_module","Answers"),v.setPIDCookie(r),y.show({type:"dummy"},e,t)},E.toggle=function(r,s){e(r).toggleClass("hidden",!s)},E});
define("answers/Question",["lib/jquery-amd","pages/inappropriate_vote_stub","api-mod","ta/Core/TA.Store","ta/util/Cookie","ta/Core/TA.Event","ta/util/Object","ta/Core/TA.Record","ta/util/ReCaptcha","ta/util/GeeTest","ta/util/Error","answers/misc","ta/registration/AuthCheck"],function(e,t,n,a,o,r,s,i,c,u,l,d,p){"use strict";function v(t){var n=e(t.topictext),a=n.val()||"";return a||n.focus(),a}var f=function(){var e;return function(){return e||(e=require("answers/Answer")),e}}(),g={};return g.topictext=function(e){return d.getOrStore("answers.question.topictext",e)},g.ask=function(e){var t=v(e);if(!t)return!1;var n={username:!0};return p.isAuthorized(n)?g.add(e):(g.topictext(t),d.logIn(e,a.retrieve("answers.pid.registration.question"),function(){e.scrollIntoView(),g.add(e)})),!1},g.validate=function(e){return!!v(e)&&(d.ajax({data:{"act":"vt","topicText":e.topictext.value,"token":e.token.value},success:function(t){"true"===t&&g.ask(e)},error:function(t){d.validationErrors(t,e)}}),!1)},g.confirm=function(e,t){return!!v(e)&&(d.ajax({data:{"act":"ssconf","async":!1},success:function(n){if("true"===n){var a={"type":"ask","act":"scd","screenname":t,"lcid":e.detail.value},o=function(){g.ask(e)};require(["answers/question_overlay_stub"],function(e){e.confirmDlg({data:a,onConfirm:o})})}else g.ask(e)}}),!1)},g.add=function(t){var o={username:!0};if(!p.isAuthorized(o))return!1;if(!t)return!1;var r=e(t.topictext),s={act:t.optin?"ats":"at",topicText:r.val(),detail:t.detail.value,pid:t.pid.value||a.retrieve("answers.pid.overlayType")||a.retrieve("answers.pid.pageType"),optIn:e("[name=optin]:checked",t).val()||"",altsessid:t.altsessid.value,token:t.token.value,"g-recaptcha-response":e(".recaptcha_input",t).val()||"",recaptchaSiteKey:e(t.recaptchaSiteKey).val()||"",geetest_challenge:e(t.geetest_challenge).val()||"",geetest_validate:e(t.geetest_validate).val()||"",geetest_seccode:e(t.geetest_seccode).val()||""};if(!s.topicText){var v=g.topictext();if(void 0===v)return l.record(null,"Called Question.add with no stored topic text in local storage or ta.store"),!1;s.topicText=v,r.val(v),r.focus()}return d.disableForm(t),d.ajax({data:s,evalScripts:!0,trackEvent:{module:"answers_faq_question_crud",action:"answers_faq_create_question",context:s.detail,value:0,noninteraction:!1},success:function(a){if(c.resetAll(),u.resetAll(),g.topictext(""),!d.checkForErrors(a,!0)){if(a.match(/^\/FAQ_Answers/))i.setEvtCookieAndPath("QuestionSubmit",a,document.getElementById("SBMT_QUESTION")),window.location=a;else{i.trk("QuestionSubmit",!1,document.getElementById("SBMT_QUESTION")),n.removeClass(".questionSection","hidden");var o=e(a).addClass("new");e("#QUESTION_LIST").append(o),setTimeout(function(){o.removeClass("new")},1)}0==e(t).closest(".ui_overlay").length&&d.resetForm(t,!0)}},error:function(e){c.resetAll(),u.resetAll(),i.trk("QuestionSubmit",!1,document.getElementById("SBMT_QUESTION")),d.validationErrors(e,t)}}),!1},g.answer=function(t){t.substr&&(t=document.getElementById(t));var n=e(t.posttext),o={username:!0};n.val()?p.isAuthorized(o)?f().add(t):(f().posttext(n),d.logIn(t,a.retrieve("answers.pid.registration.answer"),function(){t.scrollIntoView(),f().add(t)})):n.focus()},g.remove=function(t,n){var a=function(){d.ajax({data:{"act":"dt","tpcid":n.topicId,"token":n.token},trackEvent:{module:"answers_faq_question_crud",action:"answers_faq_delete_question",context:n.topicId,value:0,noninteraction:!1},success:function(a){n.locationUrl?window.location.href=n.locationUrl:(n.locationId?(f().updateAnswersTab(n.locationId),f().updateAnswersSidebar(n.locationId)):(e(t).parents(".questionList").children().length<=1&&e(t).parents(".questionSection").addClass("empty"),e(t).parents(".question").remove()),d.changeCount(document,".qaQuestionCount",-1))},error:function(e){l.ajaxFailure("Failed to remove question - Question.remove",e)}})};return require(["answers/question_overlay_stub"],function(e){e.confirmDlg({data:{act:"sdd",type:"question"},onConfirm:a})}),!1},g.showAnswers=function(t,n){t=e(t);var a=t.closest(".question"),o=e(".answerList",a),r=parseInt(a.attr("data-topicid"),10);if(t.attr("data-toggleMode"))return e(".showAnswersToggle",o).toggleClass("hidden"),e(".showAnswersToggle",t).toggleClass("hidden"),!1;var s=[];e(".basicAnswer",o).each(function(e,t){s.push(f().getAttribute("data-postingId"))});var i=parseInt(e(".postCountValue",t).html()||0);return d.ajax({data:{"act":"saa","tpcid":r,"lcid":window.modelLocId,"excpid":s.join(","),"tac":i,"rogp":n},trackEvent:{module:"answers_faq_additional_answers",action:"answers_faq_fetch_more",context:r,value:n?1:0,noninteraction:!1},success:function(a,s){d.checkForErrors(a,!0)||(t.attr("data-toggleMode",!0),o.append(a),e(".showAnswersToggle",t).toggleClass("hidden"),(!n||e(".postingSelector",o).length>=i)&&e("#morePostings_"+r,o).remove())},error:function(e){l.ajaxFailure("Failed to show answers - Question.showAnswers",e)}}),!1},g.iapFlyout=function(e,n,a){t.open(e,n,{voteContentType:"LOCATION_TOPIC",contentId:a})},g});
define("answers/Answer",["lib/jquery-amd","pages/inappropriate_vote_stub","api-mod","ta/Core/TA.Store","ta/util/ReCaptcha","ta/util/GeeTest","ta/util/Error","ta/Core/TA.Record","ta/Core/TA.Load","ta/util/Cookie","ta/Core/TA.Event","answers/misc","answers/Question","ta/registration/AuthCheck"],function(e,t,a,r,n,s,o,i,c,l,d,u,p,v){"use strict";var w,f={};f.posttext=function(e){return u.getOrStore("answers.answer.posttext",e)},f.buttonKey=function(e){return u.getOrStore("answers.answer.buttonId",e)},f.validate=function(t){var a=e(t.posttext).val();return a?(u.ajax({data:{"act":"vp","psttxt":a,"token":t.token.value},success:function(e){"true"===e&&p.answer(t)},error:function(e){u.validationErrors(e,t)}}),!1):(t.posttext.focus(),!1)},f.updateAnswersTab=function(t,a){var r=e("#ANSWERS_TAB_CONTENT");r.length&&u.ajax({data:{"act":"rqt","lcid":t},success:function(t){r.replaceWith(t);var n=p.topictext();n&&e(".topictext","#questionForm").val(n).focus(),a&&a()},error:function(e){o.ajaxFailure("Failed to update answers tab - exports.updateAnswersTab",e)}})},f.updateAnswersSidebar=function(t){var a=document.getElementById("QA_SIDEBAR");a&&u.ajax({data:{"act":"rqs","d":t},evalScripts:!0,success:function(t){e(a).replaceWith(t);var r=document.getElementById("questionFormSidebar");r&&p.topictext()&&p.add(r)},error:function(e){o.ajaxFailure("Failed to update answers sidebar - Answer.updateAnswersSidebar",e)}})},f.add=function(t){var a={username:!0};if(!v.isAuthorized(a))return!1;var l=e(t.posttext),d={act:"ap",psttxt:l.val(),tpcid:t.topicid.value,pid:r.retrieve("answers.pid.pageType"),altsessid:t.altsessid.value,token:t.token.value,lcid:t.lcid.value,"g-recaptcha-response":e(".recaptcha_input",t).val()||"",recaptchaSiteKey:e(t.recaptchaSiteKey).val()||"",geetest_challenge:e(t.geetest_challenge).val()||"",geetest_validate:e(t.geetest_validate).val()||"",geetest_seccode:e(t.geetest_seccode).val()||""};if(!d.psttxt||l.attr("placeholder")===d.psttxt){var g=f.posttext();if(void 0===g)return o.record(null,"Called Answer.add with no stored topic text in local storage or ta.store"),!1;d.psttxt=g;var m=f.buttonKey();m&&(f.showForm(document.getElementById(m),!1),f.buttonKey("")),l.val(g).focus()}return u.disableForm(t),u.ajax({data:d,evalScripts:!0,trackEvent:{module:"answers_faq_answer_crud",action:"answers_faq_create_answer",context:d.tpcid,value:0,noninteraction:!1},success:function(a){if(n.resetAll(),s.resetAll(),p.topictext(""),f.posttext(""),f.buttonKey(""),!u.checkForErrors(a,!0)){h(d.tpcid),e(".answerSection").removeClass("empty hidden"),u.changeCount(document.getElementById("question_"+d.tpcid),".postCountValue",1);var r=e(a).addClass("new");e("#showMore_"+d.tpcid).attr("data-togglemode")&&r.addClass("showAnswersToggle");var o=e("#ANSWERS_"+d.tpcid),i=r.filter(":not(.ownerAnswer)");window.location.pathname.match(/^FAQ-/)?o.prepend(i):o.append(i),o.prepend(r.filter(".ownerAnswer")),setTimeout(function(){r.removeClass("new")},1),u.resetForm(t,!0),e(t).closest(".answerForm").addClass("hidden")}},error:function(a){if(n.resetAll(),s.resetAll(),u.resetForm(t,!1),a.responseText){var r=JSON.parse(a.responseText),l=e("ul",t).first();if(r.errors&&r.errors.length>0)r.errors.forEach(function(t){l.append(e("<li></li>").html("- "+t))}),l.show();else if(r.unverifiedOwner){i.trackEventOnPage("answers_faq_owner_get_verified","answer_form_click",r.locationId),c.load("travel-answers-unverified.js",null);var d="/AnswersAjax?act=sgv&detail="+r.locationId;w?(w.show(),w.updateContent(d)):require(["overlays/Overlay","overlays/styles/modal","overlays/position","overlays/options/autoReposition","overlays/styles/windowshade","overlays/options/ajax"],function(e,t,a,r,n,s){w=new e(null,[t(null,"center","small guidelinesOverlay"),a.center([0,0]),r,n(),s(d)]),w.show()})}}else o.ajaxFailure("Failed to add answer - Answer.add",a)}}),i.trk("AnswerSubmit",!1,t),!1},f.remove=function(t,a,r,n){var s=function(){u.ajax({data:{"act":"dp","pstid":r,"token":n},trackEvent:{module:"answers_faq_answer_crud",action:"answers_faq_delete_answer",context:r,value:0,noninteraction:!1},success:function(n){if(!u.checkForErrors(n,!0)){h(a);var s=e(t).closest(".answerList");if(s.length){if(1==e(".basicAnswer",s).length){f.showForm(t,!0);var o=e(t).closest(".question");e(".postCount",o).addClass("hidden"),u.changeCount(o.get(0),".postCountValue",-1)}1==e(".answer",s).length&&s.closest(".answerSection").addClass("hidden")}e("#posting_"+r).remove()}},error:function(e){o.ajaxFailure("Failed to delete answer - Answer.deleteAnswer",e)}})};return require(["answers/question_overlay_stub"],function(e){e.confirmDlg({data:{act:"sdd",type:"answer"},onConfirm:s})}),!1},function(){function t(t,a){if(!v.isAuthorized())return ta.registration.getSuccessActionCookie(),!1;var n={"act":"av","pstid":t.postid.value,"vs":a,"pid":r.retrieve("answers.pid.pageType"),"token":t.token.value};return u.ajax({data:n,trackEvent:{module:"answers_faq_vote",action:"answers_faq_vote_add",context:n.pstid,value:n.vs,noninteraction:!1},success:function(a){if(!u.checkForErrors(a,!0)&&a){var r=e(a);if(1==r.length){var n=e(".tooltip",r);n.addClass("new"),e(t).replaceWith(r),setTimeout(function(){n.removeClass("new")},1),setTimeout(function(){e(".message",r).hide()},5e3)}}},error:function(e){o.ajaxFailure("Failed to vote - Answer.vote",e)}}),!1}var a=function(a,n){var s=e(a).closest("form").get(0);v.isAuthorized()?t(s,n):u.logIn(s,r.retrieve("answers.pid.registration.vote"),function(){a.scrollIntoView(),t(s,n)},"CORE_COMBINED")};f.voteUp=function(e){return a(e,1),!1},f.voteDown=function(e){return a(e,-1),!1}}(),f.iapFlyout=function(e,a,r){t.open(e,a,{voteContentType:"LOCATION_POSTING",contentId:r})},f.showForm=function(t,a){var r=e(t).closest(".question").find(".answerForm");r.addClass("wasHidden").removeClass("hidden"),a||e("textarea",r).focus(),f.buttonKey(t.id)};var h=function(t){var a=e("#QA_POST_COUNT");a.length&&u.ajax({data:{"act":"rac","tpcid":t},success:function(t){var r=e(t);1==r.length&&a.replaceWith(r)},error:function(e){o.ajaxFailure("Failed to refresh answer count - Answer.refreshAnswerCount",e)}})};return f});
define("answers/minimal",["vanillajs","ta/Core/TA.Load"],function(n,a){return{commonFocus:a.load.bind(a,"altsess.js",null)}});
