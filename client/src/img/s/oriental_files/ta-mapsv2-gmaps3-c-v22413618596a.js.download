Fx.implement({getTransition:function(){var n=this.options.transition||Fx.Transitions.Sine.easeInOut;if("string"==typeof n){var t=n.split(":");n=Fx.Transitions,n=n[t[0]]||n[t[0].capitalize()],t[1]&&(n=n["ease"+t[1].capitalize()+(t[2]?t[2].capitalize():"")])}return n}}),Fx.Transition=function(n,t){return t=Array.convert(t),Object.append(n,{easeIn:function(i){return n(i,t)},easeOut:function(i){return 1-n(1-i,t)},easeInOut:function(i){return i<=.5?n(2*i,t)/2:(2-n(2*(1-i),t))/2}})},Fx.Transitions={linear:function(n){return n}},Fx.Transitions.extend=function(n){for(var t in n)Fx.Transitions[t]=new Fx.Transition(n[t])},Fx.Transitions.extend({Pow:function(n,t){return Math.pow(n,t&&t[0]||6)},Expo:function(n){return Math.pow(2,8*(n-1))},Circ:function(n){return 1-Math.sin(Math.acos(n))},Sine:function(n){return 1-Math.sin((1-n)*Math.PI/2)},Back:function(n,t){return t=t&&t[0]||1.618,Math.pow(n,2)*((t+1)*n-t)},Bounce:function(n){for(var t,i=0,r=1;1;i+=r,r/=2)if(n>=(7-4*i)/11){t=r*r-Math.pow((11-6*i-11*n)/4,2);break}return t},Elastic:function(n,t){return Math.pow(2,10*--n)*Math.cos(20*n*Math.PI*(t&&t[0]||1)/3)}}),["Quad","Cubic","Quart","Quint"].each(function(n,t){Fx.Transitions[n]=new Fx.Transition(function(n){return Math.pow(n,[t+2])})});
!function(){var t=function(t,e){var i=[];return Object.each(e,function(e){Object.each(e,function(e){t.each(function(t){i.push(t+"-"+e+("border"==t?"-width":""))})})}),i},e=function(t,e){var i=0;return Object.each(e,function(e,n){n.test(t)&&(i+=e.toInt())}),i};Element.implement({measure:function(t,e){var i=function(t){return!(t&&!t.offsetHeight&&!t.offsetWidth)};if(!e&&i(this))return t.apply(this);for(var n=this.getParent(),o=[];!i(n)&&n!=document.body;)o.push(n.expose(e)),n=n.getParent();var h=this.expose(e),s=t.apply(this);return h(),o.each(function(t){t()}),s},expose:function(t){if(!t&&"none"!=this.getStyle("display"))return function(){};var e=this.style.cssText;return this.setStyles({display:"block",position:"absolute",visibility:"hidden","max-height":"none"}),function(){this.style.cssText=e}.bind(this)},getDimensions:function(t){t=Object.merge({computeSize:!1},t);var e={x:0,y:0},i=function(t,e){return e.computeSize?t.getComputedSize(e):t.getSize()},n=this.getParent("body");if(n&&"none"==this.getStyle("display"))e=this.measure(function(){return i(this,t)});else if(n)try{e=i(this,t)}catch(t){}return Object.append(e,e.x||0===e.x?{width:e.x,height:e.y}:{x:e.width,y:e.height})},getComputedSize:function(i){i=Object.merge({styles:["padding","border"],planes:{height:["top","bottom"],width:["left","right"]},mode:"both"},i);var n={},o={width:0,height:0};return"vertical"==i.mode?(delete o.width,delete i.planes.width):"horizontal"==i.mode&&(delete o.height,delete i.planes.height),t(i.styles,i.planes).each(function(t){n[t]=this.getStyle(t).toInt()},this),Object.each(i.planes,function(t,i){var h=i.capitalize();n[i]=this.getStyle(i).toInt(),o["total"+h]=n[i],t.each(function(t){var i=e(t,n);o["computed"+t.capitalize()]=i,o["total"+h]+=i})},this),Object.append(o,n)}})}();
!function(){var t=!1,i=!1,e=function(){var e=new Element("div").setStyles({position:"fixed",top:0,right:0}).inject(document.body);t=0===e.offsetTop,e.dispose(),i=!0};Element.implement({pin:function(n,s){if(i||e(),"none"==this.getStyle("display"))return this;var o,r=window.getScroll();if(n!==!1){if(o=this.getPosition(t?document.body:this.getOffsetParent()),!this.retrieve("pin:_pinned")){var l={top:o.y-r.y,left:o.x-r.x};if(t&&!s)this.setStyle("position","fixed").setStyles(l);else{var p=this.getOffsetParent(),h=this.getPosition(p),f=this.getStyles("left","top");(p&&"auto"==f.left||"auto"==f.top)&&this.setPosition(h),"static"==this.getStyle("position")&&this.setStyle("position","absolute"),h={x:f.left.toInt()-r.x,y:f.top.toInt()-r.y};var d=function(){if(this.retrieve("pin:_pinned")){var t=window.getScroll();this.setStyles({left:h.x+t.x,top:h.y+t.y})}}.bind(this);this.store("pin:_scrollFixer",d),window.addEvent("scroll",d)}this.store("pin:_pinned",!0)}}else{if(!this.retrieve("pin:_pinned"))return this;var p=this.getParent(),a="static"!=p.getComputedStyle("position")?p:p.getOffsetParent();o=this.getPosition(a),this.store("pin:_pinned",!1);var d=this.retrieve("pin:_scrollFixer");d?(this.store("pin:_scrollFixer",null),window.removeEvent("scroll",d)):this.setStyles({position:"absolute",top:o.y+r.y,left:o.x+r.x}),this.removeClass("isPinned")}return this},unpin:function(){return this.pin(!1)},togglepin:function(){return this.pin(!this.retrieve("pin:_pinned"))}})}();
!function(){var t=Element.prototype.position;Element.implement({position:function(e){if(e&&(null!=e.x||null!=e.y))return t?t.apply(this,arguments):this;Object.each(e||{},function(t,o){null==t&&delete e[o]}),e=Object.merge({relativeTo:document.body,position:{x:"center",y:"center"},offset:{x:0,y:0}},e);var o={x:0,y:0},i=!1,n=this.measure(function(){return document.id(this.getOffsetParent())});n&&n!=this.getDocument().body&&(o=n.measure(function(){return this.getPosition()}),i=n!=document.id(e.relativeTo),e.offset.x=e.offset.x-o.x,e.offset.y=e.offset.y-o.y);var r=function(t){if("string"!=typeOf(t))return t;t=t.toLowerCase();var e={};return t.test("left")?e.x="left":t.test("right")?e.x="right":e.x="center",t.test("upper")||t.test("top")?e.y="top":t.test("bottom")?e.y="bottom":e.y="center",e};e.edge=r(e.edge),e.position=r(e.position),e.edge||("center"==e.position.x&&"center"==e.position.y?e.edge={x:"center",y:"center"}:e.edge={x:"left",y:"top"}),this.setStyle("position","absolute");var s=document.id(e.relativeTo)||document.body,a=s==document.body?window.getScroll():s.getPosition(),f=a.y,l=a.x,c=this.getDimensions({computeSize:!0,styles:["padding","border","margin"]}),g={},m=e.offset.y,d=e.offset.x,y=window.getSize();switch(e.position.x){case"left":g.x=l+d;break;case"right":g.x=l+d+s.offsetWidth;break;default:g.x=l+(s==document.body?y.x:s.offsetWidth)/2+d}switch(e.position.y){case"top":g.y=f+m;break;case"bottom":g.y=f+m+s.offsetHeight;break;default:g.y=f+(s==document.body?y.y:s.offsetHeight)/2+m}if(e.edge){var u={};switch(e.edge.x){case"left":u.x=0;break;case"right":u.x=-c.x-c.computedRight-c.computedLeft;break;default:u.x=-(c.totalWidth/2)}switch(e.edge.y){case"top":u.y=0;break;case"bottom":u.y=-c.y-c.computedTop-c.computedBottom;break;default:u.y=-(c.totalHeight/2)}g.x+=u.x,g.y+=u.y}g={left:(g.x>=0||i||e.allowNegative?g.x:0).toInt(),top:(g.y>=0||i||e.allowNegative?g.y:0).toInt()};var p={left:"x",top:"y"};if(["minimum","maximum"].each(function(t){["left","top"].each(function(o){var i=e[t]?e[t][p[o]]:null;null!=i&&("minimum"==t?g[o]<i:g[o]>i)&&(g[o]=i)})}),"fixed"==s.getStyle("position")||e.relFixedPosition){var x=window.getScroll();g.top+=x.y,g.left+=x.x}if(e.ignoreScroll){var h=s.getScroll();g.top-=h.y,g.left-=h.x}return e.ignoreMargins&&(g.left+="right"==e.edge.x?c["margin-right"]:"center"==e.edge.x?-c["margin-left"]+(c["margin-right"]+c["margin-left"])/2:-c["margin-left"],g.top+="bottom"==e.edge.y?c["margin-bottom"]:"center"==e.edge.y?-c["margin-top"]+(c["margin-bottom"]+c["margin-top"])/2:-c["margin-top"]),g.left=Math.ceil(g.left),g.top=Math.ceil(g.top),e.returnPos?g:(this.setStyles(g),this)}})}();
var Drag=new Class({Implements:[Events,Options],options:{snap:6,unit:"px",grid:!1,style:!0,limit:!1,handle:!1,invert:!1,preventDefault:!1,stopPropagation:!1,modifiers:{x:"left",y:"top"}},initialize:function(){var t=Array.link(arguments,{"options":Type.isObject,"element":function(t){return null!=t}});this.element=document.id(t.element),this.document=this.element.getDocument(),this.setOptions(t.options||{});var e=typeOf(this.options.handle);this.handles=("array"==e||"collection"==e?$$(this.options.handle):document.id(this.options.handle))||this.element,this.mouse={"now":{},"pos":{}},this.value={"start":{},"now":{}},this.selection=Browser.ie?"selectstart":"mousedown",Browser.ie&&!Drag.ondragstartFixed&&(document.ondragstart=Function.from(!1),Drag.ondragstartFixed=!0),this.bound={start:this.start.bind(this),check:this.check.bind(this),drag:this.drag.bind(this),stop:this.stop.bind(this),cancel:this.cancel.bind(this),eventStop:Function.from(!1)},this.attach()},attach:function(){return this.handles.addEvent("mousedown",this.bound.start),this},detach:function(){return this.handles.removeEvent("mousedown",this.bound.start),this},start:function(t){var e=this.options;if(!t.rightClick){e.preventDefault&&t.preventDefault(),e.stopPropagation&&t.stopPropagation(),this.mouse.start=t.page,this.fireEvent("beforeStart",this.element);var i=e.limit;this.limit={x:[],y:[]};var s=this.element.getStyles("left","right","top","bottom");this._invert={x:"left"==e.modifiers.x&&"auto"==s.left&&!isNaN(s.right.toInt())&&(e.modifiers.x="right"),y:"top"==e.modifiers.y&&"auto"==s.top&&!isNaN(s.bottom.toInt())&&(e.modifiers.y="bottom")};var n,o;for(n in e.modifiers)if(e.modifiers[n]){var h=this.element.getStyle(e.modifiers[n]);if(h&&!h.match(/px$/)&&(o||(o=this.element.getCoordinates(this.element.getOffsetParent())),h=o[e.modifiers[n]]),e.style?this.value.now[n]=(h||0).toInt():this.value.now[n]=this.element[e.modifiers[n]],e.invert&&(this.value.now[n]*=-1),this._invert[n]&&(this.value.now[n]*=-1),this.mouse.pos[n]=t.page[n]-this.value.now[n],i&&i[n])for(var r=2;r--;){var a=i[n][r];(a||0===a)&&(this.limit[n][r]="function"==typeof a?a():a)}}"number"==typeOf(this.options.grid)&&(this.options.grid={x:this.options.grid,y:this.options.grid});var m={mousemove:this.bound.check,mouseup:this.bound.cancel};m[this.selection]=this.bound.eventStop,this.document.addEvents(m)}},check:function(t){this.options.preventDefault&&t.preventDefault();var e=Math.round(Math.sqrt(Math.pow(t.page.x-this.mouse.start.x,2)+Math.pow(t.page.y-this.mouse.start.y,2)));e>this.options.snap&&(this.cancel(),this.document.addEvents({mousemove:this.bound.drag,mouseup:this.bound.stop}),this.fireEvent("start",[this.element,t]).fireEvent("snap",this.element))},drag:function(t){var e=this.options;e.preventDefault&&t.preventDefault(),this.mouse.now=t.page;for(var i in e.modifiers)e.modifiers[i]&&(this.value.now[i]=this.mouse.now[i]-this.mouse.pos[i],e.invert&&(this.value.now[i]*=-1),this._invert[i]&&(this.value.now[i]*=-1),e.limit&&this.limit[i]&&((this.limit[i][1]||0===this.limit[i][1])&&this.value.now[i]>this.limit[i][1]?this.value.now[i]=this.limit[i][1]:(this.limit[i][0]||0===this.limit[i][0])&&this.value.now[i]<this.limit[i][0]&&(this.value.now[i]=this.limit[i][0])),e.grid[i]&&(this.value.now[i]-=(this.value.now[i]-(this.limit[i][0]||0))%e.grid[i]),e.style?this.element.setStyle(e.modifiers[i],this.value.now[i]+e.unit):this.element[e.modifiers[i]]=this.value.now[i]);this.fireEvent("drag",[this.element,t])},cancel:function(t){this.document.removeEvents({mousemove:this.bound.check,mouseup:this.bound.cancel}),t&&(this.document.removeEvent(this.selection,this.bound.eventStop),this.fireEvent("cancel",this.element))},stop:function(t){var e={mousemove:this.bound.drag,mouseup:this.bound.stop};e[this.selection]=this.bound.eventStop,this.document.removeEvents(e),t&&this.fireEvent("complete",[this.element,t])}});Element.implement({makeResizable:function(t){var e=new Drag(this,Object.merge({modifiers:{x:"width",y:"height"}},t));return this.store("resizer",e),e.addEvent("drag",function(){this.fireEvent("resize",e)}.bind(this))}});
Drag.Move=new Class({Extends:Drag,options:{droppables:[],container:!1,precalculate:!1,includeMargins:!0,checkDroppables:!0},initialize:function(t,e){if(this.parent(t,e),t=this.element,this.droppables=$$(this.options.droppables),this.container=document.id(this.options.container),this.container&&"element"!=typeOf(this.container)&&(this.container=document.id(this.container.getDocument().body)),this.options.style){if("left"==this.options.modifiers.x&&"top"==this.options.modifiers.y){var i=t.getOffsetParent(),o=t.getStyles("left","top");!i||"auto"!=o.left&&"auto"!=o.top||t.setPosition(t.getPosition(i))}"static"==t.getStyle("position")&&t.setStyle("position","absolute")}this.addEvent("start",this.checkDroppables,!0),this.overed=null},start:function(t){this.container&&(this.options.limit=this.calculateLimit()),this.options.precalculate&&(this.positions=this.droppables.map(function(t){return t.getCoordinates()})),this.parent(t)},calculateLimit:function(){var t=this.element,e=this.container,i=document.id(t.getOffsetParent())||document.body,o=e.getCoordinates(i),s={},n={},r={},l={},a={};["top","right","bottom","left"].each(function(o){s[o]=t.getStyle("margin-"+o).toInt(),n[o]=t.getStyle("border-"+o).toInt(),r[o]=e.getStyle("margin-"+o).toInt(),l[o]=e.getStyle("border-"+o).toInt(),a[o]=i.getStyle("padding-"+o).toInt()},this);var p=t.offsetWidth+s.left+s.right,h=t.offsetHeight+s.top+s.bottom,c=0,f=0,d=o.right-l.right-p,g=o.bottom-l.bottom-h;if(this.options.includeMargins?(c+=s.left,f+=s.top):(d+=s.right,g+=s.bottom),"relative"==t.getStyle("position")){var u=t.getCoordinates(i);u.left-=t.getStyle("left").toInt(),u.top-=t.getStyle("top").toInt(),c-=u.left,f-=u.top,"relative"!=e.getStyle("position")&&(c+=l.left,f+=l.top),d+=s.left-u.left,g+=s.top-u.top,e!=i&&(c+=r.left+a.left,f+=(Browser.ie6||Browser.ie7?0:r.top)+a.top)}else c-=s.left,f-=s.top,e!=i&&(c+=o.left+l.left,f+=o.top+l.top);return{x:[c,d],y:[f,g]}},checkDroppables:function(){var t=this.droppables.filter(function(t,e){t=this.positions?this.positions[e]:t.getCoordinates();var i=this.mouse.now;return i.x>t.left&&i.x<t.right&&i.y<t.bottom&&i.y>t.top},this).getLast();this.overed!=t&&(this.overed&&this.fireEvent("leave",[this.element,this.overed]),t&&this.fireEvent("enter",[this.element,t]),this.overed=t)},drag:function(t){this.parent(t),this.options.checkDroppables&&this.droppables.length&&this.checkDroppables()},stop:function(t){return this.checkDroppables(),this.fireEvent("drop",[this.element,this.overed,t]),this.overed=null,this.parent(t)}}),Element.implement({makeDraggable:function(t){var e=new Drag.Move(this,t);return this.store("dragger",e),e}});
ta.maps=ta.maps||{},ta.maps.util=ta.maps.util||{},ta.maps.util.GeoPoint=function(t,a){this.lat=function(){return t},this.lng=function(){return a},this.toUrlValue=function(){return t+","+a}},ta.maps.util.GeoPoint.Rconst=6378137;var rad=function(t){return t*Math.PI/180};ta.maps.util.GeoPoint.calculateDistance=function(t,a){var n=rad(t.lat()),i=rad(a.lat()),s=rad(a.lat()-t.lat()),o=rad(a.lng()-t.lng()),r=Math.sin(s/2)*Math.sin(s/2)+Math.cos(n)*Math.cos(i)*Math.sin(o/2)*Math.sin(o/2),u=2*Math.atan2(Math.sqrt(r),Math.sqrt(1-r));return ta.maps.util.GeoPoint.Rconst*u},ta.LatLng=ta.maps.util.GeoPoint;
ta.maps=ta.maps||{},ta.maps.util=ta.maps.util||{},ta.maps.util.GeoRect=function(t,n){var a=this;a.getSW=function(){return t},a.getNE=function(){return n},a.N=function(){return n.lat()},a.E=function(){return n.lng()},a.S=function(){return t.lat()},a.W=function(){return t.lng()},a.centerPoint=function(){var t=.5*(a.N()+a.S()),n=.5*(a.E()+a.W());return new ta.maps.util.GeoPoint(t,n)},a.getRadius=function(){var t=a.N()-a.S(),n=a.W()-a.E();return Math.sqrt(t*t+n*n)/2}},ta.maps.util.GeoRect.fromCardinal=function(t,n,a,u){var e=new ta.maps.util.GeoPoint(a,u),i=new ta.maps.util.GeoPoint(t,n);return new this(e,i)},ta.LatLngBds=ta.maps.util.GeoRect;
ta.maps=ta.maps||{},ta.maps.util=ta.maps.util||{},function(o){function t(o){if(o&&o.polygon)return o.coordinates=r(o.polygon),delete o.polygon,o}function r(o){if(o&&o.hasOwnProperty("coordinates")){var t=o.coordinates;if(t)return t[0].map(e)}}function e(o){return new ta.maps.util.GeoPoint(o[1],o[0])}o.getPolygonsFromTa=function(o){if(ta.has(o)){var t=ta.util.escaping.unescapeHTMLSafe(ta.retrieve(o));if(t)try{return ta.maps.util.readPolygonFromJson(t)}catch(o){ta.util.error.record(o,"Failed to parse polygons JSON: '"+t+"'.")}}return null},o.readPolygonFromJson=function(o){try{return t(JSON.decode?JSON.decode(o):JSON.parse(o))}catch(o){ta.util.error.record(o,"Failed to parse polygon JSON.")}},o.readPolygonListFromJson=function(o){try{var r=JSON.decode?JSON.decode(o):JSON.parse(o);return r.map(t)}catch(o){ta.util.error.record(o,"Failed to parse polygon JSON.")}},o.getFirstPolygonPoint=function(o){return o&&o.coordinates&&o.coordinates[0]?o.coordinates[0]:null}}(ta.maps.util);
var NotImplementedError=function e(t){this.name="NotImplemented",this.message=this.description=t||(arguments.caller||e.caller||{}).name+" has not yet been implemented."};NotImplementedError.prototype=new Error,NotImplementedError.prototype.constructor=NotImplementedError;
ta.api||(ta.api={}),ta.api.maps=ta.api.maps||{},ta.api.maps.provider=ta.api.maps.provider||{},ta.api.maps.constants={DISTANCE_INTERVALS:[.3,1,2,5,10,25],THIRTY_SECONDS:3e4,TWO_MINUTES:12e4,FIFTY_METERS:50,RAD_PER_DEGREE:.01745329251},ta.api.maps.styles={activePolygon:{strokeColor:"#00a680",strokeOpacity:1,strokeWeight:3,fillColor:"#00a680",fillOpacity:.55},idlePolygon:{strokeColor:"#4D6F41",strokeOpacity:.7,strokeWeight:1.5,fillColor:"#9DCA8C",fillOpacity:.22},highlightedPolygon:{strokeColor:"#FF9900",strokeOpacity:.7,strokeWeight:3,fillColor:"#FF9900",fillOpacity:.25}},ta.api.maps.providerFactory={createProviderInterfaceInstance:function(){return new ta.api.maps.ProviderInterface}},ta.api.maps.ProviderInterface=function(){},ta.api.maps.ProviderInterface.prototype.onload=function(){throw new NotImplementedError},ta.api.maps.ProviderInterface.prototype.setupMap=function(e){throw new NotImplementedError},ta.api.maps.ProviderInterface.prototype.renderInfoWindow=function(e,r,t){throw new NotImplementedError},ta.api.maps.ProviderInterface.prototype.renderHoverInfoWindowAtPosition=function(e,r,t,o){throw new NotImplementedError},ta.api.maps.ProviderInterface.prototype.closeInfoWindow=function(){throw new NotImplementedError},ta.api.maps.ProviderInterface.prototype.renderHoverInfoWindow=function(e,r,t){throw new NotImplementedError},ta.api.maps.ProviderInterface.prototype.closeHoverInfoWindow=function(){throw new NotImplementedError},ta.api.maps.ProviderInterface.prototype.isHoverInfoWindowOpen=function(){throw new NotImplementedError},ta.api.maps.ProviderInterface.prototype.getHoverInfoWindowMarkerId=function(){throw new NotImplementedError},ta.api.maps.ProviderInterface.prototype.getInfoWindowMarkerId=function(){throw new NotImplementedError},ta.api.maps.ProviderInterface.prototype.userLocationSuccess=function(){throw new NotImplementedError},ta.api.maps.ProviderInterface.prototype.userLocationError=function(){throw new NotImplementedError},ta.api.maps.ProviderInterface.prototype.userLocationHandler=function(){throw new NotImplementedError},ta.api.maps.ProviderInterface.prototype.mapDoneMovingCallback=function(){throw new NotImplementedError},ta.api.maps.ProviderInterface.prototype.panToLocation=function(e,r,t){throw new NotImplementedError},ta.api.maps.ProviderInterface.prototype.onceOnFinishedDrawing=function(e){throw new NotImplementedError},ta.api.maps.ProviderInterface.prototype.setCenter=function(e){throw new NotImplementedError},ta.api.maps.ProviderInterface.prototype.panToMarker=function(e){throw new NotImplementedError},ta.api.maps.ProviderInterface.prototype.setZoom=function(e){throw new NotImplementedError},ta.api.maps.ProviderInterface.prototype.zoomIn=function(){throw new NotImplementedError},ta.api.maps.ProviderInterface.prototype.zoomOut=function(){throw new NotImplementedError},ta.api.maps.ProviderInterface.prototype.hasMarker=function(e){throw new NotImplementedError},ta.api.maps.ProviderInterface.prototype.getZoom=function(){throw new NotImplementedError},ta.api.maps.ProviderInterface.prototype.getMapMode=function(e){throw new NotImplementedError},ta.api.maps.ProviderInterface.prototype.setMapMode=function(e){throw new NotImplementedError},ta.api.maps.ProviderInterface.prototype.getBounds=function(){throw new NotImplementedError},ta.api.maps.ProviderInterface.prototype.getCenter=function(){throw new NotImplementedError},ta.api.maps.ProviderInterface.prototype.getBestDistanceForZoom=function(){throw new NotImplementedError},ta.api.maps.ProviderInterface.prototype.fitBounds=function(e,r){throw new NotImplementedError},ta.api.maps.ProviderInterface.prototype.fitToSelf=function(){throw new NotImplementedError},ta.api.maps.ProviderInterface.prototype.shouldAdjustForInfoWindow=function(){throw new NotImplementedError},ta.api.maps.ProviderInterface.prototype.constructMarkerDef=function(e,r,t,o,n){throw new NotImplementedError},ta.api.maps.ProviderInterface.prototype.addPolygon=function(e,r,t){throw new NotImplementedError},ta.api.maps.ProviderInterface.prototype.updatePolygonOptions=function(e,r){throw new NotImplementedError},ta.api.maps.ProviderInterface.prototype.addMarkerFromMarkerDef=function(e){throw new NotImplementedError},ta.api.maps.ProviderInterface.prototype.removeAllMarkersFromMap=function(){throw new NotImplementedError},ta.api.maps.ProviderInterface.prototype.removeMarkerFromMap=function(e){throw new NotImplementedError},ta.api.maps.ProviderInterface.prototype.toggleMarkerVisibility=function(e,r){throw new NotImplementedError},ta.api.maps.ProviderInterface.prototype.setZIndex=function(e,r){throw new NotImplementedError},ta.api.maps.ProviderInterface.prototype.getMarkerIds=function(){throw new NotImplementedError},ta.api.maps.ProviderInterface.prototype.reverseGeocode=function(e,r,t){throw new NotImplementedError},ta.api.maps.ProviderInterface.prototype.getAddressAutocomplete=function(e,r,t){throw new NotImplementedError},ta.api.maps.ProviderInterface.prototype.getLatLng=function(e,r){throw new NotImplementedError},ta.api.maps.ProviderInterface.prototype.setClickDelegate=function(e){throw new NotImplementedError},ta.api.maps.ProviderInterface.prototype.getLocationWithEvent=function(e){throw new NotImplementedError},ta.api.maps.ProviderInterface.prototype.setIcon=function(e,r,t){throw new NotImplementedError},ta.api.maps.ProviderInterface.prototype.informOfResize=function(){throw new NotImplementedError},ta.api.maps.ProviderInterface.prototype.closeStreetView=function(){throw new NotImplementedError},ta.api.maps.ProviderInterface.prototype.getTravelTimes=function(e,r,t,o,n){throw new NotImplementedError},ta.api.maps.ProviderInterface.prototype.renderRoute=function(e,r,t,o,n,p,a){throw new NotImplementedError},ta.api.maps.ProviderInterface.prototype.zoomToFitLocation=function(e,r,t){throw new NotImplementedError},ta.api.maps.ProviderInterface.prototype.zoomAndPanToFitLocations=function(e,r,t){throw new NotImplementedError},ta.api.maps.ProviderInterface.prototype.zoomAndPanToFitAllMarkers=function(e){throw new NotImplementedError},ta.api.maps.ProviderInterface.prototype.triggerHover=function(e){throw new NotImplementedError},ta.api.maps.ProviderInterface.prototype.triggerBlur=function(e){throw new NotImplementedError},ta.api.maps.ProviderInterface.prototype.isMarkerInView=function(e){throw new NotImplementedError},ta.api.maps.ProviderInterface.prototype.reinitMapOptions=function(e){throw new NotImplementedError},ta.api.maps.ProviderInterface.prototype.getPolygonCenter=function(e){throw new NotImplementedError},ta.api.maps.ProviderInterface.prototype.dbgTriggerClickMarker=function(e){throw new NotImplementedError},ta.api.maps.ProviderInterface.prototype.dbgTriggerZoomChange=function(e){throw new NotImplementedError},ta.api.maps.ProviderInterface.prototype.dbgTriggerPan=function(e){throw new NotImplementedError},ta.api.maps.provider=ta.api.maps.providerInterface;
function GBrowserIsCompatible(){return!0}ta.maps.load={vanillaLoaded:!1,vanillaLoading:!1,vanillaCallbacks:[],libraryVanilla:function(a){if(ta.maps.load.vanillaLoaded&&a.call(null),ta.maps.load.vanillaCallbacks.push(a),!ta.maps.load.vanillaLoading){ta.maps.load.vanillaLoading=!0;var n=document.getElementsByTagName("head")[0],l=document.createElement("script");l.type="text/javascript",window.gmapDomain||(gmapDomain=ta.has("isDaoDao")?"ditu.google.cn":"maps.google.com"),"undefined"!=typeof gLang&&gLang||(gLang=""),"undefined"!=typeof mapChannel&&mapChannel?channelParam="&channel="+mapChannel:channelParam="&channel=ta";var e="3.11";ta.has("gmaps.APIVersion")&&(e=ta.retrieve("gmaps.APIVersion")),l.src="//"+gmapDomain+"/maps/api/js?v="+e+"&client="+gClient+"&sensor=false&c&async=2&callback=ta.maps.load.vanillaLibraryCallback"+gLang+channelParam,n.appendChild(l)}},library:function(a){var n=a,l=ta.retrieve("maps.callback");(n||l)&&(a=n&&l?function(){"function"==typeof n?n():ta.util.pending.waitForFn("gmaps.callback",n),"function"==typeof l?l():ta.util.pending.waitForFn("gmaps.callback",l)}:n?n:l);var e;if(ta.retrieve("maps.loaded")&&a)return"function"!=typeof a?ta.util.pending.waitForFn("gmaps.callback",a):a(),!0;if(ta.has("gmaps.callbacks")&&a){var t=ta.retrieve("gmaps.callbacks");return t?(t.push(a),ta.store("gmaps.callbacks",t)):ta.store("gmaps.callbacks",[a]),!1}a&&ta.store("gmaps.callbacks",[a]),window.gmapDomain||(gmapDomain=ta.has("isDaoDao")?"ditu.google.cn":"maps.google.com"),"undefined"!=typeof gLang&&gLang||(gLang=""),e="undefined"!=typeof mapChannel&&mapChannel?"&channel="+mapChannel:"&channel=ta";var i="3.11";return ta.has("gmaps.APIVersion")&&(i=ta.retrieve("gmaps.APIVersion")),new Asset.javascript("//"+gmapDomain+"/maps/api/js?v="+i+"&client="+gClient+"&sensor=false&c&async=2&callback=ta.maps.load.libraryCallback"+gLang+e),!1},libraryCallback:function(){ta.store("maps.loaded",!0),ta.trackEventOnPage("map_provider","load","ta-maps-gmaps3");var a=ta.retrieve("gmaps.callbacks");if(a)for(var n=0;n<a.length;n++)ta.util.pending.waitForFn("gmaps.callback"+n,a[n]);ta.remove("gmaps.callbacks")},vanillaLibraryCallback:function(){ta.maps.load.vanillaLoaded=!0;for(var a=ta.maps.load.vanillaCallbacks,n=0;n<a.length;n++)a[n].call(null)}};
function _addHoverWindowMouseHandlers(){var o=this;o.mouseInfoWindowHandlersLoaded?o.infoWindowDOMReadyHandler():google.maps.event.addListener(this.hoverInfoWindow,"domready",function(){o.hoverInfoWindow.div_.addEvent?(o.hoverInfoWindow.div_.addEvent("mouseenter",function(){o.infoWindowHoverStartHandler()}),o.hoverInfoWindow.div_.addEvent("mouseleave",function(){o.infoWindowHoverEndHandler()})):o.hoverInfoWindow.div_.attachEvent&&(o.hoverInfoWindow.div_.attachEvent("onmouseover",function(){o.infoWindowHoverStartHandler()}),o.hoverInfoWindow.div_.attachEvent("onmouseout",function(){o.infoWindowHoverEndHandler()})),o.mouseInfoWindowHandlersLoaded=!0,o.infoWindowDOMReadyHandler()})}ta.api.maps.providerFactory.createProviderImplementationInstance=function(){return new ta.api.maps.Google},ta.api.maps.Google=function(){var o=this;this.map=null,this.name="Google",this.mapZoom=1,this.infoWindow=null,this.hoverInfoWindow=null,this.isRetina=!1,this.selectedMarker=null,this.INFO_OFFSET_X=-110,this.defaultZIndex=1e3,this.defaultInfoWindowZIndex=1e3,this.locationMarkers={},this.polygons={},this.options=null,this.clickDelegate=null,this.mouseInfoWindowHandlersLoaded=!1;var e=ta.has("isDaoDao")?"ditu.google.cn":"maps.google.com";this.baseReverseGeoCodeUrl="http://"+e+"/maps/api/geocode/json?latlng=",this.directionsService=new google.maps.DirectionsService,this.registeredListeners={},this.pinClickedHandler=function(e){if(o.options.onPinClick){if(require.defined("maps/performanceMetrics")){var t=require("maps/performanceMetrics");t.detailCardTriggered(e.ta.id)}o.options.onPinClick(e.ta.id)}},this.pinHoverStartHandler=function(e){if(o.options.onPinHoverStart){if(require.defined("maps/performanceMetrics")){var t=require("maps/performanceMetrics");t.infoCardTriggered(e.ta.id)}o.options.onPinHoverStart(e.ta.id)}},this.pinHoverEndHandler=function(e){o.options.onPinHoverEnd&&o.options.onPinHoverEnd(e.ta.id)},this.polygonHoverStartHandler=function(e){o.options.onPolygonHoverStart&&o.options.onPolygonHoverStart(e)},this.polygonHoverEndHandler=function(e){o.options.onPolygonHoverEnd&&o.options.onPolygonHoverEnd(e)},this.polygonClickHandler=function(e){o.options.onPolygonClicked&&o.options.onPolygonClicked(e)},this.pinAnimationChangedHandler=function(e){o.options.onPinAnimationChanged&&o.options.onPinAnimationChanged(e.ta.id)},this.infoWindowHoverStartHandler=function(){o.options.onHoverInfoWindowHoverStart&&o.options.onHoverInfoWindowHoverStart(o.hoverInfoWindow.taId)},this.infoWindowCloseHandler=function(){this.options.onInfoWindowClosed&&this.infoWindow&&(this.options.onInfoWindowClosed(this.infoWindow.taId),this.infoWindow&&(this.infoWindow.taId=-1))},this.infoWindowRenderedHandler=function(){o.options.onInfoWindowRendered&&o.options.onInfoWindowRendered(o.infoWindow.taId)},this.hoverWindowRenderedHandler=function(){o.options.onHoverInfoWindowRendered&&o.options.onHoverInfoWindowRendered(o.hoverInfoWindow.taId)},this.infoWindowHoverEndHandler=function(){o.options.onHoverInfoWindowHoverEnd&&o.options.onHoverInfoWindowHoverEnd(o.hoverInfoWindow.taId)},this.infoWindowDOMReadyHandler=function(){o.options.onHoverInfoWindowDOMReady&&o.options.onHoverInfoWindowDOMReady()},this.makeProjectionOverlay=function(){o.pOverlay&&o.pOverlay.setMap(null),o.pOverlay=new google.maps.OverlayView,o.pOverlay.draw=function(){},o.pOverlay.setMap(o.map)},this.getTravelTime=function(e,t,n,a,i,s){o.directionsService.route({origin:e,destination:t,travelMode:n,unitSystem:"mi"===a?google.maps.UnitSystem.IMPERIAL:google.maps.UnitSystem.METRIC},function(o,e){if(e==google.maps.DirectionsStatus.OK){var t=o.routes[0].legs[0],a=t.duration.value;if(n==google.maps.TravelMode.WALKING&&a>3600)return void s("TOO_FAR");i({mode:n,distance:t.distance.text,duration:t.duration.text})}else s(e,n)})},this.renderRoute=function(e,t,n,a,i,s){var r=new google.maps.LatLng(e[0],e[1]),p=new google.maps.LatLng(t[0],t[1]),l=new google.maps.DirectionsRenderer({map:this.map,suppressMarkers:!0,polylineOptions:{strokeColor:"#00a680"}});n=n.map(function(o){return{location:new google.maps.LatLng(o[0],o[1]),stopover:!1}}),o.directionsService.route({origin:r,destination:p,waypoints:n||null,optimizeWaypoints:!!n,travelMode:a||google.maps.TravelMode.DRIVING},function(o,e){e==google.maps.DirectionsStatus.OK?(l.setDirections(o),i({startPinLatLng:[o.routes[0].legs[0].start_location.lat(),o.routes[0].legs[0].start_location.lng()],endPinLatLng:[o.routes[0].legs[o.routes[0].legs.length-1].end_location.lat(),o.routes[0].legs[o.routes[0].legs.length-1].end_location.lng()]})):s(e)})},this.removeListener=function(o){var e=this.registeredListeners[o];e&&(google.maps.event.removeListener(e),delete this.registeredListeners[o])},this.addListener=function(o,e){this.options[e]&&!this.registeredListeners[e]&&(this.registeredListeners[e]=google.maps.event.addListener(this.map,o,this.options[e]))}},ta.api.maps.Google.prototype.onload=function(){this.options&&"function"==typeof this.options.onload&&this.options.onload()},ta.api.maps.Google.prototype.setupMap=function(o){"use strict";this.options=o;var e=this.options.initialLocation,t={backgroundColor:"transparent",zoom:this.options.initialZoom||13,minZoom:this.options.minZoom||3,maxZoom:this.options.maxZoom||19,mapTypeId:google.maps.MapTypeId.ROADMAP,mapTypeControl:!this.options.disableDefaultMapControl,mapTypeControlOptions:{style:google.maps.MapTypeControlStyle.HORIZONTAL_BAR,position:this.options.searchBar?google.maps.ControlPosition.BOTTOM_LEFT:google.maps.ControlPosition.TOP_LEFT},navigationControl:!1,scaleControl:!0,disableDefaultUI:!0,zoomControl:!this.options.disableDefaultMapControl||this.options.enableMapZoomControl,zoomControlOptions:{style:google.maps.ZoomControlStyle.DEFAULT,position:this.options.searchBar?google.maps.ControlPosition.LEFT_BOTTOM:google.maps.ControlPosition.LEFT_TOP},scrollwheel:this.options.enableScrollwheel,streetViewControl:!this.options.searchBar&&!this.options.disableDefaultMapControl,center:new google.maps.LatLng(e.lat(),e.lng()),draggable:this.options.draggable};if(this.options.disableMapStyling||(t.styles=[{"featureType":"road.highway","elementType":"geometry.fill","stylers":[{"color":"#ffffff"}]},{"featureType":"road.highway","elementType":"geometry.stroke","stylers":[{"color":"#ccc1c1"}]},{"featureType":"water","elementType":"geometry","stylers":[{"saturation":-50}]},{"featureType":"transit.line","elementType":"geometry","stylers":[{"saturation":-100}]},{"featureType":"road.highway","elementType":"labels.text.fill"},{"featureType":"transit.line","elementType":"labels.text.stroke","stylers":[{"visibility":"off"}]}]),this.isRetina=!!this.options.isRetina,this.options.mapMode){var n=ta.api.maps.provider.getMapMode(this.options.mapMode);n&&(t.mapTypeId=n)}if(!this.options.container)throw new Error("Can't create map without a container.");this.map=new google.maps.Map(this.options.container,t),this.mapZoom=t.zoom;var a=this;if(require.defined("maps/performanceMetrics")){var i=!0,s="load",r=require("maps/performanceMetrics"),p=function(){r.baseLayerComplete(),r.pinsStart(s),i&&(google.maps.event.addListener(this,"drag",function(o){s=r.DRAW_TRIGGERS.PAN,r.baseLayerStart(s)}),google.maps.event.addListener(this,"zoom_changed",function(o){s=r.DRAW_TRIGGERS.ZOOM,r.baseLayerStart(s)})),i=!1},l=function(){i||r.baseLayerCancel()};google.maps.event.addListener(this.map,"tilesloaded",p),google.maps.event.addListener(this.map,"idle",l)}this.options.onTilesLoaded&&google.maps.event.addListener(this.map,"tilesloaded",a.options.onTilesLoaded),google.maps.event.addListener(this.map,"idle",a.mapDoneMovingCallback),google.maps.event.addListener(this.map,"click",function(o){a.clickDelegate&&a.clickDelegate(o),a.options.onMapClick&&a.options.onMapClick()}),this.options.onCenterChanged&&(this.registeredListeners.onCenterChanged=google.maps.event.addListener(this.map,"idle",a.options.onCenterChanged)),this.options.onPanStart&&(this.registeredListeners.onPanStart=google.maps.event.addListener(this.map,"dragstart",a.options.onPanStart)),this.options.onZoomChanged&&(this.registeredListeners.onZoomChanged=google.maps.event.addListener(this.map,"zoom_changed",a.options.onZoomChanged)),this.options.pinnedMapCenter&&google.maps.event.addDomListener(window,"resize",function(){var o=a.map.getCenter();google.maps.event.trigger(a.map,"resize"),a.map.setCenter(o)});var d={disableAutoPan:!0,maxWidth:0,pixelOffset:new google.maps.Size(-110,0),closeBoxURL:"",infoBoxClearance:new google.maps.Size(1,1),isHidden:!1,pane:"floatPane",enableEventPropagation:!1,zIndex:this.defaultInfoWindowZIndex,alignBottom:this.options.alignBottom},g={disableAutoPan:!1,maxWidth:0,pixelOffset:new google.maps.Size(-110,0),closeBoxURL:"",infoBoxClearance:new google.maps.Size(20,20),isHidden:!1,pane:"floatPane",enableEventPropagation:!1,zIndex:this.defaultInfoWindowZIndex-10};this.makeProjectionOverlay(),window.InfoBox&&(this.infoWindow=new InfoBox(g),this.hoverInfoWindow=new InfoBox(d),google.maps.event.addListener(this.infoWindow,"closeclick",this.infoWindowCloseHandler.bind(this)),google.maps.event.addListener(this.infoWindow,"domready",this.infoWindowRenderedHandler.bind(this)),google.maps.event.addListener(this.hoverInfoWindow,"domready",this.hoverWindowRenderedHandler.bind(this)));var m={addressControlOptions:{position:google.maps.ControlPosition.TOP_LEFT},linksControl:!1,zoomControlOptions:{position:google.maps.ControlPosition.TOP_LEFT},visible:!1},c=new google.maps.StreetViewPanorama(this.options.container,m);this.map.setStreetView(c),google.maps.event.addListener(c,"visible_changed",function(){a.options.onStreetViewStatusChange&&a.options.onStreetViewStatusChange(c.getVisible())}),google.maps.event.addListenerOnce(this.map,"bounds_changed",function(){a.onload()}),google.maps.event.addListenerOnce(this.map,"idle",function(){a.map.panBy(0,-1)})},ta.api.maps.Google.prototype.reinitMapOptions=function(o){this.map.setOptions(o)},ta.api.maps.Google.prototype.renderInfoWindow=function(o,e,t){var n=this.locationMarkers[o];if(n){var a=this;a.infoWindow.close(),a.infoWindow.setContent(e),a.infoWindow.setOptions(t),a.infoWindow.open(this.map,n),a.infoWindow.taId=o,a.registeredCancelHandler||(a.registeredCancelHandler=google.maps.event.addListener(this.infoWindow,"domready",function(){var o=function(o){o.cancelBubble=!0,o.stopPropagation&&o.stopPropagation()};a.infoWindow.contextListener_&&(google.maps.event.removeListener(a.infoWindow.contextListener_),a.infoWindow.contextListener_=google.maps.event.addDomListener(a.infoWindow.div_,"contextmenu",o))}))}},ta.api.maps.Google.prototype.closeInfoWindow=function(){this.infoWindow&&(this.infoWindow.taId=-1,this.infoWindow.close())},ta.api.maps.Google.prototype.renderHoverInfoWindow=function(o,e,t){var n=this.locationMarkers[o];if(n){var a=this;if(a.hoverInfoWindow.taId=o,a.hoverInfoWindow.setContent(e),a.hoverInfoWindow.setOptions(t),a.options.reuseHoverDivs&&a.hoverInfoWindow.div_?(a.hoverInfoWindow.setPosition(n.getPosition()),a.hoverInfoWindow.show()):a.hoverInfoWindow.open(this.map,n),a.hoverInfoWindowOpen=!0,_addHoverWindowMouseHandlers.call(this),require.defined("maps/performanceMetrics")){var i=require("maps/performanceMetrics");i.infoCardShown(o)}}},ta.api.maps.Google.prototype.renderHoverInfoWindowAtPosition=function(o,e,t,n){var a=this,i=new google.maps.LatLng(e.lat(),e.lng());a.hoverInfoWindow.taId=o,a.hoverInfoWindow.setContent(t),a.hoverInfoWindow.setOptions(n),a.hoverInfoWindow.setPosition(i),a.hoverInfoWindow.setMap(a.map),a.hoverInfoWindow.show(),a.hoverInfoWindowOpen=!0,_addHoverWindowMouseHandlers.call(this)},ta.api.maps.Google.prototype.closeHoverInfoWindow=function(){this.hoverInfoWindowOpen&&(this.hoverInfoWindowOpen=!1,this.options.reuseHoverDivs?this.hoverInfoWindow.hide():this.hoverInfoWindow.close())},ta.api.maps.Google.prototype.isHoverInfoWindowOpen=function(){return this.hoverInfoWindowOpen},ta.api.maps.Google.prototype.getHoverInfoWindowMarkerId=function(){return this.hoverInfoWindowOpen?this.hoverInfoWindow.taId:null},ta.api.maps.Google.prototype.getInfoWindowMarkerId=function(){return this.infoWindow&&this.infoWindow.taId!=-1?this.infoWindow.taId:null},ta.api.maps.Google.prototype.mapDoneMovingCallback=function(){},ta.api.maps.Google.prototype.panToLocation=function(o,e,t){var n=this.map.getCenter(),a=new google.maps.LatLng(o.lat(),o.lng());if(n.equals(a))"function"==typeof t&&t();else{this.removeListener("onCenterChanged"),this.removeListener("onPanStart"),this.map.panTo(a);var i=this;e&&i.map.panBy(e.x,e.y),google.maps.event.addListenerOnce(this.map,"idle",function(){i.addListener("idle","onCenterChanged"),i.addListener("dragstart","onPanStart"),"function"==typeof t&&t()})}},ta.api.maps.Google.prototype.onceOnFinishedDrawing=function(o){var e=this.map.getCenter(),t=new google.maps.LatLng(e.lat(),e.lng()+1e-9);this.removeListener("onZoomChanged"),this.removeListener("onCenterChanged"),this.removeListener("onPanStart");var n=this;google.maps.event.addListenerOnce(this.map,"idle",function(){n.addListener("idle","onCenterChanged"),n.addListener("dragstart","onPanStart"),n.addListener("zoom_changed","onZoomChanged"),"function"==typeof o&&o()}),this.map.panTo(t)},ta.api.maps.Google.prototype.setCenter=function(o){var e=new google.maps.LatLng(o.lat(),o.lng());this.map.setCenter(e)},ta.api.maps.Google.prototype.panToMarker=function(o){var e=this.locationMarkers[o];if(e){var t=e.getPosition();this.panToLocation(t)}},ta.api.maps.Google.prototype.setZoom=function(o){if(this.map&&o!=this.map.getZoom()){this.removeListener("onZoomChanged");var e=this;google.maps.event.addListenerOnce(this.map,"idle",function(){e.addListener("zoom_changed","onZoomChanged")}),this.map.setZoom(o)}},ta.api.maps.Google.prototype.zoomIn=function(){this.map&&this.map.setZoom(this.map.getZoom()+1)},ta.api.maps.Google.prototype.zoomOut=function(){this.map&&this.map.setZoom(this.map.getZoom()-1)},ta.api.maps.Google.prototype.getZoom=function(){return this.map.getZoom()},ta.api.maps.Google.prototype.getCenter=function(){var o=this.map.getCenter();return new ta.maps.util.GeoPoint(o.lat(),o.lng())},ta.api.maps.Google.prototype.addMarkerEvent=function(o,e,t){var n=this.locationMarkers[o];n&&google.maps.event.addListener(n,e,t)},ta.api.maps.Google.prototype.makeMarkerDraggable=function(o,e){var t=this.locationMarkers[o];t&&t.setDraggable(e)},ta.api.maps.Google.prototype.makeMarkerClickable=function(o,e){var t=this.locationMarkers[o];t&&t.setClickable(e)},ta.api.maps.Google.prototype.setMarkerPosition=function(o,e){var t=this.locationMarkers[o];t&&t.setPosition(new google.maps.LatLng(e.lat(),e.lng()))},ta.api.maps.Google.prototype.getMarkerPosition=function(o){var e=this.locationMarkers[o],t=function(){return 0},n={lat:t,lng:t};return e&&(n=e.getPosition()),new ta.maps.util.GeoPoint(n.lat(),n.lng())},ta.api.maps.Google.prototype.getMarkerPixelPosition=function(o){if(!this.pOverlay.getProjection())return{x:0,y:0};var e=this.locationMarkers[o];if(e){var t=this.pOverlay.getProjection().fromLatLngToContainerPixel(e.getPosition());return{x:t.x,y:t.y}}return{x:0,y:0}},ta.api.maps.Google.prototype.hasMarker=function(o){return!!this.locationMarkers[o]},ta.api.maps.Google.prototype.getMapCenter=function(){return this.map.getCenter()},ta.api.maps.Google.prototype.getMapMode=function(o){var e=null;return"map"==o?e=google.maps.MapTypeId.ROADMAP:"sat"==o?e=google.maps.MapTypeId.SATELLITE:"hyb"==o&&(e=google.maps.MapTypeId.HYBRID),e},ta.api.maps.Google.prototype.setMapMode=function(o){var e=ta.api.maps.Google.prototype.getMapMode(o);e&&this.map&&this.map.setMapTypeId(e)},ta.api.maps.Google.prototype.getBounds=function(){var o=this.map.getBounds();if(!o)return null;var e=o.getSouthWest(),t=o.getNorthEast();return new ta.maps.util.GeoRect(new ta.maps.util.GeoPoint(e.lat(),e.lng()),new ta.maps.util.GeoPoint(t.lat(),t.lng()))},ta.api.maps.Google.prototype.getBestDistanceForZoom=function(o){for(var e=ta.api.maps.provider.getRadiusForZoom(o),t=1/0,n=-1,a=0;a<ta.api.maps.constants.DISTANCE_INTERVALS.length;++a){var i=ta.api.maps.constants.DISTANCE_INTERVALS[a]-e;i>=0&&i<t&&(t=i,n=a)}return n},ta.api.maps.Google.prototype.getRadiusForZoom=function(o){var e=this.map.getCenter(),t=e.lat()*ta.api.maps.constants.RAD_PER_DEGREE,n=180*Math.abs(Math.cos(t))/Math.pow(2,this.map.getZoom()),a=n*o/2;return a},ta.api.maps.Google.prototype.fitBounds=function(o,e){if(this.map&&o){var t=null;if(e){var n=o.getSW(),a=o.getNE(),i=n.lat(),s=n.lng(),r=a.lat(),p=a.lng(),l=(s-p)/2,d=(i-r)/2,g=(s+p)/2,m=(i+r)/2;s=g+l/1.5,p=g-l/1.5,i=m+d/1.5,r=m-d/1.5,t=new google.maps.LatLngBounds(new google.maps.LatLng(i,s),new google.maps.LatLng(r,p))}else{var n=o.getSW(),a=o.getNE();t=new google.maps.LatLngBounds(new google.maps.LatLng(n.lat(),n.lng()),new google.maps.LatLng(a.lat(),a.lng()))}this.map.fitBounds(t)}},ta.api.maps.Google.prototype.fitToSelf=function(){ta.api.maps.provider.fitBounds(ta.api.maps.provider.getBounds(),!0)},ta.api.maps.Google.prototype.constructMarkerDef=function(o,e,t,n,a,i){var s;n&&n.complexIcon?s=n.complexIcon:(s={url:t},this.options.useTabletPins&&(s.scaledSize=new google.maps.Size(n.width,n.height)));var r={map:this.map,position:new google.maps.LatLng(o.lat(),o.lng()),icon:s,optimized:!1};return n&&(r.ta=n),n&&n.label?r.label=n.label:r.label=null,i&&(r.animation=google.maps.Animation.DROP),r.zIndex=a||this.defaultZIndex,r},ta.api.maps.Google.prototype.addPolygon=function(o,e,t){var n=[];e.each(function(o){n.push(new google.maps.LatLng(o.lat(),o.lng()))});var a=Object.clone(t);a.paths=n;var i=new google.maps.Polygon(a);i.setMap(this.map),this.polygons[o]=i;for(var s=new google.maps.LatLngBounds,r=0;r<n.length;r++)s.extend(n[r]);google.maps.event.addListener(i,"mouseover",this.polygonHoverStartHandler.bind(this,o)),google.maps.event.addListener(i,"mouseout",this.polygonHoverEndHandler.bind(this,o)),google.maps.event.addListener(i,"click",this.polygonClickHandler.bind(this,o));var p=s.getCenter();return new ta.maps.util.GeoPoint(p.lat(),p.lng())},ta.api.maps.Google.prototype.updatePolygonOptions=function(o,e){var t=this.polygons[o];t&&t.setOptions(e)},ta.api.maps.Google.prototype.addMarkerFromMarkerDef=function(o){var e;if(this.locationMarkers.hasOwnProperty(o.ta.id)){if(e=this.locationMarkers[o.ta.id]){var t=!1,n=e.getIcon();n.scaledSize&&!o.icon.scaledSize||!n.scaledSize&&o.icon.scaledSize?t=!0:n.url&&o.icon.url?t=n.url!=o.icon.url:n!=o.icon&&(t=!0),t&&e.setOptions(o),e.setVisible(!0)}}else{e=new google.maps.Marker(o);var a=this;null!=e&&(google.maps.event.addListener(e,"click",function(){a.pinClickedHandler(e)}),google.maps.event.addListener(e,"mouseover",function(){a.pinHoverStartHandler(e)}),google.maps.event.addListener(e,"mouseout",function(){a.pinHoverEndHandler(e)}),google.maps.event.addListenerOnce(e,"animation_changed",function(){a.pinAnimationChangedHandler(e)}),a.options.longTouch&&google.maps.event.addListener(e,"mousedown",function(o){var t=!1,n=event.clientX,i=event.clientY,s=window.setTimeout(function(){ta.trackEventOnPage("dynamic_large_map","long_press","marker"),a.pinHoverStartHandler(e),t=!0},500),r=function(o){var r=event.clientX,p=event.clientY,l=r-n,d=p-i,g=Math.sqrt(l*l+d*d);g>25&&window.clearTimeout(s),t&&a.pinHoverEndHandler(e)};google.maps.event.addListener(e,"mouseup",r)})),this.locationMarkers[o.ta.id]=e,e.ta=o.ta}return e},ta.api.maps.Google.prototype.removeAllMarkersFromMap=function(){for(var o in this.locationMarkers)this.removeMarkerFromMap(o)},ta.api.maps.Google.prototype.removeUnusedMarkersFromMap=function(o){var e=[],t=this.locationMarkers;this.locationMarkers={};for(var n in o){var a=o[n];if(a&&a.id){var i=a.id;t.hasOwnProperty(i)?(this.locationMarkers[i]=t[i],delete t[i]):e.push(a)}}for(var s in t)this.removeMarkerFromMap(s);return e},ta.api.maps.Google.prototype.getMarkerIds=function(){var o=[];for(var e in this.locationMarkers){var t=this.locationMarkers[e];t.getMap()==this.map&&o.push(t.ta.id)}return o},ta.api.maps.Google.prototype.removeMarkerFromMap=function(o){var e=this.locationMarkers[o];e&&(o==this.getHoverInfoWindowMarkerId()&&this.closeHoverInfoWindow(),o==this.getInfoWindowMarkerId()&&this.closeInfoWindow(),e.setMap(null),delete this.locationMarkers[o])},ta.api.maps.Google.prototype.reverseGeocode=function(o,e,t){var n=this.baseReverseGeoCodeUrl+o.lat()+","+o.lng()+"&sensor=false&channel=mobile_add_poi",a={url:n},i=function(o){var e={},t=o.length,n=0,a=null,i=null;for(n=0;n<t;n++)a=o[n],i=a.types[0],e[i]=a.long_name;return e},s=function(o,n,s){var r,p,l;return 200!=s.status?void t(o,a):(r=ta.m.parseJSON(o),"OK"!=r.status?void t(o,a):void(r.results.length>0&&(p=r.results[0],l=i(p.address_components),l.name=p.formatted_address,l.street_number&&l.route&&(l.street=l.street_number+" "+l.route),l.administrative_area_level_2&&(l.city=l.administrative_area_level_2),l.administrative_area_level_1&&(l.state=l.administrative_area_level_1),a.responseJSON=r,e(l,a))))};ta.m.makeXHRGetResponse(n,"GET",s,a)},ta.api.maps.Google.prototype.getAddressAutocomplete=function(o,e,t){var n=ta.util.Deferred(),a=new google.maps.places.AutocompleteService,i={input:o,types:["geocode"],location:new google.maps.LatLng(e.lat(),e.lng()),radius:t};return a.getPlacePredictions(i,function(o,e){if(e!=google.maps.places.PlacesServiceStatus.OK)n.reject();else{var t=[];o.each(function(o){if(o.types.indexOf("street_address")!==-1||o.types.indexOf("route")!==-1){var e={name:o.description,scope:"local",type:"GEO",provider:"googleAutocomplete"};t.push(e)}}),n.resolve(t)}}),n.promise()},ta.api.maps.Google.prototype.getLatLng=function(o,e){(new google.maps.Geocoder).geocode({address:o},function(t){var n=[];t&&t.length>0&&t.forEach(function(e){var t=new ta.maps.util.GeoPoint(e.geometry.location.lat(),e.geometry.location.lng());e.formatted_address?t.name=e.formatted_address:t.name=o,t.type="ADDRESS",n.push(t)}),e(n)})},ta.api.maps.Google.prototype.getTravelTimes=function(o,e,t,n,a){function i(o){g[m[o.mode]]=o.duration,o.mode==google.maps.TravelMode.DRIVING&&(g.distance=o.distance),r()}function s(o,e){"ZERO_RESULTS"==o||"TOO_FAR"==o?r():"OVER_QUERY_LIMIT"==o?(ta.trackEventOnPage("dynamic_large_map","RouteOverQueryLimit",e),r()):n(o,e)}function r(){--c||t(g)}var p=new google.maps.LatLng(o.lat(),o.lng()),l=new google.maps.LatLng(e.lat(),e.lng()),d=this.getTravelTime,g={},m=new Hash({});m.set(google.maps.TravelMode.DRIVING,"driving"),m.set(google.maps.TravelMode.WALKING,"walking"),m.set(google.maps.TravelMode.TRANSIT,"transit");var c=m.getLength();m.each(function(o,e,t){d(p,l,e,a,i,s)})},ta.api.maps.Google.prototype.shouldUpdateUserLocation=function(o,e){var t=e.timestamp-o.timestamp,n=e.coords.accuracy-o.coords.accuracy;return n<0||t>ta.api.maps.constants.THIRTY_SECONDS&&n<ta.api.maps.constants.FIFTY_METERS||t>ta.api.maps.constants.TWO_MINUTES},ta.api.maps.Google.prototype.userLocationSuccess=function(o){ta.api.maps.provider.curLoc&&!ta.api.maps.provider.shouldUpdateUserLocation(ta.api.maps.provider.curLoc,o)||(ta.api.maps.provider.curLoc=o)},ta.api.maps.Google.prototype.userLocationError=function(){},ta.api.maps.Google.prototype.userLocationHandler=function(){navigator.geolocation?navigator.geolocation.getCurrentPosition(function(o){ta.api.maps.provider.userLocationSuccess(o)},function(){ta.api.maps.provider.userLocationError()}):ta.api.maps.provider.userLocationError()},ta.api.maps.Google.prototype.setClickDelegate=function(o){ta.api.maps.provider.clickDelegate=o},ta.api.maps.Google.prototype.getLocationWithEvent=function(o){return new ta.maps.util.GeoPoint(o.latLng.lat(),o.latLng.lng())},ta.api.maps.Google.prototype.shouldAdjustForInfoWindow=function(){return this.map.getZoom()<17},ta.api.maps.Google.prototype.toggleMarkerVisibility=function(o,e){var t=this.locationMarkers[o];t&&t.setVisible(e)},ta.api.maps.Google.prototype.setZIndex=function(o,e){var t=this.locationMarkers[o];t&&t.setZIndex(e)},ta.api.maps.Google.prototype.setIcon=function(o,e,t){var n=this.locationMarkers[o];n&&(t&&!n.backupIcon&&(n.backupIcon=n.getIcon()),n.setIcon(e),delete n.backupHackIcon)},ta.api.maps.Google.prototype.resetIconFromBackup=function(o){var e=this.locationMarkers[o];e&&e.backupIcon&&(e.setIcon(e.backupIcon),e.backupHackIcon=e.backupIcon,setTimeout(function(){e.backupHackIcon&&e.setIcon(e.backupHackIcon)},500),e.backupIcon=null)},ta.api.maps.Google.prototype.informOfResize=function(){this.map&&google.maps.event.trigger(this.map,"resize")},ta.api.maps.Google.prototype.closeStreetView=function(){var o=this.map&&this.map.getStreetView();o&&o.setVisible(!1)},ta.api.maps.Google.prototype.zoomToFitLocation=function(o,e,t){var n=[new google.maps.LatLng(o.lat(),o.lng()),new google.maps.LatLng(e.lat(),e.lng()),new google.maps.LatLng(o.lat()-(e.lat()-o.lat()),o.lng()-(e.lng()-o.lng()))];fitBoundsForList.call(this,n,t)},ta.api.maps.Google.prototype.zoomAndPanToFitLocations=function(o,e,t){var n=[];o.forEach(function(o){n.push(new google.maps.LatLng(o.lat(),o.lng()))}),fitBoundsForList.call(this,n,e,t)},ta.api.maps.Google.prototype.zoomAndPanToFitAllMarkers=function(o){var e=[];for(var t in this.locationMarkers){var n=this.locationMarkers[t];n&&e.push(n.getPosition())}e.length>0?fitBoundsForList.call(this,e,o):"function"==typeof o&&o()},ta.api.maps.Google.prototype.triggerHover=function(o,e){this.locationMarkers[o]&&this.options.onPinHoverStart&&this.options.onPinHoverStart(o,e)},ta.api.maps.Google.prototype.triggerBlur=function(o){this.locationMarkers[o]&&this.options.onPinHoverStart&&this.options.onPinHoverEnd(o)},ta.api.maps.Google.prototype.isMarkerInView=function(o){var e=this.locationMarkers[o];try{return null!=e&&this.map.getBounds().contains(e.getPosition())}catch(e){return ta.util.error.record(e,"provider_google:isMarkerInView",null,{"id":o},"WARN"),!1}};var fitBoundsForList=function(o,e,t){var n=new google.maps.LatLngBounds;o.forEach(function(o){n.extend(o)});var a=this.map,i=this;this.removeListener("onZoomChanged"),this.removeListener("onCenterChanged"),this.removeListener("onPanStart");var s=a.getZoom();a.setCenter(n.getCenter()),a.panToBounds(n);var r=Math.max(t||14,s);google.maps.event.addListenerOnce(a,"zoom_changed",function(){a.getZoom()>r&&a.setZoom(r)}),google.maps.event.addListenerOnce(a,"idle",function(){i.addListener("idle","onCenterChanged"),i.addListener("dragstart","onPanStart"),i.addListener("zoom_changed","onZoomChanged"),"function"==typeof e&&e()}),a.fitBounds(n)};ta.api.maps.Google.prototype.getPolygonCenter=function(o){var e=new google.maps.LatLngBounds;o.forEach(function(o){e.extend(new google.maps.LatLng(o.lat(),o.lng()))});var t=e.getCenter();return new ta.maps.util.GeoPoint(t.lat(),t.lng())},ta.api.maps.Google.prototype.dbgTriggerClickMarker=function(o){google.maps.event.trigger(this.locationMarkers[o],"click",null)},ta.api.maps.Google.prototype.dbgTriggerZoomChange=function(o){this.setZoom(o)},ta.api.maps.Google.prototype.dbgTriggerPan=function(o){this.panToLocation(o),google.maps.event.trigger(this.map,"idle",null)};
!function(){if(!this.Hash){var t=this.Hash=new Type("Hash",function(t){"hash"==typeOf(t)&&(t=Object.clone(t.getClean()));for(var n in t)this[n]=t[n];return this});this.$H=function(n){return new t(n)},t.implement({forEach:function(t,n){Object.forEach(this,t,n)},getClean:function(){var t={};for(var n in this)this.hasOwnProperty(n)&&(t[n]=this[n]);return t},getLength:function(){var t=0;for(var n in this)this.hasOwnProperty(n)&&t++;return t}}),t.alias("each","forEach"),t.implement({has:Object.prototype.hasOwnProperty,keyOf:function(t){return Object.keyOf(this,t)},hasValue:function(t){return Object.contains(this,t)},extend:function(n){return t.each(n||{},function(n,e){t.set(this,e,n)},this),this},combine:function(n){return t.each(n||{},function(n,e){t.include(this,e,n)},this),this},erase:function(t){return this.hasOwnProperty(t)&&delete this[t],this},get:function(t){return this.hasOwnProperty(t)?this[t]:null},set:function(t,n){return this[t]&&!this.hasOwnProperty(t)||(this[t]=n),this},empty:function(){return t.each(this,function(t,n){delete this[n]},this),this},include:function(t,n){return void 0==this[t]&&(this[t]=n),this},map:function(n,e){return new t(Object.map(this,n,e))},filter:function(n,e){return new t(Object.filter(this,n,e))},every:function(t,n){return Object.every(this,t,n)},some:function(t,n){return Object.some(this,t,n)},getKeys:function(){return Object.keys(this)},getValues:function(){return Object.values(this)},toQueryString:function(t){return Object.toQueryString(this,t)}}),t.alias({indexOf:"keyOf",contains:"hasValue"})}}();
var ta="undefined"!=typeof window&&window.ta||{},define,require;ta.rollupAmdShim=ta.rollupAmdShim||function(){function e(e,i){var t,o,d,f;if(!window.overrideRequire){for(t=0;e&&e.length&&t<e.length;++t)w[e[t]]=!0;for(t=0;i&&i.length&&t<i.length;++t)m[i[t]]=!0;var l,u;if(y&&window._dummyDefine&&window._dummyDefine.isDummyDefine&&(l=window._dummyDefine.pendingDefinitions,window._dummyDefine=null,define=null),"undefined"!=typeof require&&require.isDummyRequire){u=require.pendingRequirements;var a=require.pendingConfigs;if(a&&a.length)for(t=0;t<a.length;t++)f=a[t],r.config.apply(null,f);require=null}if("function"==typeof define&&define.isTaRollupShim||(E="function"==typeof define?define:null,define=n),"function"==typeof require&&require.isTaRollupShim||(O="function"==typeof require?require:null,require=r),l&&l.length)for(t=0;t<l.length;t++)o=l[t],n.apply(null,o);if(u&&u.length)for(t=0;t<u.length;t++)d=u[t],r.apply(null,d)}}function n(e,r,t,d){var f,l,a=[];if("function"==typeof r&&void 0===t&&void 0===d&&(t=r,r=[]),"string"==typeof e&&"object"==typeof r&&"function"==typeof t){if(D.hasOwnProperty(e)||v[e]&&v[e].deps)return;if(l=i(r,a))try{f=t.apply(null,l),u(e,f)}catch(e){P("Error in require callback: ",e)}else o(a,{deps:r,cb:t,defname:e},n.depLoader)}else{if(E)return E(e,r,t,d);P("invalid args for AMD define: "+typeof e+", "+typeof r+", "+typeof t)}}function r(e,r,d,f){var l=null;if("string"==typeof e&&"function"!=typeof r){try{l=i([e]),!l&&O&&(l=[O(e,r,d,f)])}catch(e){}if(!l)throw t(e);return l[0]}if("object"==typeof e&&"function"==typeof r){var u=[];if(l=i(e,u))try{r.apply(null,l)}catch(e){P("Error in require callback: ",e)}else o(u,{deps:e,cb:r,eb:"function"==typeof d&&d},n.depLoader)}else{if(O)return O(e,r,d,f);P("invalid args for AMD require: "+typeof e+", "+typeof r+". Expected either a string-literal singular dependency (i.e. synchronous) or an array of dependencies with a callback function (i.e. async).")}}function i(e,n){var r,i,t,o,d=[];for(r=0;r<e.length;++r)if(i=e[r],o=null,i)if(D.hasOwnProperty(i))o=D[i],d.push(o);else if(m[i]){for(t=i.split("/"),"underscore"===t[0]&&(t[0]="_"),o="undefined"!=typeof window&&window;t.length>1&&o;o=o[t.shift()]);t.length>0&&o&&(o=o[t[0]]||o[t[0].toLowerCase()]),o?(D[i]=o,d.push(o)):n.push(i)}else n&&n.push(i);else d.push(null);if(d.length===e.length)return d}function t(e){var n,r,i,t,o="Missing immediately required dependency: "+e;for(n=0;n<10;n++){var d=v[e];if(!d){o+=" (not specified)";break}if(d.error){o+=" ("+d.error+")";break}if(e=null,t=d.deps)for(r=0;r<t.length;r++)if(i=t[r],!D.hasOwnProperty(i)){e=i;break}if(!e)break;o+=" -> "+e}var f=new Error(o);return y&&!window.IS_DEBUG||!g||y&&null===window.require.caller&&/^R|react$/.test(e)||g.error(f),f}function o(e,n,t){var u,a,s,p,c,h,y,g=[],w=[],m=[];n.deps=n.deps||[],n.defname&&(p=v[n.defname],v[n.defname]=n,p&&p!==n&&p.needers&&p.needers.length&&(n.needers=(p.needers||[]).concat(n.needers||[])));for(var c=0;c<e.length;c++)u=e[c],h=u.lastIndexOf("!"),h>=0?(g.push(u.substring(0,h)),w.push(u.substring(h+1))):(g.push(null),w.push(u));if(g=i(g,m),!g)return o(m,n);for(var c=0;c<e.length;c++)if(a=g[c],s=v[e[c]],!s&&!D.hasOwnProperty(e[c])){s={defname:e[c]},v[e[c]]=s;var E=f(s),M=l(s);E.error=M;try{if(a)a.load(w[c],r,E,{});else if(t)t(w[c],r,E,{});else{if(!O||O.taVer)throw new Error("no loader for AMD module '"+s.defname+"'");O([s.defname],E,M)}y=!0}catch(e){n.error=e,M(e)}}n.need=0;for(var c=0;c<e.length;c++)u=e[c],s=v[u],!s||D.hasOwnProperty(u)||s.error||(s.needers=s.needers||[],s.needers.push(n),n.need+=1);!n.need&&y&&(b.push(n),q||(q=setTimeout(d,0)))}function d(){var e,n,r,t;for(q=-1;b.length>0;){var d=b.shift();if(d)try{if(d.error){d.defname&&a(d.defname);continue}if(n=[],t="string"==typeof d.deps?[d.deps]:d.deps,e=i(t||[],n),n.length>0){o(n,d);continue}r=null,d.cb&&(r=d.cb.apply(null,e)),d.deps=[],d.cb=null,d.defname&&u(d.defname,r)}catch(e){P("Error propagating dependency resolutions: ",e)}}q=null}function f(e){return function(n){e.defname&&u(e.defname,n)}}function l(e){return function(n){e.defname&&(e.error="Error loading '"+e.defname+"': "+n,P(e.error),e.need=0,e.deps=[],a(e.defname))}}function u(e,n){if(!D[e]){var r=v[e];if(D[e]=n,delete v[e],w[e]){var i,t=e.split("/"),o=ta;for("ta"===t[0]&&t.shift();t.length>1;)i=t.shift(),o[i]||(o[i]={}),o=o[i];t.length>0&&(i=t.shift(),i in o||i.toLowerCase()in o||(o[i]=n,o[i.toLowerCase()]=n))}if(E&&E(e,[],s(n)),r)for(;r.needers&&r.needers.length>0;){var f=r.needers.shift();f.need-=1,f.need||b.push(f)}b.length&&!q&&(q=setTimeout(d,0))}}function a(e){var n=v[e];if(n){var r=n.eb;for(n.deps=null,n.cb=null,n.eb=null,n.error||(n.error="Error loading '"+n.defname+"'");n.needers&&n.needers.length>0;){var i=n.needers.shift();i.error="Failed to load AMD module '"+e+"' which is depended upon by '"+i.defname+"'",i.need>0&&(i.need=0,b.push(i)),y&&!window.IS_DEBUG||!g||g.error(i.error)}if(null!=r)try{r(n.error)}catch(e){}}b.length&&!q&&(q=setTimeout(d,0))}function s(e){return function(){return e}}function p(e){return e&&(e.indexOf("trjs!")!==-1||e.indexOf("trcss!")!==-1||e.indexOf("trhtml!")!==-1||e.indexOf("trdust!")!==-1)}function c(){return!("undefined"!=typeof ta&&ta.page&&ta.page.loadDeferred)}function h(){var e,n,r,t,o;if(q)return void setTimeout(h,0);if(M=!0,v&&c())for(e in v)if(v.hasOwnProperty(e)){if(n=v[e],t=[],o=[],p(n.defname))continue;if(v.hasOwnProperty("trjs!"+n.defname))continue;if(n.deps&&n.deps.length){for(r=0;r<n.deps.length;r++)p(n.deps[r])||t.push(n.deps[r]);if(i(t,o),0===o.length)continue}P("Page 'load' event fired but we have not resolved the '"+n.defname+"' AMD module"+(n.deps&&n.deps.length?" due to missing dependencies: "+o:""))}}var y="undefined"!=typeof window,g=y&&window.console||"undefined"!=typeof console&&console||void 0,w={},m={},v={},b=[],q=null,D={ta:ta},E=null,O=null,M=!1,P=function(e,n){if("undefined"!=typeof __SERVER__)throw n;g&&g.error.apply&&g.error.apply(g,arguments),g&&!g.error.apply&&g.error&&g.error([].slice.apply(arguments))};n.amd=!0,n.isTaRollupShim=!0,n.depLoader=function(){},n.depLoader.isDefault=!0,r.isTaRollupShim=!0,r.undef=function(e){delete D[e];var n=v[e];n&&n.deps&&(n.deps=[],n.cb=null,n.defname=null,delete v[e])},r.config=function(){O&&O.config&&O.config.apply(O,arguments)},r.defined=function(e){return!!D.hasOwnProperty(e)||!v.hasOwnProperty(e)&&(O&&O.defined&&O.defined(e))},r.parsed=function(e){return!!D.hasOwnProperty(e)||v[e]&&v[e].deps},r.specified=function(e){return!(!D.hasOwnProperty(e)&&!v[e])||O&&O.specified&&O.specified(e)},y&&window.IS_DEBUG&&(window.addEventListener?window.addEventListener("load",h,!1):window.attachEvent&&window.attachEvent("onload",h));var _={install:e,reportMissing:h,define:n,require:r,initializedModules:D,debug:function(){return{globalModuleFlags:w,shimModuleFlags:m,initializedModules:D,pendingModules:v,outer:{require:O,define:E},depLoader:n.depLoader}}};return _.install(),u("ta/rollupAmdShim",_),_}();
require(['ta/rollupAmdShim'], function(rollupAmdShim) {rollupAmdShim.install(["maps/Factory"],["ta"]);});
if(window.requirejs && requirejs.taConfig)requirejs.taConfig({"deferred":{},"name":"build/concat/ta-mapsv2-amd","files":{"js-amd":{"src":{"maps":{"Factory":1}}}},"_":{"baseUrl":"/"}});
define("vanillajs",[],function(){return{}});
define("ns-exporter",["vanillajs"],function(r){function n(r){if("undefined"==typeof window)return null;if("undefined"==typeof r&&(r=window),!r)return require.defined("ta/util/Error")&&require("ta/util/Error").record(null,"Using ns-exporter:exportTo without a namespace"),null;if("string"==typeof r){var n=window;n.ta||(ta={}),r.split(".").forEach(function(r){n[r]||(n[r]={}),n=n[r]}),r=n}return r}return{exportTo:function(r,e,t){if(e=n(e),!e)return!1;for(var i in r)!r.hasOwnProperty(i)||t&&i in e||(e[i]=r[i]);return!0},createNs:function(r,e,t){return!!(e=n(e))&&void(e[t]=r)}}});
define("utils/browserutils",["vanillajs"],function(e){"use strict";var o={},n=window.navigator?window.navigator.userAgent.toLowerCase():"",a=window.navigator?window.navigator.platform.toLowerCase():"",r=n.match(/(opera|ie|firefox|chrome|crios|trident|version)[\s\/:]([\w\d\.]+)?.*?(safari|version[\s\/:]([\w\d\.]+)|$)/)||[null,"unknown",0],i="ie"==r[1]&&document.documentMode;return"trident"===r[1]&&(r[1]="ie",r[2]=parseInt(r[2],10)+4),o.name="version"==r[1]?r[3]:r[1],o.version=i||parseFloat("opera"==r[1]&&r[4]?r[4]:r[2]),o.Platform={name:n.match(/ip(?:ad|od|hone)/)?"ios":(n.match(/(?:webos|android)/)||a.match(/mac|win|linux/)||["other"])[0]},o[o.name]=!0,o[o.name+parseInt(o.version,10)]=!0,o.Platform[o.Platform.name]=!0,o});
define("ta/util/Object",["vanillajs","ns-exporter"],function(t,e){var r={};return r.typeOf=function(t){return Object.prototype.toString.call(t).match(/(\w+)\]$/)[1].toLowerCase()},r.merge=function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];if(n){t||(t="array"===r.typeOf(n)?[]:{});for(var o in n){var a=n[o];if(n.hasOwnProperty(o)&&"undefined"!==r.typeOf(a)){var i=r.typeOf(a);if("string"===i||"number"===i||"boolean"===i||"function"===i||null===a){t[o]=a;continue}t[o]=r.merge(t[o],a)}}}}return t},e.exportTo(r,"ta.util"),r});
define("ta/Core/TA.Store",["vanillajs","ns-exporter","ta/util/Object"],function(e,r,t){"use strict";var n={},a={};return a.store=function(e,r){return n[e]=r,r},a.retrieve=function(e){return n[e]},a.has=function(e){return"undefined"!=typeof n[e]},a.retrieveOrStore=function(e,r){var t=n[e];return"undefined"==typeof t&&(n[e]=r,t=r),t},a.remove=function(e){var r=n[e];return delete n[e],r},a.keep=function(e,r){var t,n=a.retrieve(e);t=n?n instanceof Array?n:[n]:[],r instanceof Array?r.forEach(function(e){t.contains(e)||t.push(e)}):t.push(r),a.store(e,t)},a.merge=function(e,r){a.store(e,t.merge(a.retrieve(e)||{},r))},a.asInt=function(e,r){var t=parseInt(a.retrieve(e));return isNaN(t)?r||0:t},a.asFloat=function(e,r){var t=parseFloat(a.retrieve(e));return isNaN(t)?r||0:t},a.executeCallbacks=function(e){if(a.has(e)){var r=a.retrieve(e);if(!r instanceof Array)return;for(var t=0;t<r.length;t++)r[t]()}},r.exportTo(a,"ta"),a});
define("utils/resourceLoader",["vanillajs"],function(e){"use strict";function r(){function e(){try{if(navigator.userAgent.match(/ Safari[/]/)&&!navigator.userAgent.match(/ Chrom/)&&navigator.userAgent.match(/ Version\/5\./))return!1;var e=navigator.userAgent.match(/\ AppleWebKit\/(\d+)\.(\d+)/);if(e){e.shift();var r=parseInt(e[0]),t=parseInt(e[1]);if(r<535||535==r&&t<23)return!1}return"onload"in document.createElement("link")}catch(e){return!1}}function r(e,r,t){u++,(u==c.length||l)&&r(t),t?require.defined("ta/util/Error")&&require("ta/util/Error").record(new Error(e),"utils/resourceLoader: failed to load file ["+e+"]"):n[e]=1}function o(e){return e.match(/\.css$/)?"css":e.match(/\.js$/)?"js":""}function a(t,n,u){var c=n||o(u);if(c){var l,s,f;"css"==c?(l=document.createElement("link"),l.rel="stylesheet",l.type="text/css",f="href",s=e()):"js"==c&&(l=document.createElement("script"),l.type="text/javascript",f="src",s="onload"in l),s?(l.onload=r.bind(null,u,t,!1),"onerror"in l&&(l.onerror=function(){i[u]?r(u,t,!0):(i[u]=!0,a(t,n,u))})):r(u,t,!1),l[f]=u;var d=document.getElementsByTagName("head")[0];d.appendChild(l)}else require.defined("ta/util/Error")&&require("ta/util/Error").record(new Error(u),"utils/resourceLoader: unknown file type for ["+u+"]"),r(u,t,!0)}var u,c,l;this.load=function(e,r,n){if("function"==typeof r&&(n=r,r={}),u=0,c=t(e||null),n=n||function(){},r=r||{},l=r.serial,0==c.length)setTimeout(n,1);else if(l){var i,o=c.slice(),s=function(e){i=i&&e,0==o.length?n&&n(i):a(s,r.forceType,o.shift())};s()}else c.forEach(a.bind(null,n,r.forceType))}}function t(e){var r=[],t=function(e){!e||e in n||(e&&e.splice?e.forEach(t):r.push(e))};return t(e),r}var n={},i={};return{Loader:r,load:function(e,t,n){"function"==typeof t&&(n=t,t={}),(new r).load(e,t,n)},loaded:function(e){return 0==t(e).length}}});
define("ta/Core/TA.Load",["vanillajs","ns-exporter","ta/Core/TA.Store","utils/resourceLoader"],function(e,r,o,a){function t(e){if("string"==typeof e&&VERSION_MAP){var r=!1;if(VERSION_MAP[e])r=e;else if(VERSION_MAP[e+".js"])r=e+".js";else for(var o=e.split("."),a=0;o&&o.length>1&&a<10;){o=o.slice(0,-1);var t=o.join("-")+".js";if(t&&VERSION_MAP[t]){r=t;break}a++}return r}}var n={};return n.load=function(e,r,n){var i=!1,s=t(e);s&&(i=VERSION_MAP[s]);var l=function(){var e=o.remove(f);e&&e.forEach(function(e){e&&e()})};if(i){var f=s+"_callback";if(o.has(f)){var c=o.retrieve(f);c.push(r),o.store(f,c)}else o.store(f,[function(){delete VERSION_MAP[s],r&&r()}]),"object"==typeof i?a.load(i,{serial:!0,forceType:"js"},l):a.load(i,{forceType:"js"},l)}else n&&a.loaded(i)&&(l(),r&&r());return i},n.loadInOrder=function(e,r){a.load(e,{serial:!0},r)},r.exportTo(n,"ta"),n});
define("lib/jquery-amd",[],function(){return window.Zepto||ta.jquery||window.jQuery});
define("utils/stopevent",["vanillajs"],function(){return function(e){return e&&(e.stopPropagation?e.stopPropagation():e.cancelBubble=!0,e.preventDefault?e.preventDefault():e.returnValue=!1),!1}});
define("utils/form-to-json",["vanillajs"],function(){"use strict";function e(e,n,r){e in r?(Array.isArray(r[e])||(r[e]=[r[e]]),r[e].push(n)):r[e]=n}return function(n){for(var r={},i={file:1,reset:1},t={DATALIST:1,OUTPUT:1},a={checkbox:1,radio:1},o=0;o<n.elements.length;o++){var l=n.elements[o],s=l.name;if(s){var u=l.nodeName,f=l.type;if("SELECT"===u)for(var v=0;v<l.options.length;v++){var c=l.options[v];c.selected&&e(s,c.value,r)}else"INPUT"===u?f in a?l.checked&&e(s,l.value,r):f in i||e(s,l.value,r):u in t||e(s,l.value,r)}}return r}});
define("utils/to-array",["vanillajs"],function(){return function(n){return"number"!=typeof n.length?[n]:Array.prototype.slice.call(n)}});
define("utils/is-element",["vanillajs"],function(){return function(e){return"object"==typeof HTMLElement?e instanceof HTMLElement:e&&"object"==typeof e&&1===e.nodeType&&"string"==typeof e.nodeName}});
define("api-mod",["lib/jquery-amd","utils/browserutils","utils/stopevent","utils/form-to-json","utils/to-array","utils/is-element"],function($,browser,stopEvent,formToJson,toArray,isElement){"use strict";var exports={};return exports.fn=function(fn){switch(typeof fn){case"function":return fn;case"string":var f=null;try{f=eval(fn)}catch(t){}if(!f){var ns=fn.split("."),n=ns.pop();try{ns=eval(ns.join(".")),f=ns&&ns._magic&&ns._magic.partial(n)}catch(t){}}if(f&&"function"==typeof f)return f}return null},exports.bind=function(t,e){return Function.prototype.bind.apply(t,Array.prototype.slice.call(arguments,1))},exports.inDocument=function(t){return t=exports.find(t),!!t&&!!t.parentNode&&11!==t.parentNode.nodeType},exports.addEvent=function(t,e,r){$(t).on(e,r)},exports.fireEvent=function(t,e,r){$(t).trigger(e,r)},exports.removeEvent=function(t,e,r){$(t).off(e,r)},exports.removePropertyEvent=function(t,e,r){"on"!==e.substr(0,2)&&(e="on"+e);var o=t.getAttribute(e);if(o){var n,s=r.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&");n=o.replace(new RegExp(s+"\\s*\\([^)]*\\);?|(ta\\.call|requireCallLast|requireCallIfReady)\\s*\\(\\s*['\"]\\s*"+s+"[^)]*\\);?"),""),t[e]=n.trim()}},exports.store=function(t,e,r){$(t).data(e,r)},exports.retrieve=function(t,e){return $(t).data(e)},exports.getSize=function(t){if(t=exports.find(t),!t)return null;if(/^(?:body|html)$/i.test(t.tagName)||t===window||t===document){var e=document.compatMode&&"CSS1Compat"!==document.compatMode?document.body:document.body.parentNode;return{x:e.clientWidth,y:e.clientHeight}}return{x:t.offsetWidth,y:t.offsetHeight}},exports.getPosition=function(t,e){if(e=$(e),t=$(t),e.length){var r=e.offset(),o=t.offset();return{left:o.left-r.left,top:o.top-r.top}}return t.offset()},exports.getCoords=function(t){if(t=exports.find(t),!t)return null;var e=this.getSize(t),r=this.getPosition(t);return{top:r.top,left:r.left,bottom:r.top+e.y,right:r.left+e.x,height:e.y,width:e.x}},exports.getOffsetParent=function(t){return $(t).offsetParent().get(0)},exports.getParent=function(t,e){if(t=exports.find(t),!t)return null;if(e){for(;t&&"html"!=t.tagName;t=t.parentNode)if(exports.hasClass(t,e))return t;return null}return t.parentNode},exports.elementOrParentMatches=function(t,e){if(e)for(;t;t=t.parentElement)if(e(t))return!0;return!1},exports.containsElement=function(t,e){if(t=exports.find(t),e=exports.find(e),!t||!e)return!1;for(;null!=e;){if(e===t)return!0;e=e.parentElement}return!1},exports.checkBrowser=function(t){var e=Array.prototype.slice.call(arguments);return e.some(function(t){return!!browser[t]})},exports.containsEvent=function(t,e){if(t=exports.find(t),!e||!t)return!1;var r=e.pageX,o=e.pageY,n=this.getCoords(t);return"fixed"!==$(this.getOffsetParent(t)||t).css("position")&&"undefined"!=typeof r&&"undefined"!=typeof o||(r=e.clientX,o=e.clientY),o>=n.top&&o<=n.bottom&&r>=n.left&&r<=n.right},exports.select=function(t,e){var r=Array.prototype.slice.call(arguments),o=r.length>1&&("string"==typeof r[0]?r.pop():r.shift())||document,n=r.shift();try{return $(n,o).get()}catch(t){return[]}},exports.addClass=function(t,e){$(t).addClass(e)},exports.removeClass=function(t,e){$(t).removeClass(e)},exports.toggleClass=function(t,e,r){$(t).toggleClass(e,r)},exports.hasClass=function(t,e){return t&&$(t).hasClass(e)},exports.destroy=function(t){$(t).remove().get()},exports.find=function(t,e){try{return $(t,e||document)[0]}catch(t){}},exports.scrollTop=function(){var t=void 0!==window.pageYOffset,e="CSS1Compat"===(document.compatMode||"");return t?window.pageYOffset:e?document.documentElement.scrollTop:document.body.scrollTop},exports.scrollLeft=function(){var t=void 0!==window.pageXOffset,e="CSS1Compat"===(document.compatMode||"");return t?window.pageXOffset:e?document.documentElement.scrollLeft:document.body.scrollLeft},exports.createElement=function(t,e){var r=document.createElement(t);return e&&$(r).attr(e),r},exports.isElement=isElement,exports.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)},exports.adopt=function(t,e){$(t).append(Array.prototype.slice.call(arguments,1))},exports.setStyle=function(t,e,r){$(t).css(e,r)},exports.stopEvent=stopEvent,exports.mixin=function(t,e){return Array.prototype.slice.call(arguments,1).forEach(function(e){for(var r in e)t[r]=e[r]},t),t},exports.merge=function(t,e){for(var r=Array.prototype.slice.call(arguments,1),o=0,n=r.length;o<n;o++)for(var s in r[o])r[o].hasOwnProperty(s)&&(t[s]=r[o][s]);return t},exports.getFormData=function(t){return formToJson($(t).get(0))},exports.toFormQueryString=function(t){var e=[];t&&"FORM"===t.nodeName&&(t=exports.getFormData(t));for(var r in t)if(t.hasOwnProperty(r)){var o=t[r];if(o&&"object"==typeof o)for(var n=0;o.length&&n<o.length;++n){var s=o[n];s="object"==typeof s?"":String(s),e.push(encodeURIComponent(r)+"="+encodeURIComponent(s))}else e.push(encodeURIComponent(r)+"="+encodeURIComponent(String(o)))}return e.join("&")},exports.toArray=toArray,exports.forceReflow=function(t){$(t).each(function(t,e){e.offsetWidth})},exports.stripTags=function(t,e,r){e=e||"";var o=r?"<"+e+"(?!\\w)[^>]*>([\\s\\S]*?)</"+e+"(?!\\w)>":"</?"+e+"([^>]+)?>";return t.replace(new RegExp(o,"gi"),"")},exports});
define("purify",["vanillajs"],function(e){function n(e,n){return e?t(e)?(window.IS_DEBUG&&console.error("You're using a jQuery object where you shouldn't. Check the stack trace and fix it!"),n&&e.length>1?e.get():e.get(0)):e.forEach&&(e.length<=1||!n)?e[0]:e:e}function t(e){return!!(e.animate&&e.get&&e.eq&&e.each)}return n});
define("utils/json-to-url",["vanillajs"],function(){"use strict";return function(n){return n?Object.keys(n).map(function(e){return encodeURIComponent(e)+"="+encodeURIComponent(n[e])}).join("&"):""}});
define("utils/asdf-encoder",["ns-exporter","vanillajs"],function(e){"use strict";var t={};return t.getOffset=function(e){return e>=97&&e<=122?e-61:e>=65&&e<=90?e-55:e>=48&&e<=71?e-48:-1},t.asdf=function(e){for(var t={"":["&","=","p","6","?","H","%","B",".com","k","9",".html","n","M","r","www.","h","b","t","a","0","/","d","O","j","http://","_","L","i","f","1","e","-","2",".","N","m","A","l","4","R","C","y","S","o","+","7","I","3","c","5","u",0,"T","v","s","w","8","P",0,"g",0],"q":[0,"__3F__",0,"Photos",0,"https://",".edu","*","Y",">",0,0,0,0,0,0,"`","__2D__","X","<","slot",0,"ShowUrl","Owners",0,"[","q",0,"MemberProfile",0,"ShowUserReviews",'"',"Hotel",0,0,"Expedia","Vacation","Discount",0,"UserReview","Thumbnail",0,"__2F__","Inspiration","V","Map",":","@",0,"F","help",0,0,"Rental",0,"Picture",0,0,0,"hotels",0,"ftp://"],"x":[0,0,"J",0,0,"Z",0,0,0,";",0,"Text",0,"(","x","GenericAds","U",0,"careers",0,0,0,"D",0,"members","Search",0,0,0,"Post",0,0,0,"Q",0,"$",0,"K",0,"W",0,"Reviews",0,",","__2E__",0,0,0,0,0,0,0,"{","}",0,"Cheap",")",0,0,0,"#",".org"],"z":[0,"Hotels",0,0,"Icon",0,0,0,0,".net",0,0,"z",0,0,"pages",0,"geo",0,0,0,"cnt","~",0,0,"]","|",0,"tripadvisor","Images","BookingBuddy",0,"Commerce",0,0,"partnerKey",0,"area",0,"Deals","from","\\",0,"urlKey",0,"'",0,"WeatherUnderground",0,"MemberSign","Maps",0,"matchID","Packages","E","Amenities","Travel",".htm",0,"!","^","G"]},r="",a=0;a<e.length;a++){var n=e.charAt(a),o=n;t[n]&&a+1<e.length?(a++,o+=e.charAt(a)):n="";var s=getOffset(e.charCodeAt(a));r+=s<0||"String"==typeof t[n][s]?o:t[n][s]}return r},e.exportTo(t),t});
define("utils/urlutils",["vanillajs","utils/asdf-encoder"],function(e,t){"use strict";function n(e,t,n){var o=new RegExp("(-"+t+"([0-9]+))|([?&]"+n+"=([0-9]+))"),r=o.exec(e);if(r){if("undefined"!=typeof r[2])return Number(r[2]);if("undefined"!=typeof r[4])return Number(r[4])}}function o(e){return n(e,"d","detail")||n(e,"g","geo")}function r(e){for(var t={},n=e.split("#")[0].split("?")[1]||"",o=n.split("&"),r=0;r<o.length;r++){var i=o[r].split("=");i[0]&&(t[decodeURIComponent(i[0])]=decodeURIComponent(i[1]))}return t}function i(e){var t=[];for(var n in e)if(e.hasOwnProperty(n)){var o=e[n];if(o&&"object"==typeof o)for(var r=0;o.length&&r<o.length;++r){var i=o[r];i="object"==typeof i?"":String(i),t.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}else t.push(encodeURIComponent(n)+"="+encodeURIComponent(String(o)))}return t.join("&")}function f(e){return location.protocol+"//"+location.host+e}function u(e){return e=e||"",e.indexOf("http")===-1&&(e=f(e)),e.replace("http://","https://")}function d(e){var t=l.exec(e);return{protocol:t?t[1]:"",host:t?t[2]:""}}var l=/^([^:]+:)\/\/([^\/\?]+)/,a="undefined"!=typeof window&&window.asdf||("undefined"!=typeof global&&global.asdf?global.asdf:t.asdf);return{asdf:a,getUrlArgNumeric:n,getUrlPageLoc:o,getUrlQueryArgs:r,toQueryString:i,https:u,getParts:d}});
define("ajax-request",["utils/json-to-url","utils/urlutils"],function(t,e){function r(t){var r=document.createElement("a");r.href=t;var s=e.getParts(r.href);return s.protocol!==window.location.protocol||s.host!==window.location.hostname}function s(t,e,s){try{r(t)||e.setRequestHeader("X-Requested-With","XMLHttpRequest")}catch(t){}try{var n=s["content-type"]||"application/x-www-form-urlencoded; charset=utf-8";e.setRequestHeader("Content-Type",n)}catch(t){}try{var o=s.accept||"text/html, */*";e.setRequestHeader("Accept",o)}catch(t){}try{var a=s["x-requested-by"];a&&e.setRequestHeader("X-Requested-By",a)}catch(t){}}function n(){try{return new XMLHttpRequest}catch(t){try{return new ActiveXObject("MSXML2.XMLHTTP")}catch(t){try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(t){throw new Error("Can't create XMLHttpRequest or similar")}}}}return function(e,r){"object"==typeof e&&(r=e,e=r.url),r=r||{};var o=r.method||r.type||"GET",a="string"==typeof r.data?r.data:t(r.data);return new Promise(function(t,c){var u=n(),i=!1;u.onreadystatechange=function(){i||u.readyState!==XMLHttpRequest.DONE||(i=!0,u.status>=200&&u.status<=299?(r.success&&r.success(this.responseText,this.status,u),t(this.responseText)):u.status>0&&(r.error&&r.error(u,this.status,this.statusText),c(this.responseText)),r.complete&&r.complete(u,this.statusText))},"get"===o.toLowerCase()&&"string"==typeof a&&a.length>0&&(e+=("?"===a[0]?"":"?")+a,a=null),u.open(o,e,!r.synchronous),s(e,u,r),u.send(a)})}});
define("utils/object/set-props",["vanillajs"],function(){"use strict";return function(n,r){for(var t in r)r.hasOwnProperty(t)&&(n[t]=r[t]);return n}});
define("utils/object/shallow-copy",["utils/object/set-props","vanillajs"],function(t){"use strict";return function(r){var e;if("object"!=typeof r||null===r)return r;if(r.constructor===Array){e=[];for(var n=0;n<r.length;++n)e.push(r[n])}else e=t({},r);return e}});
define("utils/objutils",["utils/object/set-props","utils/object/shallow-copy","vanillajs"],function(r,t){"use strict";function e(){var r,t,n,o,i,f,u=arguments[0]||{},c=1,l=arguments.length,a=!1;for("boolean"==typeof u&&(a=u,u=arguments[c]||{},c++),"object"==typeof u||h(u)||(u={});c<l;c++)if(null!=(r=arguments[c]))for(t in r)n=u[t],o=r[t],u!==o&&(a&&o&&(j(o)||(i=y(o)))?(i?(i=!1,f=n&&y(n)?n:[]):f=n&&j(n)?n:{},u[t]=e(a,f,o)):void 0!==o&&(u[t]=o));return u}function n(r){if("object"!=typeof r||null===r||w(r))return r;for(var t in r)r.hasOwnProperty(t)&&(r[t]=n(r[t]));return d(r)}function o(r){if("object"!=typeof r||null===r)return r;for(var t in r)if(r.hasOwnProperty(t)){var e=r[t];null===e?delete r[t]:o(e)}return r}function i(r){var t;if("object"!=typeof r||null===r)return r;if(r.constructor===Array){t=[];for(var e=0;e<r.length;++e)t.push(i(r[e]))}else{t={};for(var n in r)r.hasOwnProperty(n)&&(t[n]=i(r[n]))}return d(t)}function f(r){var t;if("object"!=typeof r||null===r)return r;if(r.constructor===Array){t=[];for(var e=0;e<r.length;++e)t.push(f(r[e]))}else{t={};for(var n in r)r.hasOwnProperty(n)&&(t[n]=f(r[n]))}return t}function u(r){var t;if("object"!=typeof r||null===r)return r;if(t=r,r.constructor===Array){P(r)&&(t=[],t.length=r.length);for(var e=0;e<r.length;++e)t[e]=u(r[e])}else{P(r)&&(t={});for(var n in r)r.hasOwnProperty(n)&&(t[n]=u(r[n]))}return t}function c(r,t){if(r!==t){if(!r)return!t;if(!t||r.length!==t.length)return!1;for(var e=0;e<r.length;e++)if(r[e]!==t[e])return!1}return!0}function l(r,t){if(r!==t){if(!r)return!t;if(!t)return!1;if(y(r)&&y(t))return c(r,t);var e=Object.keys(r);if(!c(e,Object.keys(t)))return!1;for(var n=0;n<e.length;n++)if(r[e[n]]!==t[e[n]])return!1}return!0}function a(r,t){var e,n,o={};for(e=0;e<r.length;++e)n=r[e],o[n[t]]=n;return o}function s(r,t){var e=r[t];if(!e&&!r.propertyIsEnumerable(t))throw"missing property: "+t;return e}function p(r,t){for(var e in r)r.hasOwnProperty(e)&&!t(r,r[e])&&delete r[e];return r}function y(r){return Array.isArray?Array.isArray(r):"[object Array]"===Object.prototype.toString.call(r)}function b(r,t,e){var n;if(t){if(Array.prototype.indexOf)return Array.prototype.indexOf.call(t,r,e);for(n=t.length,e=e?e<0?Math.max(0,n+e):e:0;e<n;e++)if(e in t&&t[e]===r)return e}return-1}function h(r){var t={};return r&&"[object Function]"===t.toString.call(r)}function j(r){var t,e;return!(!r||"[object Object]"!==Object.prototype.toString.call(r))&&(!(t=Object.getPrototypeOf(r))||(e=Object.hasOwnProperty.call(t,"constructor")&&t.constructor,"function"==typeof e&&Object.toString.call(e)===Object.toString.call(Object)))}function v(r){var t=[];for(var e in r)r.hasOwnProperty(e)&&t.push(e);return t}function O(r,t){for(var e in r)if(r.hasOwnProperty(e)&&t(r[e],e,r))return r[e]}function g(r,t,e){var n,o=0,i=r.length,f=void 0===i||h(r);if(e)if(f){for(n in r)if(t.apply(r[n],e)===!1)break}else for(;o<i&&t.apply(r[o++],e)!==!1;);else if(f){for(n in r)if(t.call(r[n],n,r[n])===!1)break}else for(;o<i&&t.call(r[o],o,r[o++])!==!1;);return r}var d=function(r){return r},w=function(r){return!0},P=function(r){return!1};return"function"==typeof Object.freeze&&(d=Object.freeze.bind(Object),P=Object.isFrozen.bind(Object),w=Object.isFrozen.bind(Object)),{setProps:r,deepFreeze:n,deepFreezeCopy:i,unfreezeForDust:u,undefineNulls:o,shallowCopy:t,deepCopy:f,shallowEquals:l,index:a,need:s,filterProps:p,keys:v,isArray:y,inArray:b,isFunction:h,isPlainObject:j,each:g,extend:e,find:O}});
define("amdloaders",["utils/to-array"],function(e){var t=[],n=[],r=[],o=[],a=[],d=null,i=null,u={},s={},c={},l={},f=null,p=!1,h=1e4,m=!1,w={},v=function(e,t,r){if("@ta/"!==e.substring(0,4)){if(u[e]){if(s[e]&&/^[-a-z]+\.[-_a-zA-Z0-9]+$/.test(e))return}else u[e]=!0,n.push(e);a.push(function(n){n||!t.parsed||t.parsed(e)||(n=new Error("Dynamic load failed to define module '"+e+"'")),n&&r.error&&r.error(n)}),S()}},g=function(e,t,r){u[e]||(u[e]=!0,s[e]||t.specified(e)||n.push(e)),a.push(function(n){var o=t.parsed(e);n||s[e]||o||(n=new Error("Dynamic load failed to define '"+e+"'")),n?r.error&&r.error(n):o||define(e,[],H(!0))}),t([e],r,r.error),S()},y=function(e,n,r){t.push(e),a.push(function(e){e?r.error&&r.error(e):r(!0)}),S()},C=function(e,t,n){r.push(e),a.push(function(r){r||t.specified("trhtml!"+e)||(r=new Error("Dynamic load failed to define content '"+e+"'")),r&&n.error&&n.error(r)}),S()},L=function(e,t,n){c[e]||(c[e]=!0,l[e]||o.push(e)),a.push(function(e){e?n.error&&n.error(e):n(!0)}),S()},L=function(e,t,n){c[e]||(c[e]=!0,l[e]||o.push(e)),a.push(function(e){e?n.error&&n.error(e):n(!0)}),S()},S=function(){!f&&p&&!m&&(a.length||t.length||n.length||r.length||o.length)&&(f=setTimeout(b,0))},E=function(e,t){var n=e.getAttribute("data-rup");if(n){var r;n=n.split(",");for(var o=0;o<n.length;o++)r=n[o].trim(),r&&t(r)}},R=w.getJSRollupsLoaded=function(){var t=i||e(document.getElementsByTagName("SCRIPT")).reduce(function(e,t){return t.hasAttribute("data-is-dust")||E(t,function(t){e.dedup[t]||(e.rups.push(t),u[t]=s[t]=e.dedup[t]=!0)}),e},{rups:[],dedup:{}}).rups;return!i&&p&&(i=t),t},A=w.getCSSRollupsLoaded=function(){var t=d||(document.head?e(document.head.querySelectorAll("LINK, STYLE")).reduce(function(e,t){return E(t,function(t){e.dedup[t]||(e.rups.push(t),e.dedup[t]=!0)}),e},{rups:[],dedup:{}}).rups:[]);return!d&&p&&(d=t),t},T=w.getLoadedFilesParams=function(){return{haveJses:String(R()),haveCsses:String(A())}},b=function(){if(f=null,p&&!m){var e=t,d=a,i=r,u=o,c=T(),l=n.filter(function(e){return e&&!s[e]&&!require.parsed(e)});if(a=[],t=[],n=[],r=[],o=[],!(l.length||e.length||i.length||u.length))return void I(d);var h="haveJses="+encodeURIComponent(c.haveJses)+"&haveCsses="+encodeURIComponent(c.haveCsses)+"&needJses="+encodeURIComponent(String(l||""))+"&needCsses="+encodeURIComponent(String(e||""))+"&needDusts="+encodeURIComponent(String(u||""));i.length>0&&(h+="&needContent="+encodeURIComponent(String(i))),window.pageServlet&&(h+="&metaReferer="+encodeURIComponent(window.pageServlet));var w=null;try{w=new XMLHttpRequest}catch(e){try{w=new ActiveXObject("MSXML2.XMLHTTP")}catch(e){try{w=new ActiveXObject("Microsoft.XMLHTTP")}catch(e){throw new Error("Can't create XMLHttpRequest or similar")}}}var v=!1;w.onreadystatechange=function(){v||4!==w.readyState||(v=!0,w.status>=200&&w.status<=299?x(d,w.responseText):I(d,new Error("XHR returned "+w.status)))},w.open("POST","/DemandLoadAjax",!0);try{w.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=utf-8")}catch(e){}try{w.setRequestHeader("X-Requested-With","XMLHttpRequest")}catch(e){}try{w.setRequestHeader("Accept","text/html, */*")}catch(e){}m=!0,w.send(h)}},I=function(e,t){if(m=!1,S(),e.length)for(var n=0;n<e.length;++n)try{e[n](t)}catch(e){window.IS_DEBUG&&console.error&&console.error("Error in async callback: ",e)}},D=w.installStyles=function(e){document.head.appendChild(e.reduce(function(e,t){return E(t,function(e){d.push(e),define("trcss!"+e,[],H(void 0))}),e.appendChild(t),e},document.createDocumentFragment()))},q=w.installScripts=function(e){return Promise.all(e.map(function(e){return E(e,function(t){e.hasAttribute("data-is-dust")?l[t]=!0:(i&&i.push(t),s[t]=!0)}),new Promise(function(t){var n=document.createElement("script");n.setAttribute("type","text/javascript"),n.setAttribute("data-rup",e.getAttribute("data-rup")),e.src?(n.src=e.src,n.async=!0,n.onload=n.onerror=t,document.head.appendChild(n)):e.text&&(n.text=e.text,document.head.appendChild(n),document.head.removeChild(n),t())})}))},x=function(t,n){if(!n||!n.substr)return void I(t,new Error("no data returned from /DemandLoadAjax"));var r,o=Promise.resolve();try{var a=document.createElement("DIV");a.innerHTML=n,D(e(a.querySelectorAll("STYLE, LINK"))),o=q(e(a.getElementsByTagName("SCRIPT")));for(var d,i;d=a.firstChild;)a.removeChild(d),1===d.nodeType&&(i=d.getAttribute("data-content"),i&&define("trhtml!"+i,[],H(d)))}catch(e){r=e}o.then(I.bind(null,t,r))},H=function(e){return function(){return e}},M=w.activate=function(){p||(p=!0,define.depLoader&&!define.depLoader.isDefault||(define.depLoader=v),S())},X=function(){for(var e=document.getElementsByTagName("script"),t=0;t<e.length;t++)if(e[t].hasAttribute("data-loadtrk")&&!e[t].loadtrk)return window.console&&console.warn&&console.warn(e[t].src+" is not loaded yet"),!1;return!0},P=function(){"interactive"===document.readyState&&X()&&(window.console&&console.warn&&console.warn("force activate async loading due to wait timeout"),M())};return define("trjs",[],function(){return{load:g}}),define("trcss",[],function(){return{load:y}}),define("trhtml",[],function(){return{load:C}}),define("trdust",[],function(){return{load:L}}),"undefined"!=typeof window&&(document.addEventListener&&!window.taRollupsAreAsync&&document.addEventListener("DOMContentLoaded",M,!1),window.addEventListener?window.addEventListener("load",M,!1):window.attachEvent&&window.attachEvent("onload",M),window.navigator&&window.navigator.userAgent&&window.navigator.userAgent.indexOf("Edge")>-1&&setTimeout(P,h)),w});
define("common/trackingStreams",["vanillajs","amdloaders"],function(){function l(l,e,t){if(e=Array.prototype.slice.call(e),l.handler)try{l.handler.apply(null,e),t()}catch(l){}else if(l.list){l.list.length>=l.limit&&(l.list=l.list.slice(0,l.list.length-1),l.callbacks=l.callbacks.slice(0,l.callbacks.length-1)),l.list.unshift(e),l.callbacks.unshift(t);var r=l.handlerModule;r&&l.handlerMethod&&(l.handlerModule=null,require([r+""],function(e){n(l,e[l.handlerMethod],0)}))}}function e(l,e){if(e=Array.prototype.slice.call(e),l.handler)try{l.handler.apply(null,e)}catch(l){}else if(l.list&&l.list.length<l.limit&&(l.list.push(e),l.handlerModule&&l.handlerMethod)){var t=l.handlerModule;l.handlerModule=null,require([t+""],function(e){n(l,e[l.handlerMethod],0)})}}function n(l,n,t){if(t=t||0,l.handler&&l.priority>=t)return!1;l.handler=n,l.priority=t;var a=l.list;l.list=null;for(var i=0;i<a.length;++i)try{n.apply(null,a[i]),l.callbacks&&l.callbacks[i]&&l.callbacks[i]()}catch(n){l!==r&&e(r,[n,l.name+" dispatch error"])}}var t="trjs!ta/Core/TA.Record",r={name:"errorQ",limit:3,handler:null,handlerModule:"trjs!ta/util/Error",handlerMethod:"record",list:[]},a={name:"GARecordQ",limit:100,handler:null,handlerModule:t,handlerMethod:"trackEventOnPage",list:[]},i={name:"GARecordOnPageOnceQ",limit:100,handler:null,handlerModule:t,handlerMethod:"trackEventOnPageOnce",list:[]},d={name:"SetCookieQ",limit:100,handler:null,handlerModule:t,handlerMethod:"setEvtCookie",list:[]},c={name:"UnifiedUserTrackingQ",limit:100,handler:null,handlerModule:t,handlerMethod:"trackUnifiedEvent",list:[]},o={name:"redirectCallback",limit:1,handler:null,handlerModule:t,handlerMethod:"setEvtCookie",list:[],callbacks:[]};return{error:function(){e(r,arguments)},setErrorHandler:function(l,e){n(r,l,e)},trackEvent:function(){e(a,arguments)},trackEventOnPageOnce:function(){e(i,arguments)},setTrackEventHandler:function(l,e){n(a,l,e)},setEvtCookie:function(){e(d,arguments)},trackUnifiedEvent:function(l,n,t){e(c,arguments)},redirectWithEvt:function(){var e=Array.prototype.slice.call(arguments);e.length>0&&"function"==typeof e[0]&&l(o,e.slice(1),e[0])}}});
define("utils/decoder",["common/trackingStreams"],function(r){function e(e){if(e=e.replace(/\-/g,"+").replace(/\_/g,"/"),e.length%4!==0)for(var n=4-e.length%4,t=0;t<n;t++)e+="=";for(var i,a,o,c,f,d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",g="",h="",l="",s=0;s<e.length;s+=4){if(o=d.indexOf(e.charAt(s)),c=d.indexOf(e.charAt(s+1)),f=d.indexOf(e.charAt(s+2)),l=d.indexOf(e.charAt(s+3)),o==-1||c==-1||f==-1&&l==-1)return void r.error({"string":e},"string contains invalid base64 letter");i=o<<2|c>>4,a=(15&c)<<4|f>>2,h=(3&f)<<6|l,g+=String.fromCharCode(i),64!=f&&(g+=String.fromCharCode(a)),64!=l&&(g+=String.fromCharCode(h)),i=a=h="",o=c=f=l=""}return unescape(g)}return{base64Decoder:e}});
define("utils/urlDecoder",["utils/decoder"],function(e){function t(t){if(!t)return null;var n=4;return t=e.base64Decoder(t),t=t.substring(n,t.length-n)}function n(e){return e.getAttribute("href")||t(e.getAttribute("data-params"))}function r(e,n,r,o){new Event(e).preventDefault();var u=n.getAttribute("data-params");return!!u&&(!!(u=t(u))&&(r&&(u+=r),o?window.open(u,"_blank"):window.location=u,!1))}function o(e){if(!u(e))return e;var n=e.substring(c,e.length);return t(n)}function u(e){return e&&"string"==typeof e&&0==e.indexOf(d)&&e.length>c}function i(e){var t=/TAP\|.+?(?=%2F)/.exec(e),n=t[0],r=o(n),u=e.replace(n,r);window.open(u)}var d="TAP|",c=d.length;return{decodeUrl:t,getUrl:n,goToLink:r,decodeProductCode:o,isObfuscatedProductCode:u,goToCommerceLinkWithProductCode:i}});
define("ta/Core/TA.Record",["vanillajs","ns-exporter","ta/Core/TA.Store","purify","ajax-request","utils/objutils","utils/urlDecoder"],function(e,t,n,r,a,i,o){"use strict";var u={},l={},c=[],s=8,d="impressionTrackingTree",g=0,f=1,v=2,p="UserTracking",m="impression",h="action",k="pageview",y="search",E=[],T=60,P=function(e){return"function"==typeof e},b=function(e,t){try{if(!e||"object"!=typeof t)return;if(window.JSON&&JSON.stringify){var n=JSON.stringify(t);n&&n.length<1e5&&(E.push([e,n]),E.length>T&&E.shift())}}catch(e){}},_=function(e,t,n,r){a(e,t).then(n,r),b(e,t)},S=function(){if(require.defined("ta/util/Error")){var e=require("ta/util/Error");e.record.apply(e,arguments)}else ta&&ta.m&&P(ta.m.recordJSError)&&ta.m.recordJSError(arguments)},C=function(e){return"undefined"==typeof e||null==e?"":("string"!=typeof e&&(e=e.toString()),e.replace(/!/g,"!!").replace(/\./g,"!.").replace(/\*/g,"!*"))},w=function(e){var t=[];for(var n in e){var r=e[n];t.push(C(n)+"."+C(r))}return t.join("*")},A=function(e){return"undefined"==typeof e||null===e?"":("string"!=typeof e&&(e=e.toString()),e.replace(/!/g,"!!").replace(/\./g,"!.").replace(/\*/g,"!*").replace(/\~/g,"!~"))},N=function(e){var t=[];for(var n in e){var r=e[n];t.push(A(n)+"."+A(r))}return t.join("*")},R=function(e){var t=/(https?:\/\/[^\/]+)?\/([^#.?-]*)/,n=t.exec(e);return n&&"undefined"!=typeof n[2]?n[2]?n[2]:"Home":null},O=function(){var e=u.getPageData();if(e&&e.url)return e.url.substring(1);var t=/\/([^-]*)/.exec(window.location.pathname);return t?t[1]:null},I=function(){var e=ta.uid;if(require.defined("redux-init")){var t=require("redux-init");t&&t.tracking&&t.tracking.uid&&(e=t.tracking.uid)}return e},x=function(e,t,n){var r=new RegExp("(-"+t+"([0-9]+))|([?&]"+n+"=([0-9]+))"),a=r.exec(e);if(a){if("undefined"!=typeof a[2])return a[2];if("undefined"!=typeof a[4])return a[4]}return null},M=function(e){return x(e,"d","detail")||x(e,"g","geo")},q=function(e){var t=document.cookie.match("(?:^|;)\\s*"+e+"=([^;]*)");return!!t&&(t=t[1],0===t.indexOf("%1%")&&(t=t.substring(3)),decodeURIComponent(t))},L=function(e,t,n){try{var r;n.encode&&(t=encodeURIComponent(t)),n.domain&&(t+="; domain="+n.domain),n.path&&(t+="; path="+n.path),n.duration&&(r=new Date,r.setTime(r.getTime()+1e3*n.duration),t+="; expires="+r.toGMTString()),n.secure&&(t+="; secure"),document.cookie=e+"="+t}catch(e){S(e,"_setCookieInSeconds",null,arguments)}},D=function(){return ta.m&&ta.m.store&&ta.m.store.has("bookingSessionId")?ta.m.store.get("bookingSessionId"):null},H=function(){var e=!1;return"boolean"==typeof ta.userLoggedIn&&(e="boolean"==typeof ta.userSecurelyLoggedIn?ta.userLoggedIn?ta.userSecurelyLoggedIn?v:f:g:ta.userLoggedIn),e},U=function(e,t){var r={gac:e[1],gaa:e[2],gal:e[3],gav:e[4],gani:e[5],gass:O(),gasl:M(document.location.href),gads:R(t),gadl:M(t),gapu:I(),gams:H()},a=D();if(!r.gass)throw new Error("Src servlet undefined, gac:"+r.gac+", gaa:"+r.gaa+", gal:"+r.gal);if(!r.gads)throw new Error("Dst servlet undefined. gac:"+r.gac+", gaa:"+r.gaa+", gal:"+r.gal);n.has("gatt")&&(r.gatt=n.retrieve("gatt")),a&&(r.bsid=a),L("EVT",w(r),{domain:cookieDomain,duration:5,encode:!0,path:"/"})},j=function(e){if(!e||!e.className||!e.firstChild)return!1;var t=new RegExp("\\b"+d+"\\b"),n=e.firstChild.nodeType,r=e.firstChild.nodeValue;return t.test(e.className)&&n===s&&""!==r},J=function(){};require.defined("page-model")&&require(["page-model"],function(e){var t=e.session,r=t.analyticsInfo;r&&(n.keep("partials.pageProperties",r.pagePropertyStringForCurrentPageview),n.store("gaMemberState",r.memberState),t.analyticsInfo&&require.defined("ta/Core/TA.Prerender")&&require("ta/Core/TA.Prerender")._init(!0)),J=function(){r&&c.push(JSON.parse(r.jsonForCurrentPageview)),J=function(){}}}),u.getPageData=function(){return J(),c[c.length-1]},u.pushPageData=function(e){J(),e&&c.push(e)},u._GARecordRequest=function(e,t){var r,a={gac:e[1],gaa:e[2],gal:e[3],gav:e[4],gani:e[5],gass:O(),gasl:document.location?M(document.location.href):null,gapu:I(),gams:H()},i=D();return t&&(a.gacl=t),n.has("gatt")&&(a.gatt=n.retrieve("gatt")),i&&(a.bsid=i),r=require.defined("utils/BatchRequest")?{get:function(){require("utils/BatchRequest").queue("/GARecord",a)}}:{get:function(){setTimeout(function(){var e=new XMLHttpRequest;e.open("GET","/GARecord?"+W(a),!0),e.send(null)},1)}},b("/GARecord",a),r};var W=function(e){var t=[];for(var n in e)t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t.join("&")};l.urlArgLookup=function(e,t){var n=new RegExp("[\\?&]"+e+"=(\\w+)"),r=n.exec(t);return r&&"undefined"!=typeof r[1]?r[1]:null},u._validatedTrackEventArray=function(e,t,n,r,a){return e&&"string"!=typeof e&&(e=e.toString()),t&&"string"!=typeof t&&(t=t.toString()),n&&"string"!=typeof n&&(n=n.toString()),r?"number"!=typeof r&&(r=parseFloat(r),isNaN(r)&&(r=0)):r=0,"boolean"!=typeof a&&(a=a===!0),["_trackEvent",e,t,n,r,a]},u._toEvtParams=function(e){try{var t={gac:e.module,gaa:e.action,gal:e.context,gav:e.value,gani:e.noninteraction};return t.gass=O(),t.gasl=M(document.location.href),t.gapu=I(),t.gams=H(),t}catch(t){S(t,"analytics._toEvtParams",null,e)}},u._trackEventAfterAjax=function(e){try{l.trackDMPBehavior(e.module,e.action,e.context,e.value,e.noninteraction)}catch(t){S(t,"analytics._trackEventAfterAjax",null,e)}},l.getEventPathOptions=function(e,t,n){try{var r=z(n,e);if(!r)return void S(null,"ta.getEventPathOptions - invalid element",null,arguments);var a=$(r);return t&&(a.noninteraction=t),a}catch(e){S(e,"ta.getEventPathOptions",null,arguments)}},u._trackEventPathAfterAjax=function(e){try{l.trackEventOnPage(e.category,e.action,e.label,e.value,e.noninteraction)}catch(e){S(e,"analytics._trackEventPathAfterAjax",null,arguments)}},l.trackPhysicalCommerce=function(e,t,n,r){try{var a=u._validatedTrackEventArray(e,"Commerce-Physical",t,n,!1);u._GARecordRequest(a,r).get()}catch(e){S(e,"ta.trackPhysicalCommerce",null,arguments)}},l.trackAttemptedCommerce=function(e,t,n){try{l.trackDMPBehavior(e,t,n,null,null)}catch(e){S(e,"ta.trackAttemptedCommerce",null,arguments)}},l.trackPhysicalAndAttemptedCommerce=function(e,t,n,r,a){l.trackPhysicalCommerce(e,t,r,a),l.trackAttemptedCommerce(e,t,n,r)},l.trackImpressionEventOnPage=function(e,t,n,r){e=e||"",t=t||"",n=n||"",r=r||0,l.trackEventOnPage(e,t,n,r,!0)},l.trackEventOnPage=function(e,t,n,r,a){o.isObfuscatedProductCode(e)&&(e=o.decodeProductCode(e)),o.isObfuscatedProductCode(t)&&(t=o.decodeProductCode(t)),o.isObfuscatedProductCode(n)&&(n=o.decodeProductCode(n));try{var i=u._validatedTrackEventArray(e,t,n,r,a);u._GARecordRequest(i).get()}catch(e){S(e,"ta.trackEventOnPage",null,arguments)}},l.trackEventOnPageOnce=function(e,t,r,a){var i,o="eventsAlreadyTracked";i="object"==typeof ta&&ta.m&&ta.m.store?ta.m.store.get(o):n.retrieve(o),i||(i={},"object"==typeof ta&&ta.m&&ta.m.store?ta.m.store.add(o,i):n.store(o,i));var u=e+"|"+t+"|"+r;i[u]||(l.trackEventOnPage(e,t,r,0,a),i[u]=!0)},l.trackDMPBehavior=function(e,t,n,r,a){},l.setEvtCookie=function(e,t,n,r,a){try{var i=u._validatedTrackEventArray(e,t,n,r,!1);if(U(i,a),require.defined("ta/common/behavior/dmp/DMP")){var o=require("ta/common/behavior/dmp/DMP");o.isEnabled()&&o.sendEventBehavior(e,t,n,r,Z())}}catch(e){S(e,"ta.setEvtCookie",null,arguments)}};var G=function(e){var t;try{if(t=q("MEVT")||"",t.length>0&&(t+="~"),t+=N(e),t.length>1024)throw"MEVT Cookie is full";L("MEVT",t,{domain:cookieDomain,duration:5,encode:!0})}catch(e){return S(e,"_appendMevtCookie",null,arguments),!1}return!0},B="trk",V=B.length,F="etk",X=/^([A-Z]{1,2}:)?[A-Za-z_0-9\-\.]+$/,Z=function(){var e="undefined"!=typeof event?event:window.event;return e?e.target||e.srcElement:document.activeElement};u.getCommentTrackingPath=function(e,t){return z(e,t)};var z=function(e,t){if(e=r(e),!e&&(e=Z(),!e))return S(null,"_getCommentTrackingPath - no element provided or event target element",null,arguments),null;if(1!=e.nodeType)return null;var n=[];if(t&&"string"==typeof t&&""!==t&&X.test(t)){if("P:"==t.substring(0,2))return n.push(t.substring(2)),n;n.push(t)}if("undefined"==typeof e.previousSibling)return S(null,"_getCommentTrackingPath - browser does not support previousSibling",null,arguments),n;e:for(var a=e;a!=document.body;a=a.parentNode){if(null==a){S(null,"_getCommentTrackingPath - LOOP_PARENT_NODES got unexpected null node",null,arguments);break}for(var i=0,o=a.previousSibling;null!=o;o=o.previousSibling)if(o.nodeType==s){var u=o.nodeValue;if(u==F){i++;continue}if(u.substring(0,V)!=B)continue;if(i>0){i--;continue}var l=u.substring(V).split("/");l||S(null,'ta._getCommentTrackingPath - cannot split context class: "'+u+'"',null,arguments);for(var c=l.length-1;c>=0;c--){var d=l[c],g=X.exec(d);if(g){if("P:"==g[1]){var f=g[0].substring(2);n.push(f);break e}n.push(g[0])}else S(null,'ta._getCommentTrackingPath - tracking prefix used with invalid context: "'+l[c]+'"',null,arguments)}}}return n},$=function(e){if(0===e.length)return null;var t={"action":e[0],"label":"","value":"1","category":e[e.length-1]};e.shift();for(var n=e.length-2;n>=0;n--)t.label+=e[n],n>0&&(t.label+="/"),"N:"==e[n].substring(0,2)&&(t.value=e[n].substring(2));return""===t.label&&(t.label="Unknown"),t};l.trk=function(e,t,n,a){n=r(n);try{var i=n?n.getAttribute("data-trk-path"):null;if(i)i=i.replace("P:",""),i=i.split("/"),i.reverse();else if(i=z(n,e),!i||!i.length){var o="";if(n)if(n.outerHTML){var u=document.createTextNode(n.outerHTML),c=document.createElement("div");c.appendChild(u),o=c.innerHTML.substring(0,100)}else n.nodeName?o=n.nodeName:o+=n;else void 0===n?o="undefined":null===n&&(o="null");return e||(e=null===i?"null path":void 0===i?"undefined path":i.hasOwnProperty("length")?0===i.length?"empty path":i.join(","):"path: "+i),void S(null,"ta.trk - invalid element for "+e+" from "+o,null,arguments)}l.trkWithPath(i,t,a)}catch(e){S(e,"ta.trk",null,arguments)}},l.trkWithPath=function(e,t,n){try{if(!e||!e.length)return void S(null,"ta.trkWithPath - no path in arguments",null,arguments);if(n&&n.length>0&&e.length&&e.splice)for(var r=n.length-1;r>=0;r--)"string"==typeof n[r]&&e.splice(1,0,n[r]);var a=$(e);l.trackEventOnPage(a.category,a.action,a.label,a.value,t)}catch(e){S(e,"ta.trkWithPath - "+e,null,arguments)}},l.trkImpTree=function(e){try{if(!j(e))return void S(null,"ta.trkImpTree called with invalid trackTreeElem!",null,arguments);var t=e.firstChild.nodeValue;ne(t)}catch(e){S(e,"ta.trkImpTree",null,arguments)}},l.recordImpression=function(e,t){if(!e)return void(t&&t());try{ne(Y(e),t)}catch(e){S(e,"ta.recordImpression",null,arguments),t&&t()}};var K="<!--",Q="-->",Y=function(e){var t=e.indexOf(K),n=0,r=e.indexOf(Q);return t!==-1&&(n=t+K.length),r===-1&&(r=e.length),e.substring(n,r)};u.stripCommentsFromTree=Y;var ee="\\",te="/";u.appendAscendTokens=function(e){var t=0,n=0,r=0;for(t=0;t<e.length;t++)if(e[t]===te)r++;else if(e[t]===ee)for(n=t+1;n<e.length&&e[n]===ee;)r--,t=n,n++;if(r>0)for(t=0;t<r;t++)e+=ee;return e};var ne=function(e,t){var n={tTreeStr:e&&e.trim(),tTreeUid:ta.uid&&ta.uid.trim(),tTreeLastReferrer:window.location.href,tTreeIsMemberSignedIn:H()};ta.m&&ta.m.store&&ta.m.store.has("bookingSessionId")&&(n.bsid=ta.m.store.get("bookingSessionId")),n.tTreeStr?n.tTreeUid||S(new Error("tTreeUid is null/undefined/empty."),"ta._sendTreeImpression",null):S(new Error("tTreeStr is null/undefined/empty."),"ta._sendTreeImpression",null),_("/ImpressionRecord",{method:"POST",url:"/ImpressionRecord",data:n},t)};l.setEvtCookieAndPath=function(e,t,n){try{n||(n=Z());var r=z(n,e);if(!r)return void S(null,"ta.setEvtCookieAndPath - invalid element for "+e,null,arguments);var a=$(r);if(!t){for(;"A"!=n.nodeName&&n!=document.body;)n=n.parentNode;if(t=n.href,!t)return void S(null,"ta.setEvtCookieAndPath - no url parameter and cannot find a.href",null,arguments)}l.setEvtCookie(a.category,a.action,a.label,a.value,t)}catch(e){S(e,"ta.setEvtCookieAndPath",null,arguments)}},l.recordPageview=function(e,t){if(e){var n=R(e),r="/PageviewRecord",a=t?t:{};n&&(a.servletName=n,_(r,{method:"POST",data:a}))}},l.recordTabView=function(e,t,n){if(e&&t){var r=e+"-"+t,a="/PageviewRecord",i=n?n:{};i.servletName=r,_(a,{method:"POST",data:i})}},l.resetPageDataUrl=function(){var e=u.getPageData();e&&(e.url="")},l.trackEngagementClick=function(e,t){return e&&t?P(t)?void t(e):void S(new Error("passed variable selectionFunction is not a function"),"ta.trackEngagementClick",null,t):void S(new Error("object/selectionFunction is null/undefined"),"ta.trackEngagementClick",null,arguments)},l.placementNodeSelectorTracker=function(e){if(!e||!e.element||!e.type)return void S(new Error("object/element/type is null/undefined"),"ta.placementNodeSelectorTracker",null,e);var t,n,r,a,i,o,c=e.element,s=e.type,d=u.getCommentTrackingPath(c);if(s+="_Click",!d)return void S(new Error("trackTreePath is null/undefined"),"ta.placementNodeSelectorTracker",null,arguments);if(d.length<1)return void S(new Error("trackTreePath is missing information"),"ta.placementNodeSelectorTracker",null,arguments);if(t=d[d.length-1],!t)return void S(new Error("placement is null/undefined"),"ta.placementNodeSelectorTracker",null,d);for(o=d.length-1;o>=0;o--)if(i=d[o],i&&0===i.indexOf("N:")){n=i;break}if("HH_MainList"===t||"Maps_MetaBlock"===t)n="N:1";else if(!n)return void S(new Error("positionNode is null/undefined"),"ta.placementNodeSelectorTracker",null,d);if(r=n.split(":"),!r||2!==r.length)return void S(new Error("positionSplit appears to be incorrect"),"ta.placementNodeSelectorTracker",null,arguments);if(a=r[1],!a)return void S(new Error("position is null/undefined"),"ta.placementNodeSelectorTracker",null,arguments);var g=parseInt(a,10);if(isNaN(g))return void S(new Error("position is not a number"),"ta.placementNodeSelectorTracker",null,a);var f=ae(t);if(f!==-1){a=g+f,t=re(t);var v,p=document.querySelectorAll(".ui_tab_bar .ui_tab.selected");1===p.length&&(p=p[0],v=p.getAttribute("data-currentSort")),l.trackEventOnPage(t,s,v,a)}};var re=function(e){if(!e)return e;if("Hotels"!==O())return"Clicks_"+e;var t;return"Hotels_MainList"===e||"Hotels_MainList_Sponsored"===e||"Hotels_MainList_Discovery_Sponsored_Listing"===e?t="Clicks_"+e:"sponsored_coupon_listing"===e&&(t="Clicks_Hotels_MainList_Sponsored"),document.getElementById("sponsoredCouponListingWrap")&&"Clicks_Hotels_MainList"===t&&(t+="_Sponsored"),t+=ta.widgets.calendar.getCheckRatesData()?"_PostDates":"_PreDates"},ae=function(e){if(!e)return S(new Error("placement is null/undefined"),"ta._shiftOrdinalsWithSponsoredPlacement",null,e),-1;if("Hotels"!==O())return 0;var t=0,r=n.retrieve("hac.offset");if(r&&r>0&&(t=r),!document.getElementById("sponsoredCouponListingWrap"))return t;var a,i=document.querySelector("#HAC_RESULTS .pageNumbers .current");if(i){var o=i.getAttribute("data-page-number");if(a=parseInt(o,10),isNaN(a)||!a)return S(new Error("pageNumber is not a number"),"ta._shiftOrdinalsWithSponsoredPlacement",null,o),-1}return"Hotels_MainList"===e?t+=a:(r&&r>0&&("sponsored_coupon_listing"===e||"Hotels_MainList_Sponsored"===e||"Hotels_MainList_Discovery_Sponsored_Listing"===e)&&(t+=a-1),t)};l.getRecentTARecords=function(){return E},l.addTypeAheadMevt=function(e){return e.t="ta",G(e)},l.addGARecordMevt=function(e,t,r,a,i){try{var o=u._validatedTrackEventArray(e,t,r,a,!1),l={t:"ga",gac:o[1],gaa:o[2],gal:o[3],gav:o[4],gani:o[5],gass:O(),gasl:M(document.location.href),gads:R(i),gadl:M(i),gapu:I(),gams:H()},c=D();if(!l.gass)throw new Error("Src servlet undefined, gac:"+l.gac+", gaa:"+l.gaa+", gal:"+l.gal);if(!l.gads)throw new Error("Dst servlet undefined. gac:"+l.gac+", gaa:"+l.gaa+", gal:"+l.gal);if(n.has("gatt")&&(l.gatt=n.retrieve("gatt")),c&&(l.bsid=c),G(l),require.defined("ta/common/behavior/dmp/DMP")){var s=require("ta/common/behavior/dmp/DMP");s.isEnabled()&&s.sendEventBehavior(e,t,r,a,Z())}}catch(e){S(e,"ta.addGARecordMevt",null,arguments)}},l.trackInteractions=function(e,t,n){var r={"elmtSource":e,"elmtType":n};r=i.extend(r,t),_("/UserInteractionRecord",{method:"POST",url:"/UserInteractionRecord",data:r},null,function(){S(null,"taRecord.trackInteractions",null,r)})},l.addInteractionsMEVT=function(e,t,n){var r={"t":"ia","ias":e,"iak":ie(t),"iat":n};G(r)};var ie=function(e){var t="";return Object.keys(e).forEach(function(n){t=t+n+"^"+e[n]+"+"}),0==t.length?t:t.slice(0,-1)},oe=!1,ue=function(e,t){return oe||(oe=require.defined("page-model")?require("page-model").session:{}),!!oe.useERUserTracking&&!(oe.ERUserTrackingEventNames&&oe.ERUserTrackingEventNames.length>0&&oe.ERUserTrackingEventNames.indexOf(e)<0)},le=function(e,t,n){if(ue(e,t)){var r=oe.uid&&{request_uid:oe.uid}||{},a={event_name:e,event_type:t,attr:JSON.stringify(i.extend(n,r))},o={get:function(){setTimeout(function(){var e=new XMLHttpRequest;e.open("GET","/UserTrackingRecord?"+W(a),!0),e.send(null)},1)}};return o.get()}n.event_name=e,l.trackEventOnPage(p,t,JSON.stringify(n))};l.trackImpressionWithJson=function(e,t){le(e,m,t)},l.trackActionWithJson=function(e,t){le(e,h,t)},l.trackPageviewWithJson=function(e,t){le(e,k,t)},l.trackSearchWithJson=function(e,t){le(e,y,t)},l.trackUnifiedEvent=le,t.createNs(u,"ta","analytics"),t.exportTo(l,"ta");var ce={};return t.exportTo(u,ce),t.exportTo(l,ce),ce});
define("utils/ajax",["lib/jquery-amd","ta/Core/TA.Record","utils/form-to-json"],function(e,t,i){function n(e){return"object"==typeof HTMLElement?e instanceof HTMLElement:e&&"object"==typeof e&&1===e.nodeType&&"string"==typeof e.nodeName}return function(r,a){r.substr||(a=r);var s=e.extend({},a,{dataFilter:function(e,t){return"json"==t&&(e=e.replace(/^\s*while\s*\([^)]*\);?/,"")),a&&a.dataFilter&&a.dataFilter.call(this,e,t),e}});s.xhrFields=s.xhrFields||{},s.xhrFields.withCredentials=!0,n(s.data)&&(s.data=i(s.data));var c=s.trackEvent;return c&&(e.extend(s,t._toEvtParams(c)),s.complete=function(){t._trackEventAfterAjax(c),a&&a.complete&&a.complete.apply(this,arguments)}),s.evalScripts&&(s.success=function(t,i,n){if(t&&t.substr){var r,s;e.parseHTML?(r=e(e.parseHTML(t,document,!0)),s=r.filter("script").add(r.find("script"))):(r=e("<div>"+t+"</div>"),s=r.find("script")),s.each(function(e,t){if(t.innerHTML)if(window.execScript)window.execScript(t.innerHTML);else if(window.eval)window.eval(t.innerHTML);else{var i=document.createElement("script");i.setAttribute("type","text/javascript"),i.text=t.innerHTML,document.head.appendChild(i),document.head.removeChild(i)}})}a&&a.success&&a.success.apply(this,arguments)}),r.substr?e.ajax(r,s):e.ajax(s)}});
define("mixins/Events",["vanillajs"],function(e){"use strict";var t=function(){this.events={},Array.prototype.slice.call(arguments).forEach(function(e){this.events[e]=[]},this)};return t.create=function(){function e(e){return t.apply(this,e)}return e.prototype=t.prototype,function(){return new e(arguments)}}(),t.extend=function(e,r){var i=Object.create(t.prototype);return i.delegate=e,t.apply(i,r),i},t.prototype.on=t.prototype.addListener=function(e,t){return void 0!==this.events[e]?this.events[e].push(t):this.delegate?this.delegate.on(e,t):this.events[e]=[t],this},t.prototype.off=t.prototype.removeListener=function(e,t){if(void 0!==this.events[e])if(t){var r=this.events[e].indexOf(t);r>=0&&this.events[e].splice(r,1)}else this.events[e].length=0;else this.delegate&&this.delegate.removeListener(e,t);return this},t.prototype.removeAllListeners=function(e){if(e&&void 0!==this.events[e])this.events[e].length=0;else if(e)this.delegate&&this.delegate.removeAllListeners&&this.delegate.removeAllListeners(e);else{for(var t in this.events)this.events.hasOwnProperty(t)&&(this.events[t].length=0);this.delegate&&this.delegate.removeAllListeners&&this.delegate.removeAllListeners()}},t.prototype.hasListeners=function(e){if(e){if(this.events.hasOwnProperty(e))return this.events[e].length>0;if(this.delegate&&this.delegate.hasListeners)return this.delegate.hasListeners(e)}return!1},t.prototype.emit=function(e,t){if(this.events[e]){var r=Array.prototype.slice.call(arguments,1);this.events[e].slice(0).forEach(function(t){if(t)try{t.apply(this,r)}catch(t){"string"==typeof t&&(t=new Error(t));var i="Error in event handler for "+e;if(require.defined("ta/util/Error"))require("ta/util/Error").record(t,i);else{var s=require.defined("ta")&&require("ta");s&&s.log&&s.log.error?s.log.error(t,i):s&&s.m&&s.m.recordJSError?s.m.recordJSError([t,i]):"undefined"!=typeof console&&(console.error||console.log)(i,t)}}},this)}else this.delegate&&this.delegate.emit&&this.delegate.emit.apply(delegate,arguments);return this},t.prototype.addOrReplaceListener=function(e,t){this.off(e,t).on(e,t)},t});
define("ta/util/Cookie",["vanillajs","ns-exporter"],function(e,o){var t=0,n=5e3,i={cookiePIDName:"NPID",ONE_DAY:864e5,ONE_HOUR:36e5,setPIDCookie:function(e){i.write(i.cookiePIDName,e,n,"/",window.cookieDomain)},removePIDCookie:function(){try{i.write(i.cookiePIDName,"",t,"/",window.cookieDomain)}catch(e){}},canSet:function(){return document.cookie="SessionTest=true",!!document.cookie.match("(^|;)\\s*SessionTest=true\\s*(;|$)")&&(document.cookie="SessionTest=; expires=Thu, 01 Jan 1970 00:00:01 GMT",!0)},readRaw:function(e){e=e.replace(/([-.*+?^${}()|[\]\/\\])/g,"\\$1");var o=document.cookie.match(new RegExp("(?:^|;)\\s*"+e+"=([^;]*)"));return!!o&&o[1]},remove:function(e,o,t){i.write(e,"",new Date(1e3),o,t)},write:function(e,o,t,n,i){"number"==typeof t&&(t=new Date(Date.now()+t)),document.cookie=e+"="+o+(t?"; expires="+t.toUTCString():"")+(n?"; path="+n:"")+(i?"; domain="+i:"")},setOneTimeCookieOnFQDN:function(e,o){return i.write(e,o,5e3),!0},setOneTimeCookie:function(e,o){return i.write(e,o,5e3,null,window.cookieDomain),!0}};return o.exportTo({setPID:i.setPIDCookie}),o.createNs(i,"ta.util","cookie"),i});
define("ta/util/Error",["vanillajs","api-mod","utils/ajax","ns-exporter","mixins/Events","utils/browserutils","ta/util/Cookie","ta"],function(r,e,t,o,n,a,i,c){function s(r,t){var o="_extraInfoError_:Problem storing extra info.",n={},a="";try{if(Array.isArray(t)||"[object Arguments]"===Object.prototype.toString.call(t)){for(var i={},c=0;c<t.length;c++){var s=t[c],l=typeof s;"string"===l||"number"===l||"boolean"===l?i[c]=s:i[c]=l}t=i}e.merge(n,r,t)}catch(e){n=r}try{if(a=JSON.stringify(n))return a.length>y&&(a=a.substring(0,y)),a.replace(/[\r\n]/g,"")}catch(r){}return o}function l(r){return"undefined"!=typeof r&&null!==r?r.toString().replace(/[\r\n]/g,""):"null or undefined"}function f(r,e,t){var o,n="";if(r&&r.stack)try{var a,i,c=r.stack.split("\n"),s=[],l=0;c[1]&&c[1].match(/\.record /)&&c.splice(1,1);for(var f=0;f<c.length;f++){var u=c[f];if(!(u.indexOf(r.message)>=0)){var d=!!u.match(/\/jquery-|\/mootools|\(native\)|\(native code\)|\[native code]/);u=u.replace(/^(.*)http.+\/([^\/]*)/,"$1$2").replace(/(\?.{20})[^:)]+/,"$1...").replace(/^(?:\s+\w+\s*([^\s]+)|([^\s]+)@)\s*\(?([^)]*)\)?$/,"$1$2 ($3)").replace(/\s*\(\)/,""),a&&d?i||(s.push("..."),i=!0,l++):(s.push(u),d&&l++),d||(i=!1),a=d}}s.length-l<=w&&(o=!0),n=s.join()}catch(r){h&&(console.error("Debug: error.stack handler failed "),console.error(r))}if(!n&&t)try{for(var g=[],m=t.caller,v=0;m&&v++<20;){var S=m.toString(),y=S.replace(/^function\s+([^(\s]+).*/,"$1")||"anonymous";if(!y.match(/onErrorFunc|_getErrorStack/)){var R=Math.min(S.length,100),E=S.substring(0,R).replace(/(\n|\r|\'|\")/g," ");g.push(E)}m=m.caller}g.length<5&&(o=!0),n=g.join(" :: ")}catch(r){h&&console.error("Debug: exception getting callee stack "+r)}if(!n&&r&&r.filename&&(n=r.filename.replace(/^.*\/([^/]+)$/,"$1"),r.lineno&&(n+=":"+r.lineno),r.colno&&(n+=":"+r.colno)),e&&o){var b=p.getSelectorString(e);b&&(n&&(n+=", "),n+="DOM_STACK: "+b)}return n?n:"failed to get stack"}function u(){var r=[];return[].forEach.call(document.getElementsByTagName("script"),function(e){var t=e.src;d(t)&&r.push(t.substring(t.indexOf("/js")+1))}),r.join(", ").substring(0,y)}function d(r){if(!r||!r.indexOf)return!1;var e=window.CDNHOST||"";return h&&""==e?null!=r.match(/(js3\/|js\/)/):0==r.indexOf(e)}function g(r){if(!r||!r.indexOf)return!1;var e="noPage";try{e=window.location.href}catch(r){}return r===e}function m(){var r=(a.Platform.ios||a.Platform.android)&&!window.isTabletOnFullSite,e=document.cookie.indexOf("TAmobilemode=main")>=0;return r&&!e}function v(r){if(m()){var e={eMsg:"msg",eStak:"stack",eUrl:"url"};for(var t in e){var o=e[t];r[o]=r[t]}r.file=r.url||document.URL,r.site=window.SITE_VERSION,r.loaded=O?"dom_ready":"not_loaded"}}var p={},S=new n("error","beforeSend"),h=window.IS_DEBUG,y=3e3,R=h?100:10,w=4,E="unset",b=0,O=!1;return p.record=function(r,e,o,n,a,y){y=y||{},r?"string"==typeof r&&(r=new Error(r)):r=new Error("Stub error to build stack.");var w=!1;try{var O=Object.prototype.toString.call(r);w=O===Object.prototype.toString.call(new Error)||O.match(/\[object Error[\w]*]/)}catch(r){}if(w&&!r.stack)try{throw r}catch(e){e&&e.stack&&(r=e)}o=o||window.event||{};var N=o.target;if(b>=R)return void(h&&console.error("Maximum JS errors reached. Not reporting."));b++;var j=!1;try{j=document.body.className.match(/\bjs_logging\b/)||m()}catch(r){}if(j){var _=!0;n&&n.hasOwnProperty("error_script")&&!d(n.error_script)&&!g(n.error_script)&&(_=!1);var k={};if(N)try{k.eTarg=p.getSelectorString(N)}catch(r){}"undefined"!=typeof debugCacheKey&&(k.key=debugCacheKey);var T=window.pageServlet;T||(T="unknown"),k.servlet=T,a&&"string"==typeof a||(a="ERROR"),_?!h&&b>1?(a="WARN",k.warnReason="notFirstJSError"):"object"==typeof r&&"WARN"===r.level&&(a="WARN"):(a="WARN",k.warnReason="externalError");var A={"extraInfoError":"Problem storing extra info"},x={};try{var D="",L="";N&&("function"!=typeof N.id&&(D=N.id),L=N.className);var P=window.serverPool||"",I="";window.MooTools&&(I+="MooTools "),require.defined("lib/jquery-amd")&&(I+="jQuery "),x={"TARGET_ID":D,"TARGET_CLASS":L,"PAGE_UID":c&&c.uid,"INTERNAL_JS":u(),"CLIENT_POOL":P,"COOKIES_ENABLED":i.canSet(),"JS_LIBS":I},_||(x.INTERNAL_ERROR="false"),b>1&&(x.PRIOR_JS_PAGE_ERRORS=b-1)}catch(r){n=A}k.xInfo=s(x,n);try{k.eUrl=window.location.href}catch(r){}try{var J=c.page.getDates("STAYDATES");J?k.eDates=J[0].toLocaleDateString("en-US")+" - "+J[1].toLocaleDateString("en-US"):k.eDates="No dates set"}catch(r){}var $="No Error";try{if(w)$=r.name+"-"+r.message;else if("object"==typeof r)if(r.name&&r.message)$=r.name+"-"+r.message;else{$="non-Error object "+Object.prototype.toString.call(r)+" passed, sample properties - ";var M=0;for(var C in r)if(r.hasOwnProperty(C)&&($+=C.substring(0,30)+": "+(r[C]&&r[C].toString?r[C].toString().substring(0,20):r[C])+", ",++M>4))break}else $="non-Object error passed: "+(""+r).substring(0,60);$=$.replace(/[\r\n]/g,"")}catch(r){}k.eMsg=$;try{k.eBlk=l(e).substring(0,150)}catch(r){}var U;if(!r.stack)try{U=o&&o.callee||arguments&&arguments.callee}catch(r){}var B=f(r,N,U);B&&(k.eStak=B);try{S.emit("beforeSend",k)}catch(r){}k.eLogLevel=a,v(k),h&&!y.isglobal&&(console.error("/JSErrorRecord:"),r.stack?console.error(r.stack):B?console.error(B):console.error("No stack"));try{t({url:"/JSErrorRecord",data:k,method:"POST",type:"POST"})}catch(r){k={"eBlk":"JSErrorRecord Error","servlet":T,"eLogLevel":"ERROR","eMsg":"no error retrieved"},t({url:"/JSErrorRecord",data:k})}if(h&&(window.ERRORS||(window.ERRORS=[])).push(k),S.emit("error",$,e,a,k.eStak),"unset"==E&&(E=i.readRaw("JS_ERROR_HANDLING")),E){if(E.match(/alert/)){var G="";for(var F in k)k.hasOwnProperty(F)&&(G=G+F+": "+k[F]+"\n");alert(G)}E.match(/console/)&&window.console&&console.error(k)}}},p.getSelectorString=function(r){for(var e=[];r&&"HTML"!=r.tagName&&r!=document;r=r.parentNode){var t=r.tagName;r.id&&(t+="#"+r.id),r.className&&(t+="."+r.className.trim().replace(/\s+/g,".")),e.unshift(t)}return e.join(">")},p.ajaxFailure=function(r,t,o,n){p.record(null,r,null,e.merge({status:t.status},o),n||"ERROR")},p.enableDomReadyParam=function(){O=!0},p.on=S.on.bind(S),p.off=S.off.bind(S),(a.firefox&&a.version<5||a.ie&&a.version<10)&&(p.record=function(){window.console&&console.error("Unreported error: "+[].slice.call(arguments).join(", "))}),o.createNs(p,"ta.util","error"),p});
define("ta/Core/TA.FireEvent",["vanillajs"],function(){var n={},e={};return n.on=function(n,r){var i=e[n];i||(i=e[n]=[]),i.push(r)},n.fireEvent=function(n,r){var i=Array.prototype.slice.call(arguments),t=e[n];i.shift(),t&&t.slice(0).forEach(function(n){try{n.apply(null,i)}catch(n){window.IS_DEBUG&&(console.error||console.log)("Exception in TA.FireEvent handler",n)}})},n.off=function(n,r){if(r){var i,t=e[n];t instanceof Array&&(i=t.indexOf(r),i>=0&&t.splice(i,1))}else delete e[n]},n.hasEventListener=function(n){return!!e[n]},n});
define("ta/Core/TA.Event",["vanillajs","common/trackingStreams","ns-exporter","ta/Core/TA.FireEvent"],function(vanilla,tracks,nsExporter,fireEvent){function _makeClosure(e,t){var n=this;return t=Array.prototype.slice.call(t),function(){e.apply(n,t)}}function QueueTimer(e,t){var n=0,r=0,o=[],a=0,u=!1;this.start=function(){n&&clearTimeout(n),a=Date.now()},this.end=function(i){var c=Date.now(),f=c-a;r+=f;var l=""+f+"ms ["+(i||"")+"]",s=e+(t?"-after":"");u?console.error("Straggler for "+s+": "+l):(o.push(l),n=setTimeout(function(){console.error("Timing for "+s+": "+r+"ms\n"+o.sort(function(e,t){return parseInt(e)-parseInt(t)}).join("\n")),u=!0},2e3))}}var exports={on:fireEvent.on,off:fireEvent.off,fireEvent:fireEvent.fireEvent,hasEventListener:fireEvent.hasEventListener};exports.call=function(e,t,n,r){if(null==t)return IS_DEBUG&&alert("You must pass the event.\n\nUsage:\nta.call('ta.namespace.Class.function', event);"),!1;if(null==e)return IS_DEBUG&&alert("ta.call of undefined function"),!1;var o=e;if("function"==typeof e)e="<func>";else if(!/^ta\.[\w\d\.]+$/.test(e))return IS_DEBUG&&alert("Invalid function name. Must be of the form: ta.namespace.Class.function"),!1;var a=t||window.event;["stopPropagation","preventDefault"].forEach(function(e){a[e]||(a[e]=function(){})}),a.stop||(a.stop=function(){a.preventDefault(),a.stopPropagation()}),n||(n=a.target||a.srcElement),n||tracks.error(null,"ta.call re-wrap fail (non-DOM element) - "+e,t,{"funcName":e});var u=arguments,i=Array.prototype.slice.call(u,3);i.splice(0,0,a,n);try{return i.unshift({callback:_ta_call_defer,evt:a}),i.unshift(o),exports.run.apply(null,i)}catch(n){tracks.error(n,"ta.call - "+e,t)}return!1};var _ta_call_defer=function(e,t){t&&delete t.evt,exports.run.apply(null,arguments)};exports.run=function(e,t){var n=arguments,r=Array.prototype.slice.call(n,2);try{var o=exports.fn(e);if("function"==typeof o){var a=o.apply(window,Array.prototype.slice.call(r));if(t&&t.onComplete){var u=exports.fn(t.onComplete);u&&u(a)}return a}t&&t.evt&&(t.evt.stopPropagation?t.evt.stopPropagation():t.evt.cancelBubble=!0,t.evt.preventDefault?t.evt.preventDefault():t.evt.returnValue=!1);var i=_makeClosure(t&&t.callback||exports.run,arguments);require(["trjs!ta/Core/TA.Load"],function(t){try{t.load(e,i)}catch(t){tracks.error(t,"ta.run - "+e)}})}catch(t){tracks.error(t,"ta.run - "+e)}return!1};var OneTimeFunctionQueue=function(e,t,n){function r(){u=!0,c()}var o,a=[],u=!!n,i=function(n,r){o&&o.start();try{n()}catch(n){try{tracks.error(n,"OneTimeFunctionQueue "+e+(t?"-after":"")+(r?"-"+r:""))}catch(e){}}o&&o.end(r)},c=function(){if(a.sort(function(e,t){return e.priority-t.priority||e.subpriority-t.subpriority}),t){var e=1;a.forEach(function(t){setTimeout(i.bind(null,t.func,t.name),e++)})}else a.forEach(function(e){i(e.func,e.name)});a=[]};null!=e&&(window.addEventListener?window.addEventListener(e,r,!1):window.attachEvent&&("DOMContentLoaded"==e?window.attachEvent("onload",r):"load"==e?window.attachEvent("on"+e,function(){setTimeout(r,1)}):window.attachEvent("on"+e,r))),this.addToQueue=function(t,n,r){return t?("string"==typeof n&&(r=n,n=!1),void(u?i(t,r):(n=n||100+a.length,a.push({func:t,priority:n,name:r,subpriority:a.length})))):void tracks.error(null,"addToQueue for "+e+" queue - no function")},this.executeQueue=function(){c()}},loaded="undefined"!=typeof document&&"complete"===document.readyState,ready="undefined"!=typeof document&&"interactive"===document.readyState||loaded,_readyQ=new OneTimeFunctionQueue("DOMContentLoaded",!1,ready),_loadQ=new OneTimeFunctionQueue("load",!1,loaded),_afterLoadQ=new OneTimeFunctionQueue("load",!0);ready||_loadQ.addToQueue(function(){_readyQ.executeQueue()},-999999999,"checkReadyQueue"),_loadQ.addToQueue(function(){_afterLoadQ.executeQueue()},999999999,"afterLoadQueue"),exports.queueForReady=function(e,t,n){_readyQ.addToQueue(e,t,n)},exports.queueForLoad=function(e,t,n){_loadQ.addToQueue(e,t,n)},exports.queueForAfterLoad=function(e,t){_afterLoadQ.addToQueue(e,0,t)},exports.fn=function(fn){switch(typeof fn){case"function":return fn;case"string":var f=!1;try{f=eval(fn)}catch(e){}if(!f){var ns=fn.split("."),n=ns.pop();try{ns=eval(ns.join(".")),f=ns&&ns._magic&&ns._magic.partial(n)}catch(e){}}if(f&&"function"==typeof f)return f}return null},exports.fireClick=function(e){if(document.createEvent){var t=document.createEvent("MouseEvents");t.initEvent("click",!0,!1),e.dispatchEvent(t)}else document.createEventObject?e.fireEvent("onclick"):"function"==typeof e.onclick&&e.onclick()},exports.throttle=function(e,t,n,r){function o(){delete m_throttles[t],a.cb()}var a,u=(new Date).getTime();if(t in m_throttles){if(a=m_throttles[t],u-a.lastReset<a.minResolution)return void(a.cb=e)}else a=m_throttles[t]={start:u,minResolution:Math.max(Math.floor(n/10),50)};a.cb=e,a.timeout&&clearTimeout(a.timeout),r&&u-a.start>r?o():(a.lastReset=u,a.timeout=setTimeout(o,n))};var m_throttles={};return nsExporter.exportTo(exports,ta),exports});
define("utils/tempFunction",["vanillajs"],function(){var n=0,t="__utils_tempFunction",i={create:function(e,o){var u=t+n++;return window[u]=o?e:function(){e(),i.destroy(u)},u},destroy:function(n){n in window&&0==n.indexOf(t)&&delete window[n]}};return i});
define("ta/util/Load",["vanillajs","ns-exporter","ta/util/Error","ta/Core/TA.Event","ta/Core/TA.Store","ta/Core/TA.Load","utils/resourceLoader","utils/tempFunction"],function(o,a,e,n,t,r,l,i){function u(o,a,n){var i=t.remove("infobox_js");if(i){var u=function(){d.maps(function(){l.load([i,o],a)})};r.load(n,u)||e.record(null,"Rollup file was not found: ",n)}else e.record(null,"'infobox_js' path was not specified for this page")}var c,d={},f=!1,s=!1,p=[];return d.maps=function(o){if(f)o&&o();else{if(!s)return s=!0,ta.maps.load.library(function(){f=!0,s=!1,o&&o(),p.each(function(o){o&&o()})});p.push(o)}},d.mapsLazy=function(o){return n.run("ta.maps.load.library",{},o)},d.loadMapV2Lite=function(o,a){u(a,o,"ta-mapsv2-lite")},d.loadMapV2=function(o,a){u(a,o,"ta-mapsv2")},d.GoogleLoader=function(o){if("loaded"==c)return o();if("loading"==c)return d.GoogleLoader.delay(500,this,o);c="loading";var a=i.create(function(){c="loaded",o&&o(),i.destroy(a)});l.load("//www.google.com/jsapi?callback="+a,{forceType:"js"})},d.LocalSearch=function(o){d.GoogleLoader(function(){google.load("search","1",{callback:function(){}})})},a.exportTo(d,"ta.util.load"),d});
define("ta/util/Deferred",["vanillajs","ns-exporter"],function(e,r){"use strict";function t(e){l.prototype[e]=function(r,t){return i(this,e,t?r.bind(t):r)}}for(var n=["success","failure","always","progress"],u={"resolved":["success","always"],"rejected":["failure","always"]},l=function(){},a=0;a<n.length;a++)t(n[a]);l.prototype.then=function(e,r){var t=this.success(e);return r?t.failure(r):t};var o=function(e){var r="pending",t=new l;t.queue=[],t.args=null,t.aplus="boolean"==typeof e&&e,t.status=function(){return r};var n={notify:function(){if(s(r))throw new Error("Promise has already been fulfilled.");var e,n,u,l=Array.prototype.slice.call(arguments);for(n=0,u=t.queue.length;n<u;n++)e=t.queue[n],"progress"===e.hook&&e.callback.apply(null,l);return t},resolve:function(){if(s(r))throw new Error("Promise has already been fulfilled.");return r="resolved",t.args=Array.prototype.slice.call(arguments),f(t)},reject:function(){if(s(r))throw new Error("Promise has already been fulfilled.");return r="rejected",t.args=Array.prototype.slice.call(arguments),f(t)},isFulfilled:function(){return s(r)},promise:function(){return t}};return n},s=function(e){return"resolved"===e||"rejected"===e},i=function(e,r,t){return e.fwd?i(e.fwd,r,t):(e.queue.push({hook:r,callback:t}),f(e))},f=function(e){if(e.fwd)return f(e.fwd);for(var r,t;s(e.status())&&(r=e.queue.shift());)~u[e.status()].indexOf(r.hook)&&(t=r.callback.apply(null,e.args),t instanceof l?(t.queue=t.queue.concat(e.queue.splice(0)),e=e.fwd=t):t&&e.aplus&&(e.args=[t]));return e};return r.createNs(o,"ta.util","Deferred"),o});
define("ta/util/ajax",["vanillajs","ns-exporter","ta/Core/TA.Record","ta/util/Error","ta/util/Object","ta/util/Deferred"],function(e,t,o,n,a,r){"use strict";function s(e){if("undefined"!=typeof MooTools&&"undefined"!=typeof Request)return new Request(e).send().xhr;var t,o,n=new XMLHttpRequest,a=n.abort.bind(n),r=e.method?e.method.toUpperCase():"GET",s=e.url||"/",c=[];e.withCredentials&&n.withCredentials(!0),n.onreadystatechange=function(){4===this.readyState&&(clearTimeout(t),e.onComplete())},n.abort=function(){a(),e.onCancel()},e.timeout&&(t=setTimeout(function(){a(),e.onTimeout()},e.timeout)),e.data||(e.data={});for(o in e.data)e.data.hasOwnProperty(o)&&null!==e.data[o]&&c.push(o+"="+encodeURIComponent(e.data[o]));/GET/.test(r)&&(s+=(/\?/.test(s)?"&":"?")+c.join("&")),/POST/.test(r)&&(e.headers||(e.headers={}),e.headers["Content-Type"]="application/x-www-form-urlencoded; charset=utf-8"),n.open(r,s);for(o in e.headers)n.setRequestHeader(o,e.headers[o]);return e.onRequest&&e.onRequest.call(n),n.send(/POST/.test(r)?c.join("&"):null),n}var c=function(e){e||(e={});try{if(e.trackEvent){var t=o._toEvtParams(e.trackEvent);e.data=a.merge(e.data||{},t)}}catch(e){n.record(e,"ta.util.ajax.initialize.trackEvent")}var c,u=r(e.aplus),i=function(e){},d=function(e){return e?e.replace(/^\s*while\(1\);\s*/,""):""},l={onComplete:"function"==typeof e.onComplete?e.onComplete:i,onSuccess:"function"==typeof e.onSuccess?e.onSuccess:i,onFailure:"function"==typeof e.onFailure?e.onFailure:i,onReadOnly:e.onReadOnly||i,onRedirect:e.onRedirect||i};return e.onComplete=function(){var t,a=c.getResponseHeader("content-type"),r=e&&e.useContentType;try{if(!r||a.indexOf("application/json")>=0){var s=d(c.responseText);t=JSON.decode?JSON.decode(s):JSON.parse(s)}}catch(e){}t||(t={text:c.responseText}),t.code||(t.code=c.status||0),t.contentType=a;try{e&&e.trackEvent&&o._trackEventAfterAjax(this.options.trackEvent)}catch(e){n.record(e,"ta.util.ajax.onComplete.trackEventAfterAjax")}t.code>=200&&t.code<300?(t.status="ok",u.resolve(t)):301===t.code||302===t.code?(t.status="redirect",u.reject(t)):(t.status||(t.status="error"),u.reject(t))},e.onCancel=function(){u.reject({code:0,status:"abort"})},e.onTimeout=function(){u.reject({code:0,status:"timeout"})},delete e.onLoadStart,delete e.onProgress,delete e.onException,delete e.onSuccess,delete e.onFailure,c=s(e),"function"==typeof e.onRequestCreated&&e.onRequestCreated(c),u.promise().always(function(e){l.onComplete.call(c,e),"redirect"===e.status?l.onRedirect.call(c,e):"readonly"===e.status?l.onReadOnly.call(c,e):~["abort","timeout","error"].indexOf(e.status)?l.onFailure.call(c,e):l.onSuccess.call(c,e)})};return t.createNs(c,"ta.util","ajax"),c});
define("ta/util/ActionRecord",["vanillajs","ta/util/Deferred","utils/ajax","ns-exporter","ta/Core/TA.Record"],function(r,t,e,o,n){function a(r,o,a,i){var c=new t;a||(a={});var u={url:a.url||r,method:a.method||"get",data:{action:o},success:function(r){a.onSuccess&&a.onSuccess(r),c.resolve(r)},error:function(r){a.onFailure&&a.onFailure(r),c.reject(r)}};for(var d in a)if(a.hasOwnProperty(d)&&!u.hasOwnProperty(d))u[d]=a[d];else if("data"==d)for(d in a.data)a.data.hasOwnProperty(d)&&(u.data[d]=a.data[d]);if(i){var s=n._toEvtParams(i);for(d in s)s.hasOwnProperty(d)&&(u.data[d]=s[d])}return e(u),i&&n._trackEventAfterAjax(i),c.promise()}var i={record:function(r,t,e){return a("/ActionRecord",r,t,e)},recordPlus:function(r,t,e){return a("/ActionRecordPlus",r,t,e)},recordPid:function(r){new e("/ActionRecord?pid="+r)}};return o.exportTo(i,"ta.util.action"),i});
define("ta/util/I18N",["vanillajs","ns-exporter"],function(t,n){var e={};return e.isRtl=function(){return document.body&&!!document.body.className.match(/\brtl\b/)},n.exportTo(e,"ta.util.i18n"),e});
define("maps/BasicMapController",["ta/Core/TA.Record"],function(n){"use strict";function o(o,i,t){function e(n){u.eventTrackingName=u.eventTrackingName||"basic_map",v.injectCallbacks({onCenterChanged:n.onPan,onPinClicked:l,onPinHoverStart:n.onPinHoverStart.bind(n),onPinHoverEnd:n.onPinHoverEnd.bind(n),onPinAnimationChanged:c,onPolygonHoverStart:n.onPolygonHoverStart.bind(n),onPolygonHoverEnd:n.onPolygonHoverEnd,onZoomChanged:n.onZoomChange,onInfoWindowShown:n.onInfoWindowShown,onInfoWindowClosed:g,onHoverInfoWindowShown:n.onHoverInfoWindowShown}),P.addUpdateListener(v.onModelUpdated.bind(v))}function r(o,i,t){n.trackEventOnPage(u.eventTrackingName,o,i,t)}function a(n){var o=H;H=n,o>=0&&v.onMarkerHoverEnd(o),n>=0&&P.temporaryHighlight(n)}function d(n,o){}function l(n){u.suppressInfoWindows||h(n)}function c(n){d("onPinAnimationChanged",n)}function g(){u.stickyIconOnClick&&(a(-1),P.lastInfoWindowIDRequested=-1)}function s(n){m&&clearTimeout(m),m=n}function h(n){u.stickyIconOnClick&&a(n),P.requestInfoWindow(n,!1,!0)}function f(n){if(n&&sessionStorage){var o={"max_lon":n.getNE().lng(),"max_lat":n.getNE().lat(),"min_lon":n.getSW().lng(),"min_lat":n.getSW().lat()};sessionStorage.setItem("mapRect",JSON.stringify(o))}}var u=o,v=i,P=t,H=-1,m=null;this.getModel=function(){return P},this.getView=function(){return v},this.getInitialLocation=function(){return u.initLoc},this.trackEvent=r,this.activateHoverHighlightAndInfoWindow=function(n,o,i,t,e,r){var d=v.getHoverInfoWindowMarkerId();if(d!==n){isNaN(parseInt(d))||P.endTemporaryHighlight(d),s(function(){e||(!o&&u.stickyIconOnClick&&a(n),P.requestInfoWindow(n,o,t,r)),s(null)}.delay(250));var l;e&&(l=P.getPolygon(n)),i&&(e?v.highlightPolygon(l):P.temporaryHighlight(n)),e&&v.processPolygonHover(l,t)}},this.onPinHoverStart=function(n,o){d("onPinHoverStart",n),!u.miniInfoWindowOnHover||u.isTabletMaps&&"string"==typeof n&&n.indexOf("dmo")>=0||this.activateHoverHighlightAndInfoWindow(n,!0,!0,!0,!1,o)},this.onPinHoverEnd=function(n){if(H===n)return!1;d("onPinHoverEnd",n),P.endTemporaryHighlight(n),v.closeHoverInfoWindow(n),s(null);var o=P.getHighlightedPolygon();return o&&this.onPolygonHoverStart(o.id),!0},this.onPolygonHoverStart=function(n,o){if(!u.isTabletMaps){var i=P.getPolygon(n);if(i){var t=!P.isActivePolygon(i);this.activateHoverHighlightAndInfoWindow(n,!0,t,!o,!0),P.setHighlightedPolygon(i)}}},this.onPolygonHoverEnd=function(n){var o=P.getPolygon(n);if(o){var i=P.isActivePolygon(o);P.setHighlightedPolygon(null),i||v.unhighlightPolygon(o),v.closeHoverInfoWindow(n)}},this.onInfoWindowShown=function(n){if(n.track&&n.id){u.stickyIconOnClick&&a(n.id);var o=P.getPinType(n.id);o?r("ListView"===n.source?"list_click":"info_window_click",o):r("neighborhood_polygon","selected",n.id)}},this.onHoverInfoWindowShown=function(n){if(n.track){var o=P.getPinType(n.id);if(o)return void r("info_window_hover",o);var i=P.getPolygon(n.id);if(i)return void r("neighborhood_polygon","hovered");r("info_window_hover","")}},this.onZoomChange=function(n){var o=n.bounds;f(o),P.getZoom()!==n.zoom&&(P.setZoom(n.zoom),n.center&&P.setCenter(n.center,!1),P.updateBasedOnCurrentState())},this.onPan=function(n){function o(n,o){return Math.round(n*Math.pow(10,o))/Math.pow(10,o)}var i=n.center,t=n.bounds;f(t);var e=P.mapCenter();o(i.lat(),6)===o(e.lat(),6)&&o(i.lng(),6)===o(e.lng(),6)||(P.setCenter(i,!0),P.updateBasedOnCurrentState(),r("map_pan","",0))},this.fireModelUpdate=function(){P.updateBasedOnCurrentState(null,null,!0)},this.addPin=function(n,o,i){var t={id:n.locId,latLng:new ta.maps.util.GeoPoint(n.lat,n.lng),poiType:o,item:n};P.addPin(t.id,i?"home":o,t)},this.removePin=function(n){P.removePin(n)},this.eachPin=function(n){P.eachPin(n)},this.zoomAndPanToFitLocations=function(n,o,i){v.zoomAndPanToFitLocations(n,o,i)},e(this)}return o});
define("maps/Pins",["utils/objutils","vanillajs"],function(n){"use strict";function t(){function t(){return n.keys(h).length}function i(n){return!!e(n)}function e(n){return h[n]}function u(){return n.shallowCopy(h)}function s(n,t){h[n]=t}function r(n){var t=e(n);return t&&delete h[n],t}function o(t){var i=[];return n.each(h,function(n,e){e.poiType===t&&(i.push(n),r(n))}),i}function c(t){n.each(h,t)}var h={};this.count=t,this.hasPin=i,this.getPin=e,this.getPins=u,this.addPin=s,this.removePin=r,this.removePinsByType=o,this.each=c}return t});
define("maps/BasicMapModel",["maps/Pins"],function(t){"use strict";function n(){function n(t,n){r.each(function(i){try{i(t,n)}catch(t){ta.util.error.record(t,"highlight update listener crashed")}})}function e(t){n(t,!0),this.getAccumulatedUpdatesForWrite().hoverIconOn.push(t),this.commitUpdatesAndNotifyListeners()}function o(t){n(t,!1),this.getAccumulatedUpdatesForWrite().hoverIconOff.push(t),this.commitUpdatesAndNotifyListeners()}var s=[],r=[],h={additions:[],removals:[],changes:[],hide:[],show:[],hoverIconOn:[],hoverIconOff:[],setZ:[],newPolygons:[],hidePolygons:[],showPolygons:[]},u=null,a=null,c=null,d=null,l=0,f=0,g=null,m=-1,p=0,v=new Hash({}),P=new t,y=new Hash({}),w=null,L=null;this.addHighlightListener=function(t){r.push(t)},this.addUpdateListener=function(t){s.push(t)},this.removeUpdateListener=function(t){var n=s.indexOf(t);n>=0&&s.splice(n,1)},this.addUpdateListenerOnce=function(t){if("function"==typeof t){var n=this,i=function(){window.setTimeout(n.removeUpdateListener.bind(n,i),0),t()};this.addUpdateListener(i)}},this.commitUpdatesAndNotifyListeners=function(){var t=h;s.each(function(n){try{n(t)}catch(t){ta.util.error.record(t,"model update listener crashed")}}),this.resetAccumulatedUpdates()},this.resetAccumulatedUpdates=function(){h.additions.length=0,h.removals.length=0,h.changes.length=0,h.hide.length=0,h.show.length=0,h.hoverIconOff.length=0,h.hoverIconOn.length=0,h.setZ.length=0,h.infoWindowData=null,h.zoom=null,h.center=null,h.infoWindowClose=!1,h.fitLocations=null,h.options=!1,h.deactivatedPolygon=null,h.activatedPolygon=null,h.newPolygons.length=0,h.showPolygons.length=0,h.hidePolygons.length=0},this.getAccumulatedUpdatesForWrite=function(){return h},this.addPin=function(t,n,i){var e={id:t,type:n,data:i};P.addPin(t,e),h.additions.push(e),v.get(n)===!1&&h.hide.push(t)},this.getPin=function(t){return P.getPin(t)},this.getPins=function(){return P.getPins()},this.getPinData=function(t){var n=this.getPin(t);return n&&n.data},this.getHomePinData=function(){var t=null,n=[];return this.eachPin(function(t,i,e){"home"===i&&n.push(e)}),n&&n.length>0&&n.some(function(n){return!n.item.type&&(t=n,!0)}),t||(t=n[0]),t},this.getPinType=function(t){var n=this.getPin(t);return n&&n.type},this.removePin=function(t){P.removePin(t),h.removals.push(t)},this.removePinsByType=function(t){var n=P.removePinsByType(t);for(var i in n)n.hasOwnProperty(i)&&h.removals.push(i)},this.eachPin=function(t){P.each(function(n,i){return t(i.id,i.type,i.data)})},this.getPinCount=function(){return P.count()},this.hasVisiblePOIPins=function(){var t=!1,n=this;return this.eachPin(function(i,e){return t="home"!==e&&n.isVisible(e),!t}),t},this.addPolygon=function(t){y.set(t.id,t),h.newPolygons.push(t),this.isVisible("neighborhood")?h.showPolygons.push(t.id):h.hidePolygons.push(t.id)},this.getPolygon=function(t){return y.get(t)},this.getActivePolygon=function(){return w},this.isActivePolygon=function(t){return t&&w&&w.id===t.id},this.setActivePolygon=function(t){t?w&&w.id===t.id||(h.deactivatedPolygon=w,h.activatedPolygon=t,w=t):w&&(h.deactivatedPolygon=w,w=null)},this.setHighlightedPolygon=function(t){L=t},this.getHighlightedPolygon=function(){return L},this.isLastWindowIDRequested=function(t){return t===m},this.requestInfoWindow=function(t,n,i,e,o){var s=this,r=this.getPinData(t);if(r){p=t;var u=function(o){r.updatedTS=(new Date).getTime(),n?r.hoverInfoWindowContent=o:(m=t,r.infoWindowContent=o),h.infoWindowClose||(h.infoWindowData={id:t,mini:n,contents:o,item:r.item,track:i,nonInteractive:e},s.commitUpdatesAndNotifyListeners())};n&&r.hoverInfoWindowContent&&!o?u(r.hoverInfoWindowContent):(u(JS_loading),this.ensureInfoWindowContent(r,n,u))}},this.ensureInfoWindowContent=function(t,n,i){if(t.item.customHover.content)return void i(t.item.customHover.content);var e=t.item.customHover.url;if(e){var o=ta.util.URL.parse(e);if(ta.has("mapProviderFeature.maps_api")){var s=ta.retrieve("mapProviderFeature.maps_api");o+="&mapProviderFeature="+s}o+=n?"&infoType=miniHover":"&infoType=infoV2";var r=this.getHomePinData();r&&(o+="&homePin="+r.item.locId);var h=function(n){p==t.id&&i(n)}.bind(this);new Request({url:o,onSuccess:h}).get()}else if(t.item.customHover.title){var u=t.item.customHover.title.replace(/, /,"<br/>");i("<div class='nfoLeftList'><div class='hvrTtl'>"+u+"</div></div>")}else ta.util.error.record("cannot display hover for pin ","ensureInfoWindowContent",t)},this.updateBasedOnCurrentState=function(){this.commitUpdatesAndNotifyListeners()},this.toQueryString=function(){return"mc="+this.mapCenter().toUrlValue()+"&mz="+this.getZoom()+"&mw="+this.mapWidth()+"&mh="+this.mapHeight()},this.setZoom=function(t){t&&t!==d&&(d=t,h.zoom=t,null==c&&(c=t))},this.resetZoom=function(){this.setZoom(c||i)},this.resetCenter=function(){this.setCenter(u,!0)},this.setCenter=function(t,n){null!=t&&(a=t,n&&(h.center=t),null==u&&(u=t))},this.setOriginalCenter=function(t){u=t},this.zoomToFitLocation=function(t,n,i){h.fitLocations={pan:t,center:n,geoPoint:i}},this.setWidthHeight=function(t,n){f=n,l=t},this.getZoom=function(){return d},this.mapWidth=function(){return l},this.mapHeight=function(){return f},this.mapCenter=function(){return a},this.setMapType=function(t){t&&t!==g&&(g=t,h.mapMode=t,this.commitUpdatesAndNotifyListeners())},this.temporaryHighlight=function(t){var n=this;window.setTimeout(function(){var i=n.getPin(t);i&&e.bind(n)(i)},0)},this.endTemporaryHighlight=function(t){var n=this;window.setTimeout(function(){var i=n.getPin(t);i&&o.bind(n)(i)},0)},this.toggleTypeVisibility=function(t,n){var i=this.isVisible(t);if(i!==n){if(v.set(t,!i),"neighborhood"===t){var e=n?h.showPolygons:h.hidePolygons;y.each(function(t){e.push(t.id)})}else{var o=n?h.show:h.hide;this.eachPin(function(i,e){e===t&&(o.push(i),n||i!==m||(h.infoWindowClose=!0))})}this.commitUpdatesAndNotifyListeners()}},this.isVisible=function(t){return v.get(t)!==!1}}var i=14;return n});
define("maps/Filters",["ta/Core/TA.Store","utils/objutils","vanillajs"],function(t,e){"use strict";function i(){function i(e,i){v=null,m=i,d=e.filtersType;var a=d&&("Hotels"!==d||"Hotels"!==m||"cat_1"===t.retrieve("sel.category"));a?(h=!0,"Attractions"===d&&(v={cat:t.has("mapsv2.attractions_map_filter_category")?t.retrieve("mapsv2.attractions_map_filter_category"):0},t.has("mapsv2.attractions_map_filter_zfn")&&(v.zfn=t.retrieve("mapsv2.attractions_map_filter_zfn")))):h=!1}function a(t){v=t}function r(t){if(t.cb&&delete t.cb,t.hasOwnProperty("pid")){for(var e=Number(t.pid),i=[],a=0;a<4;a++){var r=1<<a;(e&r)===r&&(1===a||2===a?i.contains(12)||i.push(12):i.push(a))}t.pid=i.join(",")}v=t}function n(){return h}function s(){return n()}function l(e,i){var a=s(),r="get",n=null;i?(r=h&&v?"post":"get",n=o()):a&&(r=a?"post":"get",h?(!v||t.has("mapsv2.attractions_map_filter_category")&&v.cat==t.retrieve("mapsv2.attractions_map_filter_category")||t.has("mapsv2.attractions_map_filter_zfn")&&v.zfn==t.retrieve("mapsv2.attractions_map_filter_zfn")||(e.options.url+="&rewrite_filter=true"),n=o()):n=null),e.setOptions({method:r,data:n})}function o(){var t=u();if(t&&t.pid){var e=0;t.pid.split(",").each(function(t){t=parseInt(t);do e|=1<<t%10,t=Math.floor(t/10);while(t>0)}),t.pid=e}return t}function c(){return g}function f(e,i){if(v)if(g=(new Date).getTime(),"zff"===e)v[e]===i?v[e]=0:v[e]=i;else if("Attractions"===d&&"cat"===e)v[e]==i?v[e]=t.retrieve("mapsv2.attractions_map_filter_category_all"):v[e]=i;else if(v[e]){var a=v[e],r=a.split?a.split(","):[a];r.contains(i)?r.erase(i):r.include(i),r.length>0?v[e]=r.join(","):delete v[e]}else v[e]=i}function p(){if(v){g=(new Date).getTime();var e=v.cat,i=v.showUnavailable,a=v.zfn;v={},"Hotels"===m?(v.cat=e,v.showUnavailable=i):"Attractions"===m&&(v.cat=t.retrieve("mapsv2.attractions_map_filter_category_all"),v.zfn=a)}}function u(){return e.deepCopy(v)}function _(t){var i=[],a=t||v;return e.each(a,function(t,a){a&&(a.split?e.each(a.split(","),function(e,a){i.push(t+" "+a)}):i.push(t+" "+a))}),i}var h=!1,v={},m="",d="",g=0;this.setup=i,this.setFilterState=a,this.update=r,this.isOldFiltersEnabled=n,this.isEnabled=s,this.getFilterChangedTS=c,this.getFilters=u,this.toggleFilter=f,this.clearFilters=p,this.getTags=_,this.buildRequest=l}return i});
define("ta/util/Date",["vanillajs","ns-exporter"],function(e,t){var n={};return n.MS_IN_DAY=864e5,n.DAYS_IN_MONTH=[31,28,31,30,31,30,31,31,30,31,30,31],n.HOUR_CONST=12,n.THAI_BUDDHIST_YEAR_OFFSET=543,n.MAX_STAY_DURATION_DAYS=30,n.MAX_VR_DURATION_DAYS=183,n.MAX_DAYS_BEFORE_RETURN_FLIGHT=330,n.MAX_ATTRACTION_RANGE_DAYS=330,n.inDateSet=function(e,t){if(null==e||null==t)return!1;for(var n=t.length,r=0;r<n;r++){var a=t[r];if(a.length){var i=a[0].getTime(),T=a[1].getTime();if(i<=e.getTime()&&T>=e.getTime())return!0}else if(e.getTime()==a.getTime())return!0}return!1},n.rangesIntersect=function(e,t){return Math.max(e[0].getTime(),t[0].getTime())<=Math.min(e[1].getTime(),t[1].getTime())},n.getDaysInRange=function(e,t){return Math.round((t.getTime()-e.getTime())/n.MS_IN_DAY)+1},n.getLastDayOfMonth=function(e){var t=new Date;return e&&(t=new Date(e.getTime())),t=new Date(n.normalize(t)),t.setDate(1),t.setMonth(t.getMonth()+1),t.setDate(0),t.getDate()},n.getDaysApart=function(e,t){var n=864e5;return e&&t?Math.round(Math.abs((e.getTime()-t.getTime())/n)):0},n.inSameMonth=function(e,t){return null!=e&&null!=t&&e.getMonth()==t.getMonth()&&e.getYear()==t.getYear()},n.normalize=function(e){return e.setHours(n.HOUR_CONST,0,0,0)},n.create=function(e,t,r){return new Date(e,t,r,n.HOUR_CONST)},t.exportTo(n,"ta.util.date"),n});
define("ta/util/LegacyDateShim",["vanillajs","api-mod","ns-exporter","ta/util/Error","ta/Core/TA.Event","utils/ajax","ta/Core/TA.Store","ta/util/Date"],function(e,t,a,r,n,s,o,l){function i(){return ta.page&&ta.page.hasDates&&ta.page.hasDates("STAYDATES")}function u(){return ta.page&&ta.page.hasDates&&ta.page.hasDates("ROUNDTRIP")}function d(e){var t=ta.page.datesToQueryJson(e||"STAYDATES");if(o.has("guests_rooms_picker.enabled")){var a=ta.page.guests.toJson();for(var r in a)t[r]=a[r]}else t.adults=f();return t}function c(){var e=ta.page.guests.toJson();return e.guests=e.adults,delete e.adults,e}function g(){return ta.page&&ta.page.getDates&&ta.page.getDates("CHECKIN")[0]||void 0}function p(){return ta.page&&ta.page.getDates&&ta.page.getDates("CHECKOUT")[0]||void 0}function D(){if(!i())return!1;var e=ta.widgets.calendar.getPageInDate(),t=ta.widgets.calendar.getPageOutDate(),a=Math.round(Math.abs((e.getTime()-t.getTime())/l.MS_IN_DAY));return a>=1&&a<=l.MAX_STAY_DURATION_DAYS}function f(){var e=2;return ta.page.guests?e=ta.page.guests.getAdults():o.has("multiDP.adultsCount")&&(e=o.retrieve("multiDP.adultsCount"),o.store("date.picker.adultsCount",e)),e}function v(e){return"classic"===e&&"undefined"!=typeof DATE_PICKER_CLASSIC_FORMAT?DATE_PICKER_CLASSIC_FORMAT:"short"===e&&"undefined"!=typeof DATE_PICKER_SHORT_FORMAT?DATE_PICKER_SHORT_FORMAT:"undefined"!=typeof DATE_PICKER_META_FORMAT?DATE_PICKER_META_FORMAT:("string"!=typeof e&&(e="not_a_string"),"")}function h(){var e="no dates";try{var t=v("classic");i()&&(e=ta.widgets.calendar.dateToString(ta.widgets.calendar.getPageInDate(),t),e=e+" - "+ta.widgets.calendar.dateToString(ta.widgets.calendar.getPageOutDate(),t))}catch(e){}return e}function E(e,t){var a,r,n,s,i,u,d,c,g;return e&&e.getDate&&t?t==v("classic")?(a=new Date(e),o.retrieve("thai_buddhist_era_year")&&a.setFullYear(a.getFullYear()+l.THAI_BUDDHIST_YEAR_OFFSET),r="MM",n="yyyy",s="dd",c=a.getDate()+"",t.indexOf("dd")!=-1?c&&1===c.length&&(c="0"+c):s="d",g=a.getMonth()+1+"",t.indexOf("MM")!=-1?g&&1===g.length&&(g="0"+g):r="M",t=t.replace(r,g).replace(s,c).replace(n,a.getFullYear()).replace(/'/g,"")):t==v("short")?(a=new Date(e),r="MM",s="dd",c=a.getDate()+"",c&&1==c.length&&(c="0"+c),g=a.getMonth()+1+"",g&&1==g.length&&(g="0"+g),t=t.replace(r,g).replace(s,c).replace(/'/g,"")):(i=o.retrieve("multiDP.abbrevMonthList"),u=e.getDay(),o.retrieve("multiDP.isMondayFirstDayOfWeek")&&(u-=1),u==-1&&(u=6),d="EEE",r="MMM","EEEE d MMMM"==t&&(d="EEEE",r="MMMM"),t=t.replace(d,jsGlobalDaysAbbrev[u]).replace(r,i[e.getMonth()]).replace(/\bd\b/,e.getDate()).replace(/'/g,"")):""}function T(){try{var e=g(),t=p(),a=f();if(!e||!t||!a)return null;var n=e.getDate(),s=e.getMonth()+1,o=e.getFullYear(),l=t.getDate(),i=t.getMonth()+1,u=t.getFullYear(),d={"inDay":n,"inMonth":s+" "+o,"outDay":l,"outMonth":i+" "+u,"adults":a};return d}catch(e){return r.record(e,"Unable to create calendar date args object"),null}}function y(){ta.page&&ta.page.processNewTravelInfo&&ta.page.processNewTravelInfo()}function C(e,t,a){return t&&!i()?void(e&&"function"==typeof e&&e()):(s({url:"/UpdateSessionDatesAjax",data:d(),method:"post",async:a!==!0,success:function(){"function"==typeof e&&e(),n.fireEvent("hotels.sessionDatesUpdated")}}),!0)}function M(e){ta.page.gatherDatesNear(e),!window.event||window.event.target!==e&&window.event.currentTarget!==e||t.stopEvent(window.event)}function _(e){if(e){e=JSON.decode(e);var t=e.url;o.retrieve("is_from_sdprospect")&&t.contains("Hotels")&&(t=t.replace("Hotels","SmartDeals")),window.location=t}else window.location="/Hotels"}function m(){var e,t,a,r=null;if(ta.page.hasDates("CHECKIN")){e=document.querySelectorAll(".meta_date_field.first .date_picker.date"),a=null;for(var n=0;n<e.length;++n)t=e[n].firstChild,t&&3==t.nodeType&&(r=r||v("classic"),a=a||E(ta.page.getDates("CHECKIN")[0],r),t.nodeValue=a)}if(ta.page.hasDates("CHECKOUT")){e=document.querySelectorAll(".meta_date_field .out_date .date_picker.date"),a=null;for(var n=0;n<e.length;++n)t=e[n].firstChild,t&&3==t.nodeType&&(r=r||v("classic"),a=a||E(ta.page.getDates("CHECKOUT")[0],r),t.nodeValue=a)}}function A(e,t,a){var r="date.picker.calendarflyout",n=o.retrieve(r);n||(n=[]);var s={};s.elmt=e,s.overlay=t,s.overlaySrc=a,n.push(s),o.store(r,n),o.remove("date.picker.calendarflyout.allCleared")}function w(){var e="date.picker.calendarflyout",t=o.retrieve(e);t&&(t.forEach(function(e){var t=e.elmt,a=e.overlay,r=e.overlaySrc;t&&a&&r&&(t.removeEventListener("mouseenter",a.showWithDelay),t.removeEventListener("mouseleave",a.hideWithDelay),t.removeEventListener("mouseenter",a.show),t.removeEventListener("mouseleave",a.hide),t.removeEventListener("click",a._pin),t.appendChild(r))}),o.store("date.picker.calendarflyout.allCleared",!0))}function S(){t.select(".roomsButton .grp-rooms-value").forEach(function(e){e.innerHTML=ta.page.guests.getRooms()}),t.select(".guestsButton .grp-guests-value").forEach(function(e){e.innerHTML=ta.page.guests.getAdults()}),ta.widgets.calendar.syncAllDatePickers()}function R(){}if(ta.widgets&&ta.widgets.calendar&&ta.widgets.calendar.hasPageDates)return ta.widgets.calendar;var P={hasPageDates:i,hasRoundTripDates:u,datesExist:i,datesInRange:D,getCheckRatesData:d,getDateArgsObject:T,getGuestsRoomsPickerData:c,updateGuestsRoomsPickerDataFromCookie:R,updateGuestsRoomsPickerUI:R,getPageInDate:g,getPageOutDate:p,getPageAdultsCount:f,getDatePickerFormat:v,getErrorDates:h,dateToString:E,checkDatesMakeHacCallHR:y,justUpdateSessionDates:C,setErrorStyling:M,redirectToHotelOverview:_,updateLegacyDatePickers:m,trackCalendarEvent:R,closeCalendarWidgets:R,handleNewDates:R,syncAllDatePickers:R,trackCRButtonClick:R,clearCalendarFlyouts:w,trackCalendarFlyout:A,removeMetaCalendarFromSync:R,updateAllGuestsRoomsButtons:S,isShim:!0};return a.exportTo(P,"ta.widgets.calendar"),P});
define("ta/commerce/MetaPolling",["vanillajs","ns-exporter","ta/Core/TA.Store"],function(e,t,n){var l={setPollingAttemptForRequest:function(e,t){var n=l.getPollingMap();t||(t=1),n[e]=t,l.setPollingMap(n)},getPollingAttemptForRequest:function(e){if(l.isRequestBeingPolled(e)){var t=l.getPollingMap(),n=t[e];if(n)return n}},getPollingWaitTimeForRequest:function(e){var t=l.getPollingAttemptForRequest(e);return l.getPollWaitTimeForPollingAttempt(t)},isRequestBeingPolled:function(e){var t=l.getPollingMap(),n=e&&t[e];return!!n},incrementPollingAttemptForRequest:function(e){var t=l.getPollingMap(),n=t[e];return n&&(n+=1,t[e]=n),l.setPollingMap(t),n},clearAllPollingInfo:function(){n.store("ta.meta.polling.map")},removePollingInfoForRequest:function(e){if(l.isRequestBeingPolled(e)){var t=l.getPollingMap();delete t[e],l.setPollingMap(t)}},getPollingMap:function(){var e=n.retrieve("ta.meta.polling.map");return e||(e={},n.store("ta.meta.polling.map",e)),e},setPollingMap:function(e){e&&n.store("ta.meta.polling.map",e)},getPollWaitTimeForPollingAttempt:function(e){if("number"!==typeOf(e)||e<0)return 1e3;switch(e){case 1:case 2:case 3:case 4:return 1e3;case 5:case 6:case 7:return 1500;case 8:case 9:case 10:return 2e3;case 11:return 5e3;case 12:return 15e3;default:return 3e4}},getMaxPollingAttemptNumber:function(){return 13}};return t.exportTo(l,"ta.commerce.meta.polling"),l});
define("maps/POIMapModel",["maps/BasicMapModel","maps/Pins","maps/Filters","ta/Core/TA.Store","ta/Core/TA.Record","ta/Core/TA.Event","ta/util/Error","ta/util/LegacyDateShim","ta/commerce/MetaPolling"],function(e,t,i,n,r,s,a,o,u){"use strict";function l(l,I,b){function F(e,t){var i=!1,e=J;if(e.length===t.length){for(var n=0;n<e.length;n++)if(e[n]!==t[n]){i=!0;break}}else i=!0;return i}function A(e,t){var i;i=t?y:e.data.zIndex,M.getAccumulatedUpdatesForWrite().setZ.push({id:e.id,zIndex:i})}function S(e,t){if(!k||"STAYDATES"===t){var i=this;Q=!0,o.justUpdateSessionDates(function(){i.updateBasedOnCurrentState(),se.each(function(e){e()}),k&&w&&w.id&&require.defined("ta/commerce/MetaJson")&&require("ta/commerce/MetaJson").refetchAll()},!0)}}function T(e){M.addHighlightListener(A),E.noDates||(k?require("ta/page").on("dateSelected",S.bind(e)):s.on("onCalendarRangeSelect",S.bind(e)))}this.Z_INDEX_HOME=6e3,this.Z_INDEX_SELECTED=6e3,this.Z_INDEX_DMO=5e3;var C,O,L,R,U,Z,D,M=new e,q=l.pinSelectionApproach||"original",V=!0,w=null,W=!1,H=I,E=l,B=b,N={},_=!1,x=null,k=require.defined("ta/page")&&require("ta/page").usingUnifiedDates,G=!0,z=new t,j=new i,Q=!1,J=[],X=[{name:"hotel",baseZ:m,pid:1099,titlePID:1098},{name:"restaurant",baseZ:p,pid:1100,titlePID:1098},{name:"attraction",baseZ:g,pid:1101,titlePID:1098},{name:"vacationrental",baseZ:f,pid:1102,titlePID:1098},{name:"home",baseZ:this.Z_INDEX_HOME},{name:"neighborhood"}],Y=[],K=[],$=[],ee=[],te=[],ie=[],ne=[],re=[],se=[];this.addUpdateStartListener=function(e){Y.push(e)},this.addUpdateEndListener=function(e){K.push(e)},this.addUpdateListener=function(e){M.addUpdateListener(e)},this.addUpdateListenerOnce=function(e){M.addUpdateListenerOnce(e)},this.addPinUpdateListener=function(e){$.push(e)},this.addMetaRequestListener=function(e){ee.push(e)},this.addMetaUpdateListener=function(e){te.push(e)},this.addHotelSortChangeListener=function(e){ie.push(e)},this.addZoomedOutTooFarListener=function(e){ne.push(e)},this.addZoomedWithinLimitListener=function(e){re.push(e)},this.addOnDateChangeListener=function(e){se.push(e)},this.getServlet=function(){return H},this.getOriginalLocId=function(){return N.locId},this.getLocationId=function(){return B},this.getOrigOps=function(){return N},this.setOrigOps=function(e){N=e,M.getAccumulatedUpdatesForWrite().options=e},this.isInsightProfile=function(){return _},this.isUsingUnifiedDates=function(){return k},this.addPinFromItem=function(e,t,i,n,r,s,a,o){var u="hotel"===t,l=M.getPinType(e.locId);s=s||0,i&&i.erase(e.locId);var d=M.getPinData(e.locId),c="",h="",f=!1,g=!1,p="vacationrental"===t;if(u&&(c=this.getAvailabilityForPin(e.locId),h=this.getGeoForPin(e.locId),f=!d||d.availability!==c,g=!d||d.inCurrentGeo!==h),a||!l||l!==t||!d||d.item.pinProminent!==e.pinProminent||f||g||p){r=r||this.getBaseZIndexByType(t),e.pinProminent&&(r+=v);var m={latLng:new ta.maps.util.GeoPoint(e.lat,e.lng),name:"",id:e.locId,item:e,baseZIndex:r,relZIndex:s,zIndex:r+s,poiType:t};return u&&(m.inCurrentGeo=h,m.availability=c),p&&Z&&Z[e.locId]&&(m.vrMinRateDisplay=Z[e.locId].minRateDisplay),n?z.addPin(e.locId,m):this.addPin(e.locId,t,m),o&&(M.getAccumulatedUpdatesForWrite().additions.push({id:m.id,type:m.poiType,data:m}),this.commitUpdatesAndNotifyListeners()),m}},this.addPin=function(e,t,i){M.addPin(e,t,i),G||"unavailable"!==this.getAvailabilityForPin(e)||M.getAccumulatedUpdatesForWrite().hide.push(e)},this.getBaseZIndexByType=function(e){if(0===e.indexOf("sponsor_"))return P;for(var t in X)if(X[t].name===e)return X[t].baseZ;return 0},this.updateBasedOnCurrentState=function(e,t,i){i="undefined"!=typeof i&&i,C&&(clearTimeout(C),C=null);var r=M.getZoom();if(E.lowerZoomLimit&&r&&r<=E.lowerZoomLimit)return void ne.each(function(e){e()});re.each(function(e){e()});var s=null,o=[];if(!t){var l=(new Date).getTime();t="poiMapRequest_"+l+"_cancel"}if(n.retrieve(t)===!0)return void n.remove(t);if(n.has(d)){var c=n.retrieve(d);c!==t&&this.cancelPOIMapCurrentQuery()}n.has(t)||(n.store(t,!1),n.store(d,t));var h=!1;if(u.isRequestBeingPolled(t)){if(h=u.getPollingAttemptForRequest(t),!h||h>u.getMaxPollingAttemptNumber())return void u.removePollingInfoForRequest(t)}else h=1,u.setPollingAttemptForRequest(t,h);var f=V;f?(V=!1,s=this.requestReset):s=this.requestUpdate;var g=1===h,p=this.includeMetaInRequest(g),m=[{"name":"finalRequest","value":g||V?"false":"true"},{"name":"includeMeta","value":p},{"name":"trackPageView","value":i}],v=[];w&&"hotel"===w.poiType&&v.push(w.id),N.userPoi&&"hotel"===N.userPoi.type&&v.push(N.userPoi.locId),v.length>0&&m.push({"name":"addMeta","value":v.join()}),E.preferredIds&&(f&&m.push({"name":"centerOnLocs","value":"true"}),m.push({"name":"locs","value":E.preferredIds.join(",")})),n.has("roadtrip.specificLocations")&&(f&&m.push({"name":"centerOnLocs","value":"true"}),m.push({"name":"specificLocations","value":n.retrieve("roadtrip.specificLocations").join(",")}),n.has("roadtrip.paramSponsoredHotels")&&m.push({"name":"specificSponsors","value":n.retrieve("roadtrip.paramSponsoredHotels")}));var P=this.getRequestCompleteProcessor(t,e,g),y=this.onComplete.bind(this);o.push(function(e){try{P(e)}catch(e){a.record(e,"Unable to process model update")}y()}),o.push(m);var I=j.getFilters();(!g||Q&&I&&!I.hasOwnProperty("p"))&&o.push(!0),Q=!1,s.apply(this,o),g&&n.has("mapsv2.listView")&&ee.each(function(e){e()})},this.cancelPOIMapCurrentQuery=function(){if(n.has(d)){var e=n.remove(d);n.store(e,!0),u.removePollingInfoForRequest(e)}},this.addPolygon=function(e){return M.addPolygon(e)},this.getPolygon=function(e){return M.getPolygon(e)},this.getActivePolygon=function(){return M.getActivePolygon()},this.isActivePolygon=function(e){return M.isActivePolygon(e)},this.setActivePolygon=function(e){return M.setActivePolygon(e)},this.setHighlightedPolygon=function(e){return M.setHighlightedPolygon(e)},this.getHighlightedPolygon=function(){return M.getHighlightedPolygon()},this.setWidthHeight=function(e,t){return M.setWidthHeight(e,t)},this.mapCenter=function(){return M.mapCenter()},this.setCenter=function(e,t){return M.setCenter(e,t)},this.getZoom=function(){return M.getZoom()},this.setZoom=function(e){return M.setZoom(e)},this.setLowerZoomLimit=function(e){E.lowerZoomLimit=e},this.resetZoom=function(){return M.resetZoom()},this.getPins=function(){return M.getPins()},this.getStickyPins=function(){return z.getPins()},this.getPinType=function(e){return M.getPinType(e)},this.getPinData=function(e){return M.getPinData(e)},this.getHomePinData=function(){return M.getHomePinData()},this.setSelectedPin=function(e){w=e},this.getSelectedPin=function(){return w},this.removePin=function(e){M.removePin(e),z.removePin(e)},this.buildRequest=function(e,t,i,n){var r=q||"original",s=document.getElement("#EATERY_NEW_TAGS .newTag.selected"),a=s?s.getAttribute("data-itags"):null,o=s?s.getAttribute("data-etags"):null;return new Request({url:getBaseMapsUrl(e,this.getGeoId(),this.getServlet(),!0)+"&"+M.toQueryString()+"&pinSel="+r+"&origLocId="+N.locId+(a?"&itags="+a:"")+(o?"&etags="+o:""),method:i,onSuccess:t,onFailure:n})},this.onComplete=function(){K.each(function(e){e()})},this.requestReset=function(e,t){if(0!==M.mapWidth()&&0!==M.mapHeight()){var i=this.buildRequest("display",e,"get",this.onComplete.bind(this));j.buildRequest(i,!0),t&&t.each(function(e){i.options.url+="&"+e.name+"="+e.value}),i.send(),Y.each(function(e){e()})}},this.requestUpdate=function(e,t,i){if(0!==M.mapWidth()&&0!==M.mapHeight()){W&&(i=!0);var n=this.buildRequest("update",e,"get",this.onComplete.bind(this));t&&t.each(function(e){n.options.url+="&"+e.name+"="+e.value}),j.buildRequest(n,!1),n.send(),i||Y.each(function(e){e()})}},this.getRequestCompleteProcessor=function(e,t){var i=this;return function(r){if(n.retrieve(e)===!0)return void n.remove(e);var s=null;try{s=JSON.parse(r)}catch(e){return void a.record(e,"Unable to parse location data JSON.")}s.metaInfo&&i.setMetaInfo(s.metaInfo,e),s.hacSortOrder&&i.setHotelSortOrder(s.hacSortOrder),i.setVRACInfo(s.vracInfo);var o=new Hash({});M.eachPin(function(e){o.set(e,null)});var u=n.retrieve("mapsv2.markerOverrides")||{};X.each(function(e){var t=s[e.name+"s"];t&&s[e.name+"s"].each(function(t){u[t.locId]&&(t=Object.merge(t,u[t.locId])),z.hasPin(t.locId)||(t.pid=e.pid,t.titlePID=e.titlePID,i.addPinFromItem(t,e.name,o,!1,e.baseZ))},i)},i);var l,d=i.getStickyPins();s.sponsorVisible&&Object.each(s.sponsorsAll,function(e,t){e.each(function(e){if(!w||w.id!==e.locId){var n=t;l=z.getPin(e.locId),l&&(n=l.poiType,e.isLodging=l.item.isLodging,delete d[e.locId]),i.addPinFromItem(e,n,o,!1,P,0,!0)}})});for(var c in d)d.hasOwnProperty(c)&&(l=d[c],i.addPinFromItem(l.item,l.poiType,o,!1,l.baseZIndex,l.relZ,!0),M.getAccumulatedUpdatesForWrite().show.push(c));o.each(function(e,t){i.removePin(t)});var h=[];M.eachPin(function(e){h.push(e)}),h.sort();for(var f=0;f<h.length;f++){var g=M.getPinData(h[f]);g.relZIndex=f+1,g.zIndex=g.baseZIndex+g.relZIndex,M.getAccumulatedUpdatesForWrite().setZ.push({id:h[f],zIndex:g.zIndex})}M.setZoom(s.zoom),s.addressInfo&&i.setAddressInfo(s.addressInfo),s.filterState&&(j.update(s.filterState),M.getAccumulatedUpdatesForWrite().filterStateChanged=i.getFilters()),s.insightProfile&&i.setInsightProfile(s.insightProfile),i.setVRAmenityFilters(s.vrAmenities?s.vrAmenities:null),i.setVRNeighborhoodFilters(s.vrNeighborhoods?s.vrNeighborhoods:null),i.setVRPriceFilters(s.vrPrices?s.vrPrices:null),i.setVRBedroomFilters(s.vrBedrooms?s.vrBedrooms:null),i.commitUpdatesAndNotifyListeners(),s.sponsorLocationIds&&n.store("ta.maps.locsBySponsor",s.sponsorLocationIds),$.each(function(e){e({allPins:i.getPins(),stickyPins:i.getStickyPins()})}),t&&t()}},this.metaDataChanged=function(){var e=!0,t="";return M.eachPin(function(e){var i=M.getPinData(e);if(i&&"hotel"===i.poiType&&O){var n=O[e];n&&(t+=e+":"+n.status+",")}}),x&&x===t?e=!1:(x=t,e=!0),e},this.handlePollingForMeta=function(e,t){if(t)this.cancelPOIMapCurrentQuery();else{var i=this.updateBasedOnCurrentState.bind(this,!1,e);C=setTimeout(i,u.getPollingWaitTimeForRequest(e)),u.incrementPollingAttemptForRequest(e)}},this.hasVisiblePOIPins=function(){return M.hasVisiblePOIPins()},this.pinDataOutdated=function(e){var t=j?j.getFilterChangedTS():0;return e&&(!e.updatedTS||t&&e.updatedTS<=t)},this.temporaryHighlight=function(e){return M.temporaryHighlight(e)},this.endTemporaryHighlight=function(e){return M.endTemporaryHighlight(e)},this.removePinsByType=function(e,t){M.removePinsByType(e),t&&z.removePinsByType(e)},this.setAllTypesVisible=function(){var e=this;X.each(function(t){e.toggleTypeVisibility(t.name,!0)},this)},this.setAllTypesInvisible=function(){var e=this;X.each(function(t){e.toggleTypeVisibility(t.name,!1)},this)},this.toggleTypeVisibility=function(e,t){return M.toggleTypeVisibility(e,t)},this.toggleUnavailPinVisibility=function(e){G=!e;var t=M.getAccumulatedUpdatesForWrite(),i=e?t.hide:t.show;M.eachPin(function(n,r,s){"hotel"===r&&s&&s.availability&&"unavailable"===s.availability&&(i.push(n),e&&(t.infoWindowClose=!0))},this),this.commitUpdatesAndNotifyListeners()},this.isVisible=function(e){return M.isVisible(e)},this.commitUpdatesAndNotifyListeners=function(){return M.commitUpdatesAndNotifyListeners()},this.setAddressInfo=function(e){null!=e&&e.name===e.name&&e.dirClick===e.dirClick&&e.address===e.address||(e=e,M.getAccumulatedUpdatesForWrite().addressChanged=e)},this.getFilters=function(){return j.getFilters()},this.toggleFilter=function(e,t){j.toggleFilter(e,t),M.getAccumulatedUpdatesForWrite().filterStateChanged=this.getFilters()},this.clearFilters=function(){j.clearFilters(),M.getAccumulatedUpdatesForWrite().filterStateChanged=this.getFilters(),r.trackEventOnPage("Filters_Map","unselect","ClearAll")},this.setInsightProfile=function(e){var t=e.a,i={};if(t)if("3"==e.v){var r=null;t.each(function(e){if(isNaN(parseInt(e)))r=e;else if(null!=r){var t=i[r];null==t?i[r]=""+e:i[r]+=","+e}})}else if("4"==e.v)for(var s=0;s<t.length;s+=4)if(s+3<t.length){var a=t[s],o=t[s+1],u=t[s+2];if(1===u){var l=i[a];null==l?i[a]=""+o:i[a]+=","+o}}n.store("ta.p13n.tagsWithSave",j.getTags(i)),j.setFilterState(i),_=!0,M.getAccumulatedUpdatesForWrite().filterStateChanged=this.getFilters()},this.setMetaInfo=function(e,t){O=e;var i=!0,r=!0;if(O)for(var s in O)if(O.hasOwnProperty(s)){var a=O[s];a&&"partial"===a.status&&(i=!1),a&&"empty"!==a.status&&(r=!1)}i=i&&!r,(n.has("mapsv2.listView")||n.has("mapsv2.listViewRoadtrip"))&&(this.handlePollingForMeta.call(this,t,i),this.metaDataChanged()&&te.each(function(e){e()}))},this.getVRACInfo=function(){return Z},this.setVRACInfo=function(e){Z=e},this.setVRAmenityFilters=function(e){D||(D={}),D.amenity=e},this.setVRNeighborhoodFilters=function(e){D||(D={}),D.zfb=e},this.setVRPriceFilters=function(e){D||(D={}),D.price=e},this.setVRBedroomFilters=function(e){D||(D={}),D.beds=e},this.getVRSelectedFilters=function(){return D},this.getMetaInfo=function(){return O},this.getAvailabilityForPin=function(e){if(O){var t=O[e];if(t)return"empty"===t.status?"unavailable":"partial"===t.status?"available":t.availCount?"available":"unavailable"}return"available"},this.getGeoForPin=function(e){if(O){var t=O[e];if(t)return t.inCurrentGeo?"inCurrentGeo":"notInCurrentGeo"}},this.getHotelSortOrder=function(){return J},this.setHotelSortOrder=function(e){J&&!F(J,e)||(J=e,ie.each(function(e){e(J)}))},this.resetAccumulatedUpdates=function(){M.resetAccumulatedUpdates(),M.getAccumulatedUpdatesForWrite().addressChanged=null,M.getAccumulatedUpdatesForWrite().filterStateChanged=null},this.getInvisibleTypes=function(){var e=[];return X.each(function(t){M.isVisible(t.name)||e.push(t.name)},this),e},this.requestInfoWindow=function(e,t,i,n){var r=M.getPinData(e);(t||"home"!==M.getPinType(e)||r.isEatery||r.isAttraction||r.isLodging)&&M.requestInfoWindow(e,t,i,n,r&&this.pinDataOutdated(r))},this.setupFilters=function(e){j.setup(e,this.getServlet())},this.isFiltersEnabled=function(){return j.isEnabled()},this.isOldFiltersEnabled=function(){return j.isOldFiltersEnabled()},this.includeMetaInRequest=function(e){if(n.retrieve("mapsv2.map_is_on_vr"))return!1;var t=!0;if(o.hasPageDates()&&N.allowMeta){if(e){var i=(new Date).getTime(),r=this.getLatestMetaSignature();if(L){if(L!==r&&R){var s=i-R;s<c&&(t=!1,this.setupRepollForMeta(i))}}else L=r;t&&(R=i)}}else t=!1;return t},this.setupRepollForMeta=function(e){U&&clearTimeout(U),U=setTimeout(this.attemptMetaRequestAfterTimeout.bind(this),this.getTimeTilTimeoutUp(e))},this.attemptMetaRequestAfterTimeout=function(){this.getLatestMetaSignature()!==L&&this.updateBasedOnCurrentState()},this.getTimeTilTimeoutUp=function(e){return R&&c?c-(e-R)+h:1},this.getLatestMetaSignature=function(){var e=M.toQueryString().replace(/&/g,",");return e+=","+Object.toQueryString(o.getCheckRatesData())},this.setZoomInitialized=function(){V=!1},this.setInitialLoadDone=function(e){V=!e},this.setOriginalCenter=function(e){return M.setOriginalCenter(e)},this.resetToOriginalCenterAndZoom=function(){V=!0,M.resetZoom(),M.resetCenter()},this.getGeoId=function(){return N.geoId||B},T(this)}var d="poiMap_curCancelKey",c=5e3,h=1e3,f=1e3,g=2e3,p=3e3,m=4e3,v=4e3,P=5e3,y=12e3;return l});
define("maps/utils/icons",["ta/Core/TA.Store","ta/util/Error"],function(n,o){"use strict";var _={home:["_v2_CurrentCenter.png","_v2_CurrentCenter.png","_v2_CurrentCenter.png"],home_address:["SearchCustom.png","SearchCustom.png","SearchCustom.png"],home_hotel:["SearchHotel.png","SearchHotel.png","SearchHotel.png"],home_restaurant:["SearchRestaurant.png","SearchRestaurant.png","SearchRestaurant.png"],home_attraction:["SearchAttraction.png","SearchAttraction.png","SearchAttraction.png"],home_vacationrental:["SearchVR_teal.png","SearchVR_teal.png","SearchVR_teal.png"],home_airport:["_v2_CurrentCenter.png","_v2_CurrentCenter.png","_v2_CurrentCenter.png"],home_roadtrip:["RoadTripDestination.png","RoadTripDestination.png","RoadTripDestination.png"],hotel:["_sm_Hotel.png","_v4_Hotel.png","_lg_Hotel.png"],restaurant:["_sm_Restaurant.png","_v4_Restaurant.png","_lg_Restaurant.png"],attraction:["_sm_ThingToDo.png","_v4_ThingToDo.png","_lg_ThingToDo.png"],vacationrental:["_sm_Rental_teal.png","_v4_Rental_teal.png","_lg_Rental_teal.png"],dmo:"_v2_DMO.png",dd_hotel:["_lg_dd_Hotels.png","_lg_dd_Hotels.png","_lg_dd_Hotels.png"],dd_restaurant:["_lg_dd_Restaurant.png","_lg_dd_Restaurant.png","_lg_dd_Restaurant.png"],dd_attraction:["_lg_dd_Attractions.png","_lg_dd_Attractions.png","_lg_dd_Attractions.png"],dd_tour:["_lg_dd_Tours.png","_lg_dd_Tours.png","_lg_dd_Tours.png"],dd_hotel_yellow:["_lg_dd_yellow_Hotel.png","_lg_dd_yellow_Hotel.png","_lg_dd_yellow_Hotel.png"],dd_restaurant_yellow:["_lg_dd_yellow_Restaurant.png","_lg_dd_yellow_Restaurant.png","_lg_dd_yellow_Restaurant.png"],dd_attraction_yellow:["_lg_dd_yellow_Attraction.png","_lg_dd_yellow_Attraction.png","_lg_dd_yellow_Attraction.png"],dd_tour_yellow:["_v2_lg_dd_yellow_Tour.png","_v2_lg_dd_yellow_Tour.png","_v2_lg_dd_yellow_Tour.png"],dd_geo:["_lg_dd_Geo.png","_lg_dd_Geo.png","_lg_dd_Geo.png"],sponsor_BEST_WESTERN:"_sponsor_BestWestern2.png",sponsor_BEST_WESTERN_CA:"_sponsor_BestWestern2.png",sponsor_HAMPTON_INN:"_sponsor_HamptonInn.png",sponsor_HAMPTON_INN_CA:"_sponsor_HamptonInn.png",sponsor_COMFORT_INN:"_sponsor_CI.png",sponsor_ECONO_LODGE:"SponsorEL",sponsor_QUALITY_INN:"_sponsor_QICA.png",sponsor_SLEEP_INN:"_sponsor_sleep_inn_2.png",sponsor_COMFORT_SUITES:"_sponsor_CZ.png",sponsor_OUTBACK_RESTAURANT:"SponsorOB",sponsor_COMFORT_INN_CA:"_sponsor_CICA.png",sponsor_QUALITY_INN_CA:"_sponsor_QICA.png",sponsor_HOLIDAY_INN:"SponsorHolidayInn",sponsor_SUPER_8_CA:"_sponsor_Super8CA.png",sponsor_RAMADA_CA:"_sponsor_RamadaCA.png",sponsor_COMFORT_FAMILY:"_sponsor_CICA.png",sponsor_roadtrip3_ascend2:"_sponsor_roadtrip3_ascend2.png",sponsor_roadtrip3_cambria:"_sponsor_roadtrip3_cambria.png",sponsor_roadtrip3_clarion:"_sponsor_roadtrip3_clarion.png",sponsor_roadtrip3_comfortinn:"_sponsor_roadtrip3_comfortinn.png",sponsor_roadtrip3_comfortsuites:"_sponsor_roadtrip3_comfortsuites.png",sponsor_roadtrip3_comfortca:"_sponsor_roadtrip3_comfortca.png",sponsor_roadtrip3_econolodge:"_sponsor_roadtrip3_econolodge.png",sponsor_roadtrip3_mainstay:"_sponsor_roadtrip3_mainstay.png",sponsor_roadtrip3_rodeway:"_sponsor_roadtrip3_rodeway.png",sponsor_roadtrip3_quality:"_sponsor_roadtrip3_quality.png",sponsor_roadtrip3_sleepinn:"_sponsor_roadtrip3_sleepinn.png",sponsor_roadtrip3_suburban:"_sponsor_roadtrip3_suburban.png",disneyHotel:"DisneyHotel",disneyRestaurant:"DisneyRestaurant",disneyAttraction:"DisneyAttraction"},r={iconPrefix:n.retrieve("tablet_maps_v1")?"/img2/maps/icons/tablet/pin":"/img2/maps/icons/pin",iconHoverSuffix:"Over",iconUnavailSuffix:"-unavail",defaultIconExt:".gif"},t=function(n,o,_){return function(t){return n in o&&t in _?_[t]:r[t]}},p=function(r,p,e,s,a,i,g){if(i=i||{},i.iconPath&&"home"!==e)return s&&i.hoverIconPath?i.hoverIconPath:i.iconPath;var d="home"===e&&i.type?e+"_"+i.type:e,l=r?r[d]:void 0;if(l=l||_[d],!l)return o.record("Cannot setup pin icon: unknown pin type "+d,"ta.mapsv2.icons.generateIconPath"),window.cdnHost+"img2/x.gif";n.retrieve("tablet_maps_v1")&&s&&(a=0);var c,u=t(d,r,p),m="string"==typeof l?l:l[a],v=m.split(".");v.length>1?(m=v[0],c="."+v[1]):c=u("defaultIconExt");var h="";return 0===e.indexOf("sponsor_")&&i.type?c="_box_over.png":(s&&(h+=u("iconHoverSuffix")),"unavailable"===g&&(h+=u("iconUnavailSuffix"))),window.cdnHost+u("iconPrefix")+m+h+c};return{generateIconPath:function(o,_,r,t,e,s,a){var i={};return 2==s&&(a={hotel:["h_sm","h","h"],restaurant:["r_sm","r","r"],attraction:["a_sm","a","a"],vacationrental:["vr_sm","vr","vr"]},i={iconPrefix:n.retrieve("tablet_maps_v1")?"/img2/maps/icons/tablet/pin_v5_":"/img2/maps/icons/pin_v5_",iconHoverSuffix:"_sel",iconUnavailSuffix:"_unav",defaultIconExt:".png"}),p(a,i,o,_,r,t,e)}}});
define("maps/BasicMapView",["maps/utils/icons"],function(n){"use strict";function o(o,p,v){function g(n){z.eventTrackingName||(z.eventTrackingName="dynamic_large_map"),z.zoomControls&&z.zoomControls.addEvent("click",u),z.typeControls&&z.typeControls.each(function(n){n.addEvent("click",h)}),O=w.bind(n)}function u(){var n=this.hasClass("zoomOut");ta.trackEventOnPage("embedded_dynamic_map","zoom",n?"out":"in"),n?T.zoomOut():T.zoomIn()}function h(){var n=this.hasClass("hyb")?"hyb":"map";this.removeClass("disabled"),this.addClass("enabled"),this.getSiblings().removeClass("enabled"),this.getSiblings().addClass("disabled"),ta.trackEventOnPage(z.eventTrackingName,"set_map_type","hyb"===n?"satellite":n),T.setMapMode(n)}function w(){var n=arguments[0];L&&L[n]&&L[n].apply(this,Array.prototype.slice.call(arguments,1))}function y(){var n,o,e,t=ta.retrieve("mapStartTime");"undefined"!=typeof t&&(n=(new Date).getTime(),o=n-t,e=ta.retrieve("mapProviderFeature.maps_api"),ta.trackEventOnPage("dynamic_large_map","map_load_time_span",e,o),ta.remove("mapStartTime"))}function P(n){if(!R){R=!0;var o={initialLocation:z.center,initialZoom:z.zoom,container:D,reuseHoverDivs:z.reuseHoverDivs,disableDefaultMapControl:z.disableDefaultMapControl,searchBar:z.searchBar,disableMapStyling:z.disableMapStyling,enableScrollwheel:!z.isManualZoom,draggable:!z.isManualZoom||z.draggable,alignBottom:z.isTabletMaps,longTouch:z.isTabletMaps,useTabletPins:z.isTabletMaps,pinnedMapCenter:z.pinnedMapCenter,showMapDashboard:z.showMapDashboard,onTilesLoaded:function(){if(L.onTilesLoaded&&L.onTilesLoaded(),z.isTabletMaps){var n=document.getElement(".dmoLabelContainer");n&&n.addEvent("click",H)}},onPinClick:function(o){w.call(n,"onPinClicked",o),z.isTabletMaps&&n.closeHoverInfoWindow(o),crPageServlet&&"Hotels"===crPageServlet&&ta.trackEventOnPage("dynamic_large_map","pin_click","",o)},onMapClick:function(){if(document.getElements(".tablet_desktop .mapsv2-card").addClass("mapsv2-cardcollapsed"),crPageServlet&&"Attractions"===crPageServlet){var n=document.getElement(".tablet_desktop .map-filter-overlay .map-filter-overlay-close");n&&n.fireEvent("click")}var o=document.getElement(".tablet_desktop #MAP_ADD_LOCATION_INPUT");o&&o.blur()},onPinHoverStart:function(o,e){w.call(n,"onPinHoverStart",o,e)},onPinHoverEnd:function(o){n.onMarkerHoverEnd(o)},onPinAnimationChanged:function(o){w.call(n,"onPinAnimationChanged",o)},onZoomChanged:function(){return A?void(A=!1):(O("onZoomChanged",{zoom:T.getZoom(),center:T.getCenter(),bounds:T.getBounds()}),void ta.fireEvent("onZoomChanged"))},onCenterChanged:function(){return A?void(A=!1):(O("onCenterChanged",{center:T.getCenter(),bounds:T.getBounds()}),void ta.fireEvent("onCenterChanged"))},onPanStart:function(){O("onPanStart")},onHoverInfoWindowDOMReady:function(){O("onInfoWindowDOMReady")},onHoverInfoWindowHoverStart:function(n){O("onHoverInfoWindowHoverStart",n)},onInfoWindowClosed:function(n){O("onInfoWindowClosed",n)},onInfoWindowRendered:function(n){O("onInfoWindowRendered",n)},onHoverInfoWindowRendered:function(n){O("onHoverInfoWindowRendered",n)},onHoverInfoWindowHoverEnd:function(n){O("onHoverInfoWindowHoverEnd",n)},onStreetViewStatusChange:function(o){n.onStreetViewStatusChange(o)},onPolygonHoverStart:function(n){O("onPolygonHoverStart",n)},onPolygonHoverEnd:function(n){O("onPolygonHoverEnd",n)},onPolygonClicked:function(n){O("onPolygonClicked",n)},onload:function(){y(),L&&L.onload&&L.onload()}};T.setupMap(o)}}function b(n,o){var e=n||new Element("div",{html:o});e.hide(),e.inject(D.getParent());var t=e.getDimensions();return n&&e.show(),e.dispose(),t}function I(o){return o.data.vrMinRateDisplay?{url:n.generateIconPath(o.type,!0,o.data.pinSizeOption,o.data.item,o.data.availability,z.iconVer,m),labelOrigin:new google.maps.Point(28,18)}:null}function M(o,e){var t=o.data,i=n.generateIconPath(o.type,!1,t.pinSizeOption,t.item,t.availability,z.iconVer,m),a={url:i,labelOrigin:new google.maps.Point(28,18)};z.isTabletMaps&&(a.scaledSize=new google.maps.Size(60,41),a.labelOrigin=new google.maps.Point(30,18)),e.complexIcon=a;var s=t.vrMinRateDisplay+"+";e.label={"text":s,"color":"white","fontFamily":"Arial","fontSize":Math.min(14,80/s.length)+"px","fontWeight":"bold"}}function C(){W&&(clearTimeout(W.deferred),W=null)}function S(n,o){E===JS_loading&&o.contents!==JS_loading&&T.closeHoverInfoWindow(o.id);var e="js_hoverInfo";o.item.hoverClass&&(e+=" "+o.item.hoverClass);var t=new Element("div",{"class":e});o.item.useStyleguide&&t.addClass("ui_tooltip");var i=new Element("div",{"class":"hvrData","html":o.contents});if(o.item.startsOpen&&o.nonInteractive&&o.contents!==JS_loading){var a=new Element("div",{"class":"close"});a.addEvent("click",function(){T.closeHoverInfoWindow(o.id),ta.trackEventOnPage("dynamic_large_map","Close_Info_Window")}),i.adopt(a)}E=o.contents,t.adopt(i);var s=b(t,null),r=10;o.item.pinProminent&&(r+=5);var d=-s.y/2;if(z.dynamicHoverPosition){var l=D.getSize(),c=T.getMarkerPixelPosition(o.id),f=new Element("div",{"class":"gm-style","style":"position: absolute"});f.adopt(t),s=b(f,null),d=0,c.x+r+s.x>l.x?r=l.x-s.x-c.x-15:c.x+r<0&&(r=-c.x),c.y+s.y>l.y&&(d=-s.y-33)}z.isTabletMaps&&(o.item.pinProminent||(r+=5),r=-(5*r)),o.item.customHover&&("undefined"!=typeof o.item.customHover.yOffset&&(d=+o.item.customHover.yOffset-16),"undefined"!=typeof o.item.customHover.xOffset&&(r=+o.item.customHover.xOffset));var m={pixelOffset:{width:r,height:d},boxClass:o.item.customHover&&o.item.customHover.boxClass||"js_hoverInfoContainer",boxSize:s,alignBottom:!1};window.behavior&&window.behavior.apply(i),o.contents===JS_loading?W={"id":o.id,"deferred":function(){T.renderHoverInfoWindow(o.id,t,m),n.onHoverInfoWindowShown(o.item,o.id,!1,t)}.delay(200)}:(C(),T.renderHoverInfoWindow(o.id,t,m),n.onHoverInfoWindowShown(o.item,o.id,o.track,t))}function _(n,o){if(!(z.isTabletMaps&&o.contents===JS_loading&&o.id&&"string"==typeof o.id&&o.id.indexOf("dmo")>=0)){E===JS_loading&&o.contents!==JS_loading?n.closeHoverInfoWindow(o.id):o.mini||n.closeHoverInfoWindow();var e=new Element("div",{"class":["js_pinnedNfo",o.contents===JS_loading?"loading":""].join(" ")}),t=new Element("div",{"class":"hvrData","html":o.contents});E=o.contents;var i;if(o.item.useStyleguide){e.addClass("ui_popover"),o.item.tooltipPosition&&e.addClass("arrow_"+o.item.tooltipPosition),o.item.useStyleguide&&(o.item.tooltipPosition&&e.adopt(new Element("div",{"class":"arrow"})),e.adopt(new Element("div",{"class":"ui_close_x small",style:"pointer-events:none"}))),e.adopt(t);var a=new Element("div",{"class":"js_pinnedNfoContainer","style":"position: absolute"});a.adopt(e);var s=b(a,null);i={boxClass:"js_pinnedNfoContainer",boxSize:{x:s.x,y:s.y},pixelOffset:{width:-s.x/2,height:10},position:T.locationMarkers[o.id].getPosition(),closeBoxMargin:"0; position: absolute; height: 36px; width: 36px;"+(ta.util.i18n.isRtl()?"left:0;":"right:0;"),closeBoxURL:window.cdnHost+"/img2/x.gif",infoBoxClearance:{width:1,height:0}}}else{e.adopt(t);var r={x:422,y:145},d="/img2/maps/icons/button_infowindow_close.png",l="12px; position: absolute; right:0px";z.isTabletMaps&&(d="/img2/buttons/icon_X_gray_2x.png",l="0; position: absolute; right:0px; padding: 12px",r={x:446,y:145}),t.getElement(".travelTimes")&&(r.y=165),o.item.type?r.y+=28:o.item.pinProminent&&(r.y+=12);var c=-r.x/2,f=-r.y-40;i={pixelOffset:{width:c,height:f},boxClass:"js_pinnedNfoContainer",boxSize:r,closeBoxMargin:l,closeBoxURL:window.cdnHost+d}}window.behavior&&window.behavior.apply(t),T.renderInfoWindow(o.id,e,i),n.onInfoWindowShown(o.item,o.id,o.contents!==JS_loading&&o.track,e)}}function H(){var n=function(n,o){var e=document.getElements(n);if(e)for(var t=0;t<e.length;++t){var i=e[t].getElementsByTagName("img");if(i&&i[0]&&i[0].getAttribute("src")===o)return e[t]}},o=n(".gmnoprint","/img2/maps/icons/tablet/pin_v2_DMO.png");if(o){var e=document.createEvent("MouseEvents");e.initEvent("click",!1,!0),o.dispatchEvent(e)}}function x(){return T.getInfoWindowMarkerId()}function k(n){n&&T.updatePolygonOptions(n.id,ta.api.maps.styles.activePolygon)}var W,E,O,T=o,z=v,D=p,L=z.callbacks||{},R=!1,A=!1;this.onModelUpdated=function(o){P(this);var m=!1,p=this;o.center&&T.panToLocation(o.center),o.fitLocations&&(o.fitLocations.pan?T.zoomAndPanToFitLocations([o.fitLocations.center,o.fitLocations.geoPoint]):T.zoomToFitLocation(o.fitLocations.center,o.fitLocations.geoPoint)),Array.each(o.removals,function(n){T.removeMarkerFromMap(n),m=!0}),o.zoom&&T.setZoom(o.zoom),Array.each(o.additions,function(o){m=!0;var p=o.data,v=t,g=c,u=f;p.item.pinProminent?"home"===o.type?(g=c,u=f):(v=i,g=d,u=l):p.item.pinProminent===!1&&(v=e,g=s,u=r),p.pinSizeOption=v;var h={name:p.name,id:o.id,dispId:o.id,position:p.latLng,image:w,size:v};z.isTabletMaps&&(h.width=g,h.height=u),z.isCnTripPlanMap&&(h.size=a);var w=n.generateIconPath(o.type,!1,p.pinSizeOption,p.item,p.availability,z.iconVer,{}),y=p.item.animate;p.vrMinRateDisplay&&M(o,h);var P=T.constructMarkerDef(p.latLng,p.name,w,h,p.zIndex,y);T.addMarkerFromMarkerDef(P)}),o.mapMode&&T.setMapMode(o.mapMode),o.infoWindowClose&&this.closeInfoWindow(),o.infoWindowData&&(o.infoWindowData.mini?x()!==o.infoWindowData.id&&S(p,o.infoWindowData):_(p,o.infoWindowData)),o.hide.each(function(n){T.toggleMarkerVisibility(n,!1),m=!0},this),o.show.each(function(n){T.toggleMarkerVisibility(n,!0),m=!0},this),z.isTabletMaps||(o.hoverIconOn.each(function(o){if(o){var e=I(o)||n.generateIconPath(o.type,!0,o.data.pinSizeOption,o.data.item,o.data.availability,z.iconVer,{});T.setIcon(o.id,e,!0)}},this),o.hoverIconOff.each(function(n){n&&T.resetIconFromBackup(n.id)},this)),o.setZ.each(function(n){T.setZIndex(n.id,n.zIndex)},this),o.newPolygons.each(function(n){this.addPolygon(n,!1)},this),o.hidePolygons.each(function(n){T.updatePolygonOptions(n,{"visible":!1})},this),o.showPolygons.each(function(n){T.updatePolygonOptions(n,{"visible":!0})},this),o.activatedPolygon&&k(o.activatedPolygon),o.deactivatedPolygon&&this.unhighlightPolygon(o.deactivatedPolygon,!1),m&&require.defined("maps/performanceMetrics")&&require("maps/performanceMetrics").pinsComplete(),T.onceOnFinishedDrawing(function(){O("onUpdateFinished")})},this.processPolygonHover=function(n,o){C();var e=new Element("div"),t=new Element("div",{"class":"sprite-neighborhoodIcon"});e.adopt(t);var i=new Element("div",{"text":n.name,"class":"nhood-name"});e.adopt(i);var a={boxClass:"polygon-hover",closeBoxURL:"",alignBottom:!0,pixelOffset:{width:0,height:0}},s=this;W={"id":n.id,"deferred":function(){T.renderHoverInfoWindowAtPosition(n.id,n.center,e,a),s.onHoverInfoWindowShown(n,n.id,o)}.delay(300)}},this.onMarkerHoverEnd=function(n){O("onPinHoverEnd",n)},this.closeHoverInfoWindow=function(n){n&&T.getHoverInfoWindowMarkerId()!==n||T.closeHoverInfoWindow(),!W||n&&W.id!==n||C()},this.closeInfoWindow=function(){T.closeInfoWindow()},this.getHoverInfoWindowMarkerId=function(){return T.getHoverInfoWindowMarkerId()},this.onHoverInfoWindowShown=function(n,o,e,t){O("onHoverInfoWindowShown",{id:o,track:e,container:t})},this.onInfoWindowShown=function(n,o,e,t,i){O("onInfoWindowShown",{id:o,track:e,container:t,source:i})},this.informOfResize=function(){T.informOfResize()},this.onStreetViewStatusChange=function(n){O("onStreetViewStatusChange",n)},this.closeStreetView=function(){T.closeStreetView()},this.addPolygon=function(n,o){n&&n.coordinates&&(n.center=T.addPolygon(n.id,n.coordinates,o?ta.api.maps.styles.activePolygon:ta.api.maps.styles.idlePolygon))},this.highlightPolygon=function(n){n&&T.updatePolygonOptions(n.id,ta.api.maps.styles.highlightedPolygon)},this.unhighlightPolygon=function(n){n&&T.updatePolygonOptions(n.id,ta.api.maps.styles.idlePolygon)},this.getProviderMap=function(){return T&&T.map},this.renderRoute=function(n,o,e,t,i,a){return T.renderRoute(n,o,e,t,i,a)},this.zoomAndPanToFitLocations=function(n,o,e,t){A=t,P(this),T.zoomAndPanToFitLocations(n,e,o)},this.zoomToFitLocations=function(n,o,e,t){A=t,P(this),T.zoomToFitLocation(n,o,e)},this.zoomAndPanToFitAllMarkers=function(){T.zoomAndPanToFitAllMarkers()},this.injectCallbacks=function(n){L=Object.merge(L,n)},g(this)}var e=0,t=1,i=2,a=102,s=23,r=23.5,d=41,l=41.5,c=45,f=60,m={vacationrental:["_sm_callout_Rental.png","_sm_callout_Rental.png","_sm_callout_Rental.png"]};return o});
define("maps/POIMapView",["maps/BasicMapView"],function(e){"use strict";function n(n,t,o){function i(e){u.disableDefaultMapControl=!0;var n=d.getParent(".inner_poi_map");if(n){var t=u.lowerZoomLimit,o=n.getElement(".resetZoomBox");o&&o.addEvent("click",function(){c.setZoom(t+1),c.options.onZoomChanged()});var i,r=n.getElement(".no_pins_flyout");r&&(i=r.getElement(".close_x"),i.addEvent("click",function(){r.hide()}));var s=n.getElement(".sponsorDeck .arrowTab"),a=n.getElements(".sponsorDeck .chkSet"),l=function(){var e=document.getElement(".sponsorDeck");e&&!e.hasClass("closed")?(e.removeClass("expanded"),e.addClass("closed")):e&&e.hasClass("closed")&&(e.addClass("expanded"),e.removeClass("closed"))},g=function(){var e=document.getElement(".sponsorDeck");!this.hasClass("cur")&&e&&e.hasClass("closed")&&(e.addClass("expanded"),e.removeClass("closed"))};if(s&&s.addEvent("click",l),a)for(var h=a.length,f=0;f<h;++f)a[f].addEvent("click",g);var p=n.getElement(".noSponsoredPinsFlyout");p&&(i=p.getElement(".close_x"),i.addEvent("click",function(){p.hide()})),e.stopSpinners();var v=n.getElement(".close-street-view");v&&v.addEvent("click",function(e){e.stopPropagation(),c.closeStreetView()})}}function r(e,n,t,o){h&&h(e,n,t,o)}function s(e,n,t,o,i){g&&g(e,n,t,o,i)}function a(e){f&&f(e),ta.trackEventOnPage("dynamic_large_map","street_view",e?"open":"close",0);var n=d.getParent(".inner_poi_map");n&&(n.getElements(".uicontrol").toggleClass("hidden",e),n.getElement(".close-street-view").toggleClass("hidden",!e))}var l=new e(n,t,o),c=n,d=t,u=o,g=null,h=null,f=null;this.startSpinners=function(){if(d){var e=d.getParent(".inner_poi_map");e&&(e.getElement(".spinner-centering-wrap").style.display="")}},this.stopSpinners=function(){if(d){var e=d.getParent(".inner_poi_map");e&&(e.getElement(".spinner-centering-wrap").style.display="none")}},this.showMapZoomExcessBox=function(){if(d){var e=d.getParent(".inner_poi_map");if(e){var n=e.getElement(".zoomExcessBox");n&&(n.style.display="block")}}},this.hideMapZoomExcessBox=function(){if(d){var e=d.getParent(".inner_poi_map");if(e){var n=e.getElement(".zoomExcessBox");n&&(n.style.display="none")}}},this.updateSponsorFlyout=function(){var e=document.getElement(".noSponsoredPinsFlyout"),n=ta.retrieve("ta.maps.locsBySponsor"),t=ta.retrieve("sponsor.shortName"),o=ta.retrieve("sponsor.name"),i=!0;ta.has("toggledSponsorshipShort")&&(t=ta.retrieve("toggledSponsorshipShort"),o=ta.retrieve("toggledSponsorship"),i=ta.retrieve("addSponsorship"));var r=document.getElement(".sponsor_"+o);if(e){r&&e.getElement(".flyoutContent").set("text",r.get("data-no-hotels"));var s=n&&t&&i&&(!n[t]||0===n[t].length);e.toggleClass("hidden",!s)}},this.initProviderOptions=function(e){return c.reinitMapOptions(e)},this.getProviderZoom=function(){return c.getZoom()},this.getProviderCenter=function(){return c.getCenter()},this.getProviderMap=function(){return c&&c.map},this.panProviderToLocation=function(e,n,t){return c.panToLocation(e,n,t)},this.triggerProviderHover=function(e,n){return c.triggerHover(e,n)},this.triggerProviderBlur=function(e){return c.triggerBlur(e)},this.isProviderMarkerInView=function(e){return c.isMarkerInView(e)},this.getProviderMarkerPixelPosition=function(e){return c?c.getMarkerPixelPosition(e):null},this.getProviderLocationMarker=function(e){return c.locationMarkers[e]},this.getProviderTravelTime=function(e,n,t,o,i,r){return c.getTravelTime(e,n,t,o,i,r)},this.renderRoute=function(e,n,t,o,i,r){return c.renderRoute(e,n,t,o,i,r)},this.onStreetViewStatusChange=function(e){l.onStreetViewStatusChange(e),ta.trackEventOnPage("dynamic_large_map","street_view",e?"open":"close",0);var n=d.getParent(".inner_poi_map");n&&(n.getElements(".uicontrol").toggleClass("hidden",e),n.getElement(".close-street-view").toggleClass("hidden",!e))},this.onHoverInfoWindowShown=function(e,n,t,o){l.onHoverInfoWindowShown(e,n,t,o)},this.onInfoWindowShown=function(e,n,t,o,i){l.onInfoWindowShown(e,n,t,o,i)},this.onModelUpdated=function(e){l.onModelUpdated(e)},this.onMarkerHoverEnd=function(e){l.onMarkerHoverEnd(e)},this.zoomAndPanToFitLocations=function(e,n,t,o){return l.zoomAndPanToFitLocations(e,n,t,o)},this.zoomToFitLocations=function(e,n,t,o){return l.zoomToFitLocations(e,n,t,o)},this.informOfResize=function(){return l.informOfResize()},this.closeHoverInfoWindow=function(e){return l.closeHoverInfoWindow(e)},this.closeInfoWindow=function(){return l.closeInfoWindow()},this.closeStreetView=function(){return l.closeStreetView()},this.getHoverInfoWindowMarkerId=function(){return l.getHoverInfoWindowMarkerId()},this.highlightPolygon=function(e){return l.highlightPolygon(e)},this.unhighlightPolygon=function(e){return l.unhighlightPolygon(e)},this.processPolygonHover=function(e,n){return l.processPolygonHover(e,n)},this.injectCallbacks=function(e){return h=e.onHoverInfoWindowShown,e.onHoverInfoWindowShown=r,g=e.onInfoWindowShown,e.onInfoWindowShown=s,f=e.onStreetViewStatusChange,e.onStreetViewStatusChange=a,l.injectCallbacks(e)},i(this)}return n});
define("maps/cards/CardManager",["lib/jquery-amd","ta/Core/TA.Store","mixins/Events"],function(t,e,i){"use strict";function n(n,a){function s(){l.className="mapsv2-cardcontainer"+(e.retrieve("mapsv2.search")?" withsearch":"")+(e.retrieve("mapsv2.listView")||e.retrieve("mapsv2.listViewRoadtrip")?" withlist":""),n.parentNode.appendChild(l)}function o(t){u.emit(r.CARD_COLLAPSED,t)}function d(t){u.emit(r.CARD_EXPANDED,t)}var u=new i(r.CARD_COLLAPSED,r.CARD_EXPANDED),p=a,n=n,c=[],l=document.createElement("ul");this.setVisible=function(e){t(l).toggleClass("hidden",!e)},this.addCard=function(t){t.collapse(),c.push(t),l.appendChild(t.getCardElement()),t.bindToManager(this),t.addCollapseListener(o),t.addExpandListener(d)},this.getSize=function(){var e=t(l),i=e.outerWidth(),n=e.outerHeight();return{width:i,height:n,x:i,y:n}},this.getPosition=function(e){var i=t(l),n=i.offset();if(e){var r=i.parent().offset();n.left-=r.left,n.top-=r.top}return n.x=n.left,n.y=n.top,n},this.getContainer=function(){return l},this.getMapModel=function(){return p.getModel()},this.getMapView=function(){return p.getView()},this.getMapController=function(){return p},this.isMapLayerVisible=function(t){return p.isLayerVisible(t)},this.toggleMapLayer=function(t,e){p.toggleLayer(t,e)},this.getMapHeight=function(){return n&&t(n).outerHeight()},this.fireMapEvent=function(t,e){p.fireMapEvent(t,e)},this.addMapEventListener=function(t,e){p.bindMapEvent(t,e)},this.addCardCollapseListener=function(t){u.on(r.CARD_COLLAPSED,t)},this.addCardExpandListener=function(t){u.on(r.CARD_EXPANDED,t)},s()}var r={CARD_COLLAPSED:"cardCollapsed",CARD_EXPANDED:"cardExpanded"};return n});
define("maps/cards/MapCard",["lib/jquery-amd","utils/ajax","mixins/Events","ta/Core/TA.Store","ns-exporter"],function(e,t,a,n,s){"use strict";function i(e){var t=document.querySelector(e);t&&t.parentNode.removeChild(t)}function d(t){function s(a){c.className="mapsv2-card",m.className="mapsv2-cardcontent",h.className="mapsv2-collapsecontent",t||(a.addCollapsedContentListener("click",a.expand.bind(a)),e(h).addClass("mapsv2-clickable")),e(c).append(m).append(h)}function d(t){if(this!==t)this.collapse();else if(n.retrieve("tablet_maps_v1")&&e(c).hasClass("mapsv2-filterscard")&&(pageServlet&&"Attractions"===pageServlet||crPageServlet&&"Attractions"===crPageServlet)){var a=c.querySelector(".mapsv2-cardcontent .map-filter-tile");a&&a.click()}}function r(){e(c).toggleClass("tablet-collapsed",!0),i(".removeablePinInfo")}var l,p=new a(o.EXPANDED,o.COLLAPSED),c=document.createElement("li"),m=document.createElement("div"),h=document.createElement("div");this.setCardClass=function(t){t&&e(c).addClass(t)},this.bindToManager=function(e,t){l=e,l.addCardExpandListener(d.bind(this)),t||(l.addMapEventListener("mapMoved",this.collapse.bind(this)),n.retrieve("tablet_maps_v1")&&l.addMapEventListener("mapMoved",r))},this.addCollapsedContentListener=function(t,a){e(h).on(t,a)},this.getCardElement=function(){return c},this.getCardElements=function(e){return c.querySelectorAll(e)},this.getCardContent=function(){return m},this.getCollapsedContent=function(){return h},this.initCardContentFromId=function(e){for(var t=document.getElementById(e).children;t.length>0;)m.appendChild(t[0])},this.initCollapsedContentFromId=function(e){for(var t=document.getElementById(e).children;t.length>0;)h.appendChild(t[0])},this.addExpandListener=function(e){p.on(o.EXPANDED,e)},this.expand=function(){this.isCollapsed()&&(e(c).toggleClass("mapsv2-cardcollapsed",!1),n.retrieve("tablet_maps_v1")&&e(c).toggleClass("tablet-collapsed",!1),p.emit(o.EXPANDED,this))},this.addCollapseListener=function(e){p.on(o.COLLAPSED,e)},this.isCollapsed=function(){return e(c).hasClass("mapsv2-cardcollapsed")},this.collapse=function(){this.isCollapsed()||(e(c).toggleClass("mapsv2-cardcollapsed",!0),p.emit(o.COLLAPSED,this))},this.isHidden=function(){return e(c).hasClass("mapsv2-cardhidden")},this.hide=function(){e(c).toggleClass("mapsv2-cardhidden",!0)},this.show=function(){this.isHidden()&&e(c).toggleClass("mapsv2-cardhidden",!1)},this.toggleVisibility=function(t){e(c).toggleClass("mapsv2-cardhidden",!t)},s(this)}var o={EXPANDED:"cardExpanded",COLLAPSED:"cardCollapsed"};d.buildHomePinParam=function(e){var t=e.getHomePinData();return t?t.item&&"address"===t.item.type?"&homePinAddress="+encodeURIComponent(t.item.name):"&homePin="+t.id:""};var r={expandDropdown:function(t,a){var n=e(t.parentNode);n.toggleClass("expanded",!0);var s,i,d=n.find(".mapsv2-dropdownlist");if(a){if(d.length<=0)return;var o=d.offset(),r=d.outerWidth();s=d.closest(".mapsv2-listarea"),i={top:d.css("top"),left:d.css("left"),width:d.css("width")},d.css({top:o.top,left:o.left,width:r+"px"}).toggleClass("expandedOrphan",!0);var l=d.closest(".mapsv2-listitem");l.attr("data-sponsor")&&l.attr("data-sponsor-provider")&&(d.attr("data-sponsor",l.attr("data-sponsor")),d.attr("data-sponsor-provider",l.attr("data-sponsor-provider"))),document.body.appendChild(d.get(0))}setTimeout(function(){if(n.hasClass("expanded")){var t=!1,o=function(){t||(t=!0,n.toggleClass("expanded",!1),a&&(d.css({top:i.top,left:i.left,width:i.width}).toggleClass("expandedOrphan",!1),n.append(d)))};e(document).one("click",o),s&&s.one("scroll",o)}},0)}};return s.exportTo(r,"ta.mapsv2.MapCard"),d});
define("maps/cards/LayersMapCard",["lib/jquery-amd","maps/cards/MapCard","ta/Core/TA.Record","ta/Core/TA.Store"],function(e,a,t,n){"use strict";function r(){function r(){p.setCardClass("mapsv2-layerscard"),p.addCollapsedContentListener("click",d)}function i(e){p.getCardElements(".nearbyFilterItem."+e).length>0&&t.trackEventOnPage("dynamic_large_map","sidebar_poi_appears",e)}function s(){var a=p.getCardElements(".selected"),t=a.length;e(a).each(function(a,n){e(n).hasClass("hidden")&&(t-=1)}),e(p.getCardElement()).toggleClass("has-layers",t>0)}function l(){p.toggleVisibility(n.has("mapsv2.show_sidebar"));var a=c.getMapModel();e(p.getCardElements(".nearbyFilterItem")).each(function(t,n){n=e(n);var r=n.prop("class").split(" ")[1];n.toggleClass("selected",a.isVisible(r))}),s()}function d(){p.expand(),setTimeout(function(){var e=window.pageServlet;"Hotels"===e&&(t.trackEventOnPage("dynamic_large_map","Layers_Expand",e||""),i("vacationrental"),i("restaurant"),i("attraction"))},1)}function o(){p.collapse(),t.trackEventOnPage("dynamic_large_map","Layers_Collapse",window.pageServlet||"")}var c,p=new a;this.bindToManager=function(e){c=e,p.bindToManager(e),e.addMapEventListener("filtersVisibilityChanged",l),e.addMapEventListener("layersToggled",s),p.initCardContentFromId("LAYERS_FILTER_EXPANDED_ID"),p.initCollapsedContentFromId("LAYERS_FILTER_COLLAPSED_ID");var a=p.getCardContent().querySelector(".title");a&&(a.onclick=o),s(),"NeighborhoodList"===window.pageServlet&&p.expand()},this.collapse=function(){p.collapse()},this.getCardElement=function(){return p.getCardElement()},this.addExpandListener=function(e){p.addExpandListener(e)},this.addCollapseListener=function(e){p.addCollapseListener(e)},r()}return r});
define("maps/cards/NeighborhoodListCard",["lib/jquery-amd","maps/cards/MapCard","ta/Core/TA.Record","ta/util/Error"],function(e,n,t,a){"use strict";function o(){function a(){m.setCardClass("mapsv2-listcard neighborhood"),m.initCardContentFromId("NEIGHBORHOOD_LIST_VIEW_EXPANDED"),m.initCollapsedContentFromId("NEIGHBORHOOD_LIST_VIEW_COLLAPSED"),u=m.getCardContent().querySelector(".mapsv2-listarea")}function o(){e(u).find(".description").each(function(n,t){var a=e(t),o=a.prop("data-text");o&&a.text(o),ta.util.adjust.trimTextToHeight(t,36)})}function i(){m.expand(),d(v,u),_||(_=!0,o())}function r(){i(),v.toggleMapLayer("neighborhood",!0),t.trackEventOnPage("dynamic_large_map","neighborhood_list_card","expand"),"Hotels"===window.pageServlet&&t.trackEventOnPage("dynamic_large_map","neighborhood_list_card","manual_expand")}function c(){m.collapse(),t.trackEventOnPage("dynamic_large_map","neighborhood_list_card","collapse"),"Hotels"===window.pageServlet&&t.trackEventOnPage("dynamic_large_map","neighborhood_list_card","manual_collapse")}function s(){v.isMapLayerVisible("neighborhood")||m.collapse()}function p(){m.isCollapsed()?_=!1:(d(v,u),o())}function g(n){var t=e(u);t.empty(),n&&t.append(e(n).find(".mapsv2-listitem"))}function h(e){t.trackEventOnPage("dynamic_large_map","neighborhood_list_card","select",e),v.getMapController().onPolygonClicked(e,!0),"Hotels"===window.pageServlet&&t.trackEventOnPage("dynamic_large_map","hotels_neighborhood_list_card","select",e)}var u,v,m=new n(!0),_=!1;this.bindToManager=function(n){v=n,m.bindToManager(n,!0);var t=m.getCardContent().querySelector(".title");t&&e(t).on("click",c),e(m.getCollapsedContent()).on("click",r),v.addMapEventListener("layersToggled",s),v.addMapEventListener("mapWindowResized",p),v.addMapEventListener("neighborhoodsLoaded",g),s(),v.addMapEventListener("locationSelected",function(e){e&&"neighborhood"===e.poiType&&m.hide()}),v.addMapEventListener("locationCleared",function(e,n){m.show(),n&&v.isMapLayerVisible("neighborhood")&&e&&"neighborhood"===e.poiType?i():m.collapse()});var a=v.getMapController();e(u).on("click",l(h)).on("mouseover",l(a.onPolygonHoverStart.bind(a))).on("mouseout",l(a.onPolygonHoverEnd.bind(a))),v.addMapEventListener("polygonHoverStart",function(n){e(u).find(".n_"+n).addClass("active")}),v.addMapEventListener("polygonHoverEnd",function(n){e(u).find(".n_"+n).removeClass("active")})},this.collapse=function(){m.collapse()},this.getCardElement=function(){return m.getCardElement()},this.addExpandListener=function(e){m.addExpandListener(e)},this.addCollapseListener=function(e){m.addCollapseListener(e)},a()}var i=900,r=200,d=function(n,t){var o=n.getMapHeight();if(o>=0&&t&&t.style)try{var d=n.getSize().y,l=e(t).outerHeight(),c=d-l,s=Math.min(i,Math.max(r,o-63-20-c));t.style.maxHeight=s+"px"}catch(e){a.record(e,"error updating map list view card height")}},l=function(n){return function(t){var t=t||window.event,a=t.target||t.srcElement;if(a=e(a).closest("[data-locid]"),a.length>0){var o=t.fromElement||t.relatedTarget;if(e.contains(a,o))return;n(a.attr("data-locid"))}}};return o});
define("maps/utils/template",["lib/jquery-amd"],function(e){"use strict";return function(r,t,n){n=n||{};var a=e(r).find("."+t).get(0);if(a){a=a.outerHTML;for(var i in n)n.hasOwnProperty(i)&&(a=a.replace(new RegExp("{"+i+"}","g"),n[i]));return a.replace(/data-src/g,"src")}return""}});
define("lib/jquery/jquery.hoverIntent",["lib/jquery-amd"],function(e){"use strict";var t,n,i={interval:100,sensitivity:6,timeout:0},o=0,r=function(e){t=e.pageX,n=e.pageY},u=function(e,i,o,v){return Math.sqrt((o.pX-t)*(o.pX-t)+(o.pY-n)*(o.pY-n))<v.sensitivity?(i.off(o.event,r),delete o.timeoutId,o.isActive=!0,e.pageX=t,e.pageY=n,delete o.pX,delete o.pY,v.over.apply(i[0],[e])):(o.pX=t,o.pY=n,o.timeoutId=setTimeout(function(){u(e,i,o,v)},v.interval),void 0)},v=function(e,t,n,i){return delete t.data("hoverIntent")[n.id],i.apply(t[0],[e])};return function(t,n,a){var s=o++,d=e.extend({},i);e.isPlainObject(t)?(d=e.extend(d,t),e.isFunction(d.out)||(d.out=d.over)):d=e.isFunction(n)?e.extend(d,{over:t,out:n,selector:a}):e.extend(d,{over:t,out:t,selector:n});var p=function(t){var n=e.extend({},t),i=e(this),o=i.data("hoverIntent");o||i.data("hoverIntent",o={});var a=o[s];a||(o[s]=a={id:s}),a.timeoutId&&(a.timeoutId=clearTimeout(a.timeoutId));var p=a.event="mousemove.hoverIntent.hoverIntent"+s;if("mouseenter"===t.type){if(a.isActive)return;a.pX=n.pageX,a.pY=n.pageY,i.off(p,r).on(p,r),a.timeoutId=setTimeout(function(){u(n,i,a,d)},d.interval)}else{if(!a.isActive)return;i.off(p,r),a.timeoutId=setTimeout(function(){v(n,i,a,d.out)},d.timeout)}};return this.on({"mouseenter.hoverIntent":p,"mouseleave.hoverIntent":p},d.selector)}});
define("utils/throttle",[],function(){return function(t,n){var e,r;return function(){r&&(clearTimeout(r),r=0);var i=e?n-(Date.now()-e):null;if(null!==i&&i>0)return void(r=setTimeout(t.apply.bind(t,this,arguments),i));var u=t.apply(this,arguments);return e=Date.now(),u}}});
define("ta/util/Element",["lib/jquery-amd","utils/ajax","ta/Core/TA.Record","ns-exporter","ta/Core/TA.Event","lib/jquery/jquery.hoverIntent","utils/throttle"],function(t,e,i,n,o,r,a){function l(e,i){var n=e.style.fontSize||t(e).css("font-size"),o=n.replace(/[\d\.]/g,""),r=c(o,parseFloat(n)*i);e.style.fontSize=r+o}function s(){function e(e,i){var r=n[e],a=t(r.e);if(a.length>0){var l=r.inView;r.inView=!1,a.each(function(){return!r.inView&&void(r.inView=o.inViewport(this,i,r.persistentElmt,r.offset))}),!l&&r.inView&&(r.cb&&r.cb(r.e),r.multiple||n.splice(e,1))}}function i(){var e=t(window),i={};return i.top=e.scrollTop(),i.left=e.scrollLeft(),i.bottom=i.top+e.height(),i.right=i.left+e.width(),i}var n=[],o=this;this.add=function(i){n.push(i),e(n.length-1),n.length>0&&t(window).on("resize scroll",r)},this.inViewport=function(e,n,o,r){if(e=t(e),!e.is(":visible"))return!1;if(r=t.extend({top:0,left:0,right:0,bottom:0},r),o){var a=o.offsetHeight;a&&(0==o.offsetTop?r.bottom-=a:r.top+=a)}var l=e.offset();return n||(n=i()),n.bottom>=Math.max(l.top+r.top,0)&&n.right>=Math.max(l.left+r.left,0)&&n.top<=Math.max(l.top+e.height()+r.bottom,0)&&n.left<=Math.max(l.left+e.width()+r.right,0)};var r=a(function(){if(n.length){for(var o=i(),a=n.length-1;a>=0;a--)e(a,o);0==n.length&&t(window).off("resize scroll",r)}},300);t(window).on("load",r)}var f={};f.replaceContent=function(i,n,o,r){if(n=t(n),!n.find(".progresstab")){var a=o+(o.indexOf("?")==-1?"?":"&")+"xhr=true";n.append('<div class="progresstab"></div>'),e({url:a,success:function(t){n.html(t),window.behavior&&window.behavior.apply(n),r&&r(n.get(0))},evalScripts:!0}).get()}},f.spinner=function(e,i){t(i).parents(".spinnerReplaceable").children().each(function(t,e){e.toggle(e.hasClass("spinner"))})},f.limitLength=function(t,e,i){return!(e.value.length>=i)||(e.value=e.value.substr(0,i),!1)},f.updateValue=function(e,i){if(e=t(e),e.length>0&&e.val()!=i){e.val(i);var n=document.createEvent("HTMLEvents");n.initEvent("change",!1,!1),e[0].dispatchEvent(n)}},f.keepInWindow=function(e,i){function n(t,e){var i=parseInt(t.get(0).style[e]);return i||0===i}if(e){e=t(e),i||(i={top:!0,right:!0,bottom:!0,left:!0});var o=2,r=e.offset();r.right=r.left+e.width(),r.bottom=r.top+e.height();var a=t(window),l=a.width(),s=a.height(),f=a.scrollTop(),c=a.scrollLeft();i.right&&n(e,"right")?r.left<c+o?e.css("right",l+c-e.width()-o):r.right>l-c-o&&e.css("right",o):i.left&&n(e,"left")&&(r.left<c+o?e.css("left",o):r.right>l-c-o&&e.setStyle("left",l+c-r.width-o)),i.bottom&&n(e,"bottom")?r.top<f+o?e.setStyle("bottom",s+f-r.height-o):r.bottom>s-f-o&&e.setStyle("bottom",o):i.top&&n(e,"top")&&(r.top<f+o?e.setStyle("top",o):r.bottom>s-f-o&&e.setStyle("top",s+f-r.height-o))}};var c=function(t,e){var i=e;return"px"==t?i=8:"em"==t?i=.5:"pt"==t?i=6:"%"==t&&(i=50),Math.max(e,i)};f.makeTextFit=function(e,i,n,r,a){a=a||1,r=r||8;var l=!1;if(t(e).each(function(e,o){o=t(o);var a=o.find(i);if(a){var s;if("number"==typeof n)s=n;else if(s=o.find(n).outerHeight(),void 0===s)return;var f=a.height();if(s<f){var c=a.css("font-size");if(c){var u=function(t,e){return"px"==e&&t>=r||"em"==e&&t>=.5||"pt"==e&&t>6||"%"==e&&t>=50},h=c.replace(/[\d\.]/g,""),d=parseFloat(c)*Math.sqrt(s/f);"px"==h&&(d=Math.max(parseInt(d),r)),u(d,h)&&(a.css("font-size",d+h),l=!0)}}}}),l>0&&a<4){o.fireEvent("makeTextFitResizedText");var s=this;setTimeout(function(){s.makeTextFit(e,i,n,r,a+1)},1)}},function(){function e(t){var e=!1;if(!t||t.clientWidth&&t.clientWidth<=0)return!1;for(var i=t.clientWidth,n=(parseFloat(t.style.paddingLeft)||0)+(parseFloat(t.style.paddingRight)||0),o=0;o<a&&t.scrollWidth>i;o++){var r=(i-n)/(t.scrollWidth-n);l(t,r),e=!0}return t.scrollWidth>i&&(l(t,s),e=!0),e}function i(t,e){var i=t.getAttribute("data-sizegroup"),n=parseFloat(t.style.fontSize);i&&(e[i]=Math.min(e[i]||Number.MAX_VALUE,n))}function n(t){for(var i in t)if(t.hasOwnProperty(i)){var n=t[i],o=[];n.forEach(function(t){o.push([t.scrollWidth,t])}),o.sort(function(t,e){return e[0]-t[0]});for(var r=0;r<o.length&&e(o[r][1]);r++);}}function r(t){var i;for(var n in t)t.hasOwnProperty(n)&&(i={},t[n].forEach(function(t){var n=t.innerHTML,o=i[n];void 0!==o?0!=o&&(t.style.fontSize=o):e(t)?i[n]=t.style.fontSize||0:i[n]=0}))}var a=4,s=.9;f.makeTextFitOneLine=function(i,n){var o=t(i);if(o.each(function(t,i){e(i)}),n){var r;o.each(function(e,i){var n=t(i).css("font-size");(!r||parseFloat(n)<parseFloat(r))&&(r=n)}),r&&o.css("font-size",r)}},f.autoResizeTextInNode=function(o){o=t(o);var a=t(".autoResize",o),l={},s={width:{},text:{}};a.filter(":visible").removeClass("autoResize").each(function(t,n){var o,r,a=n.getAttribute("data-resizeWidthGroup"),f=n.getAttribute("data-resizeTextGroup");a?(o=s.width,r=a):f&&(o=s.text,r=f),o?(o[r]||(o[r]=[]),o[r].push(n)):(e(n),i(n,l))}),n(s.width),r(s.text),a.each(function(t,e){var i=e.getAttribute("data-sizegroup");i&&(e.style.fontSize=l[i]+"px")})},o.queueForLoad(function(){require.defined("ta/Core/TA.Store")&&require("ta/Core/TA.Store").retrieve("no-old-resize")||(o.on("refreshedDOMContent",function(t){f.autoResizeTextInNode(t)}),document.body&&f.autoResizeTextInNode(document.body))},"autoResize all targets on load")}(),f.makeSameWidth=function(e){var i=0;t(e).each(function(t,e){var n=Math.round(parseFloat(e.style.width));n&&n>i&&(i=n)}).css("width",i)},f.fitToContentsHorizontally=function(e,i,n,o){if(o=o||1,!(o<=0||i>n)){var r=function(t){return t.scrollWidth>t.clientWidth||t.scrollHeight>t.clientHeight};t(e).each(function(t,e){e.style.width=i;for(var a=i;a<n&&r(e);a+=o)e.style.width=a;r(e)&&(e.style.width=n)})}},f.scrollIntoView=function(e,i,n,o){if(e){e=t(e);var r=e.offset().top+(i||0);if(n){for(var a=t("html, body"),l=e.parent(),s=function(t){return("auto"===t.css("overflow-y")||"scroll"===t.css("overflow-y"))&&t[0].scrollHeight>t[0].clientHeight};l.length&&!l.is(a)&&!s(l);)l=l.parent();l.length&&!l.is(a)&&s(l)?r=l.offset().top+l.scrollTop()+(i||0):l=a,l.animate({scrollTop:r},{duration:300,complete:function(){o&&o()}})}else window.scrollTo(0,r),o&&o()}};var u=f.scrollTrackers=new s;return f.isScrolledIntoView=function(t,e,i){return u.inViewport(t,null,e,i)},f.doIfElementIsVisible=function(t,e,i,n){t&&u.add({e:t,cb:function(){return e.apply(null,i),!0},offset:n})},f.trackWhenScrolledIntoView=function(t,e,n){if(t&&e){var o=function(){i.trackEventOnPage.apply(i,e)};u.add({e:t,cb:o,multiple:n})}},f.getTotalWidth=function(e){return t(e).outerWidth(!0)||0},f.getTotalHeight=function(e){return t(e).outerHeight(!0)||0},f.hoverIntent=function(e,i){r.bind(t(e),i)()},n.exportTo(f,"ta.util.element"),f});
define("babel/babel-helpers",[],function(){var e={};return e["typeof"]="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.jsx=function(){var e="function"==typeof Symbol&&Symbol["for"]&&Symbol["for"]("react.element")||60103;return function(r,t,n,o){var i=r&&r.defaultProps,u=arguments.length-3;if(t||0===u||(t={}),t&&i)for(var a in i)void 0===t[a]&&(t[a]=i[a]);else t||(t=i||{});if(1===u)t.children=o;else if(u>1){for(var f=Array(u),l=0;l<u;l++)f[l]=arguments[l+3];t.children=f}return{$$typeof:e,type:r,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}}(),e.asyncIterator=function(e){if("function"==typeof Symbol){if(Symbol.asyncIterator){var r=e[Symbol.asyncIterator];if(null!=r)return r.call(e)}if(Symbol.iterator)return e[Symbol.iterator]()}throw new TypeError("Object is not async iterable")},e.asyncGenerator=function(){function e(e){this.value=e}function r(r){function t(e,r){return new Promise(function(t,o){var a={key:e,arg:r,resolve:t,reject:o,next:null};u?u=u.next=a:(i=u=a,n(e,r))})}function n(t,i){try{var u=r[t](i),a=u.value;a instanceof e?Promise.resolve(a.value).then(function(e){n("next",e)},function(e){n("throw",e)}):o(u.done?"return":"normal",u.value)}catch(e){o("throw",e)}}function o(e,r){switch(e){case"return":i.resolve({value:r,done:!0});break;case"throw":i.reject(r);break;default:i.resolve({value:r,done:!1})}i=i.next,i?n(i.key,i.arg):u=null}var i,u;this._invoke=t,"function"!=typeof r["return"]&&(this["return"]=void 0)}return"function"==typeof Symbol&&Symbol.asyncIterator&&(r.prototype[Symbol.asyncIterator]=function(){return this}),r.prototype.next=function(e){return this._invoke("next",e)},r.prototype["throw"]=function(e){return this._invoke("throw",e)},r.prototype["return"]=function(e){return this._invoke("return",e)},{wrap:function(e){return function(){return new r(e.apply(this,arguments))}},"await":function(r){return new e(r)}}}(),e.asyncGeneratorDelegate=function(e,r){function t(t,n){return o=!0,n=new Promise(function(r){r(e[t](n))}),{done:!1,value:r(n)}}var n={},o=!1;return"function"==typeof Symbol&&Symbol.iterator&&(n[Symbol.iterator]=function(){return this}),n.next=function(e){return o?(o=!1,e):t("next",e)},"function"==typeof e["throw"]&&(n["throw"]=function(e){if(o)throw o=!1,e;return t("throw",e)}),"function"==typeof e["return"]&&(n["return"]=function(e){return t("return",e)}),n},e.asyncToGenerator=function(e){return function(){var r=e.apply(this,arguments);return new Promise(function(e,t){function n(o,i){try{var u=r[o](i),a=u.value}catch(e){return void t(e)}return u.done?void e(a):Promise.resolve(a).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}},e.classCallCheck=function(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")},e.createClass=function(){function e(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(r,t,n){return t&&e(r.prototype,t),n&&e(r,n),r}}(),e.defineEnumerableProperties=function(e,r){for(var t in r){var n=r[t];n.configurable=n.enumerable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,t,n)}return e},e.defaults=function(e,r){for(var t=Object.getOwnPropertyNames(r),n=0;n<t.length;n++){var o=t[n],i=Object.getOwnPropertyDescriptor(r,o);i&&i.configurable&&void 0===e[o]&&Object.defineProperty(e,o,i)}return e},e.defineProperty=function(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e},e["extends"]=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},e.get=function e(r,t,n){null===r&&(r=Function.prototype);var o=Object.getOwnPropertyDescriptor(r,t);if(void 0===o){var i=Object.getPrototypeOf(r);return null===i?void 0:e(i,t,n)}if("value"in o)return o.value;var u=o.get;if(void 0!==u)return u.call(n)},e.inherits=function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function, not "+typeof r);e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),r&&(Object.setPrototypeOf?Object.setPrototypeOf(e,r):e.__proto__=r)},e["instanceof"]=function(e,r){return null!=r&&"undefined"!=typeof Symbol&&r[Symbol.hasInstance]?r[Symbol.hasInstance](e):e instanceof r},e.interopRequireDefault=function(e){return e&&e.__esModule?e:{"default":e}},e.interopRequireWildcard=function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=e[t]);return r["default"]=e,r},e.newArrowCheck=function(e,r){if(e!==r)throw new TypeError("Cannot instantiate an arrow function")},e.objectDestructuringEmpty=function(e){if(null==e)throw new TypeError("Cannot destructure undefined")},e.objectWithoutProperties=function(e,r){var t={};for(var n in e)r.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t},e.possibleConstructorReturn=function(e,r){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!r||"object"!=typeof r&&"function"!=typeof r?e:r},e.selfGlobal="undefined"==typeof global?self:global,e.set=function e(r,t,n,o){var i=Object.getOwnPropertyDescriptor(r,t);if(void 0===i){var u=Object.getPrototypeOf(r);null!==u&&e(u,t,n,o)}else if("value"in i&&i.writable)i.value=n;else{var a=i.set;void 0!==a&&a.call(o,n)}return n},e.slicedToArray=function(){function e(e,r){var t=[],n=!0,o=!1,i=void 0;try{for(var u,a=e[Symbol.iterator]();!(n=(u=a.next()).done)&&(t.push(u.value),!r||t.length!==r);n=!0);}catch(e){o=!0,i=e}finally{try{!n&&a["return"]&&a["return"]()}finally{if(o)throw i}}return t}return function(r,t){if(Array.isArray(r))return r;if(Symbol.iterator in Object(r))return e(r,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),e.slicedToArrayLoose=function(e,r){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e)){for(var t,n=[],o=e[Symbol.iterator]();!(t=o.next()).done&&(n.push(t.value),!r||n.length!==r););return n}throw new TypeError("Invalid attempt to destructure non-iterable instance")},e.taggedTemplateLiteral=function(e,r){return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(r)}}))},e.taggedTemplateLiteralLoose=function(e,r){return e.raw=r,e},e.temporalRef=function(e,r,t){if(e===t)throw new ReferenceError(r+" is not defined - temporal dead zone");return e},e.temporalUndefined={},e.toArray=function(e){return Array.isArray(e)?e:Array.from(e)},e.toConsumableArray=function(e){if(Array.isArray(e)){for(var r=0,t=Array(e.length);r<e.length;r++)t[r]=e[r];return t}return Array.from(e)},e});
define("widget/components",["babel/babel-helpers"],function(e){var t={};return t.initComponentWidgets=function(e,o){var n=t.getComponentWidgets(e,o);return 0===n.length?n:(require(["babel/babel-helpers","@ta/platform.runtime"],function(e,t){n.forEach(function(e){var o=e.getAttribute("data-component"),n=e.id,r=e.getAttribute("data-component-props"),i="page-manifest"===r?t.pageManifestComponents[n]:JSON.parse(r);t.importBundle(o).then(function(){var e=!!document.getElementById(n);e&&t.createRoot(n,o,i)})})}),n)},t.getComponentWidgets=function(e,t){var o=e&&e.querySelectorAll(".component-widget[data-component"+(t?"='"+t+"'":"")+"]");return o?Array.prototype.slice.apply(o):[]},t.contains=function(e,o,n){var r=t.getComponentWidgets(o||document.body,n);return r.some(function(t){return t.contains(e)})},t.termsOfUseGate=function(){return new Promise(function(e){require(["babel/babel-helpers","@ta/platform.runtime","redux-init"],function(t,o,n){if(!n.getState().auth.loggedInUserId)return e();var r="@ta/social.terms-of-use-gate";o.importBundle(r).then(function(){if(!document||!document.body)return e("Document or document body is not defined");var t=document.createElement("div");t.id=r,document.body.appendChild(t),o.createRoot(t.id,r,{onComplete:function(){o.destroyRoot(t.id),t.remove(),e()},onClose:function(n){n.trigger&&(o.destroyRoot(t.id),t.remove(),e("User has exited the gate without completing"))}})})})})},t.loadOverlayComponent=function(e){return new Promise(function(t){return require(["babel/babel-helpers","@ta/platform.runtime"],function(o,n){n.importBundle(e).then(function(){var r=document.createElement("div"),i=Math.random(),a=e+":"+i;r.id=a,document.body.appendChild(r);var u=function(t){[].concat(o.toConsumableArray(document.querySelectorAll(".ui_overlay"))).forEach(function(e){e.remove()}),n.createRoot(a,e,t)},d=function(){n.destroyRoot(a),r.remove()};t({createRoot:u,destroyRoot:d})})})})},t.socialGate=function(e,t){return new Promise(function(o){require(["babel/babel-helpers","@ta/platform.runtime"],function(n,r){var i="@ta/social.immediate-login-gate";r.importBundle(i).then(function(){if(!document||!document.body)return o("Document or document body is not defined");var n=document.createElement("div");n.id=i,document.body.appendChild(n);var a=void 0,u=document.getElementById("contextualMessage");u&&(a={contextualMessage:u.value}),r.createRoot(n.id,i,{flowOrigin:t,onComplete:function(){return r.destroyRoot(n.id),n.remove(),o()},onClose:function(e){if(e.trigger)return r.destroyRoot(n.id),n.remove(),o("User has exited the gate without completing")},pid:e,extraRegParams:a})})})})},t});
define("ta/prwidgets",["vanillajs","ns-exporter","purify","amdloaders","widget/components"],function(t,e,r,n,i){function a(t,e){var r,n=this.element._prWidgetContext;return"string"==typeof t?(t=[t],r=o(n.widget.name,t),r=r[0]&&w(r[0]),r=r&&l(n,t,[r]),r&&r[0]):(t=t.slice(),void w(o(n.widget.name,t),function(){var r=l(n,t,arguments);e&&e.apply(null,r)}))}function o(t,e,r){var n=b[t];if(!n)return[];e=e.slice();for(var i=0;i<e.length;++i){var a=e[i],o=a.replace(/^[a-z]+!/,""),l=a.substring(0,a.length-o.length);"trhtml!"===l||("widget"===o?e[i]=null:n["trjs!"===l?o:a]&&(e[i]=l+"$prw/"+t+"/"+o))}return e}function l(t,e,r){var n,i;if(r=Array.prototype.slice.apply(r),0===e.length)return r;var a=b[t.widget.name];if(r.length<e.length)for(n=o(t.widget.name,e);(i=r.length)<e.length;)n[i]?r.push(w(n[i])):r.push(null);for(var i=0;i<e.length;++i){var l=e[i].replace(/^trjs!/,"");t[l]?r[i]=t[l]:a[l]&&"function"==typeof r[i]&&(r[i]=r[i].call(null,t))}return r}function u(t){t._prWidgetContext=this.element._prWidgetContext}function p(t){var e,r,n,i,o,l;if(t&&!t._prWidgetContext&&(e=t.getAttribute("data-prwidget-init"),"string"==typeof e&&(n=t.getAttribute("data-prwidget-name")))){e=d(e),o=d(t.getAttribute("data-scriptFlags")).reduce(function(t,e){return t[e]=!0,t},{});var p=e.length;if(l=t.getAttribute("data-prwidget-deferred")){l=d(l);for(var i=0;i<l.length;i++)e.push(l[i])}var f=b[n];for(f||(b[n]=f={}),r={},i=0;i<e.length;i++)f[e[i]]=!0;r.widget={"name":n,"element":t,"modules":e,"flags":o,"markMine":u,"require":a},t._prWidgetContext=r,r.widget.require(e.slice(0,p),function(){if(t._prPendingClick){var e=t._prPendingClick;t._prPendingClick=void 0,e.key===v&&window.setTimeout(function(){y.call.apply(y,e.args)},0)}})}}function f(t,e){var n,i;if(!e&&(t=r(t,!0),t.forEach))return void t.forEach(function(t){y.initWidgets(t,!0)});for(n=t.querySelectorAll(".prw_rup"),i=0;i<n.length;i++)p(n[i]);for(n=t.querySelectorAll(".prw_dyn"),i=0;i<n.length;i++)p(n[i])}function d(t){return"string"!=typeof t?[]:t.match(/[^\s,]+(\s+[^\s,]+)*/g)||[]}function g(t){var e=t._prWidgetContext;if(e)return e;for(t=t.parentNode;t&&t.hasAttribute;t=t.parentNode){if(e=t._prWidgetContext)return e;if(t.hasAttribute("data-prwidget-init"))break}}function c(t){for(var e=t;e&&e.hasAttribute;e=e.parentNode)if(e.hasAttribute("data-prwidget-init"))return e}function s(t){t&&t.nodeName&&A.test(t.className||"")&&(t.className=(t.className||"").replace(A,""))}function h(t){t&&t.nodeName&&!A.test(t.className||"")&&(t.className=(t.className||"")+" handlerLoading")}var v,y={},m=define,w=require,b={},A=/\bhandlerLoading *\b/g;return y.define=function(t,e,r,n,i){if(e=e.replace(/\.js$/i,""),"[object Array]"!==Object.prototype.toString.call(n)&&(n=[]),r&&r.length){var a=b[t];a||(b[t]=a={});for(var u=0;u<r.length;u++)a[r[u]]=!0}m("$prw/"+t+"/"+e,o(t,n),function(){var t=Array.prototype.slice.apply(arguments);return function(r){return r[e]||(r[e]=i.apply(null,l(r,n,t))),r[e]}})},y.redefine=function(t,e){return w.undef&&w.undef("$prw/"+t+"/"+e),y.define.apply(this,arguments)},y.getjs=function(t,e){var r=g(t);if(r&&"string"==typeof e)return r.widget.require(e)},y.initWidgets=function(t,e){t||(t=document),("string"!=typeof t||(t=document.getElementById(t)))&&(f(t,e),i.initComponentWidgets(t))},y.getWidgetElement=function(t,e){return e=e||document.body,e.querySelector(".prw_"+t)},y.call=function(t,e,r,n){if("string"!=typeof t||!r)throw"ta.prwidgets.call() requires method, event||null, element";var i=g(r),a=e&&("click"===e.type||"submit"===e.type);if(a&&(e&&e.preventDefault&&e.preventDefault(),v=void 0),!i){if(a){var o=c(r);o&&!o._prWidgetContext&&(v={},o._prPendingClick={key:v,args:Array.prototype.slice.call(arguments,0)})}return!1}var l=t.match(/^((?:[^\/]+\/)*[^\/\.]+)\.([^\/]*)?$/),u=l[1];l=l[2].split(".");var p=Array.prototype.slice.call(arguments,1),f=function(e){s(r);for(var n=void 0;l.length>0&&e;)n=e,e=e[l.shift()];if("function"!=typeof e)throw"ta.prwidgets.call: '"+t+"' is not a function";return e.apply(n||{},p),!1};return i[u]?f(i[u]):void((a||require.defined("$prw/"+i.widget.name+"/"+u))&&(h(r),i.widget.require(["trjs!"+u],f)))},e.exportTo(y,"ta.prwidgets"),y});
define("ta/Core/TA.LocalStorage",["vanillajs","common/trackingStreams","ns-exporter"],function(e,t,n){"use strict";var r=!1,o="taLsTest",i="1",a="TALocalStorageCurrentSessionId",u=!1,s="session-",l=!1,c=[],f=[],v=[],g=function(){return!(!u&&!l)},m=function(e){return!!g()||(t.error(null,"Accessing localStorage session cookie before session logic intialized: "+e),!1)},S=function(e){return d(e,"value")},y=function(e){return d(e,"now")},d=function(e,t){if(!t)return null;try{var n,o=JSON.parse(r.getItem(e)||"0");return o?o.ttl&&o.ttl+o.now<(new Date).getTime()?(r.removeItem(e),null):o.hasOwnProperty(t)?(r.setItem("512",o[t]),n=r.getItem("512"),r.removeItem("512"),n):null:null}catch(e){}return null},h=function(e,t){try{var n=JSON.parse(e||"0");return n&&n.hasOwnProperty(t)?n[t]:null}catch(e){return null}},w=function(e){try{var t=JSON.parse(r.getItem(e)||"0");return t?t.ttl&&t.ttl+t.now<(new Date).getTime()?(r.removeItem(e),null):t.value:null}catch(e){}return null},I=function(e){try{r.removeItem(e)}catch(e){}},p=function(e,t){var n=y(e);if(t&&n&&n<(new Date).getTime()-t)try{r.removeItem(e)}catch(e){}},O=function(e){try{var t=r.getItem(e);if(null!==t&&void 0!==t)return!0}catch(e){}return!1},T=function(e,t,n){try{r.setItem(e,JSON.stringify({ttl:n||0,now:(new Date).getTime(),value:t}))}catch(e){}},k=function(e){if(l=!0,!e)return t.error(null,"Attempting to initialize localStorage with invalid sesion key: "+e),!1;if(!V())return!1;if(u=S(a),!u||u!=e){u=e,T(a,u);var n=S("latestPageServlet");n&&T("sessionEntryServlet",n),E(),O(a)&&require.defined("ta/Core/TA.Store")&&require("ta/Core/TA.Store").store("isFirstSessionPageView",!0)}for(var r=0;r<v.length;r++)v[r]();v=[]},E=function(){try{var e=s+u,t=new RegExp("^"+s);if(r.length)for(var n=0;n<r.length;n++){var o=r.key(n);try{t.test(o)&&o!=e&&I(o)}catch(e){}}}catch(e){}},V=function(){try{if(r&&r.setItem){r.setItem(o,i);var e=r.getItem(o)!=i;return r.removeItem(o),e&&(r=!1),!!r}}catch(e){}return!1},N=function(e){try{r.setItem("session-"+u,JSON.stringify(e))}catch(e){}},b=function(){try{var e=r.getItem("session-"+u);if(e)return JSON.parse(e)}catch(e){}return{}},A=function(e){c.push(e)},C=function(e,t){f[e]||(f[e]=[]),f[e].push(t)},J=function(e){"function"==typeof e&&(g()?e():v.push(e))},L={enabled:V(),get:S,getObject:w,set:T,remove:I,removeIfElapsed:p,has:O,getTimeStamp:y,updateSessionId:k,onSessionStorageChange:A,onValueChange:C,canUseSession:g,onLocalStorageSessionInit:J,getSessionKey:function(e){if(!m(e))return null;var t=b();return t?t[e]:null},setSessionKey:function(e,t){if(m(e)){var n=b();n||(n={}),n[e]=t,N(n)}},removeSessionKey:function(e){if(m(e)){var t=b();t&&(delete t[e],N(t))}},hasSessionKey:function(e){if(!m(e))return!1;var t=b();if(t){var n=t[e];if(null!==n&&void 0!==n)return!0}return!1},setStorage:function(e){r=e,L.enabled=V()}};if("undefined"!=typeof window){var j=!1;try{j=window.localStorage}catch(e){}L.setStorage(j),function(){function e(e){if(e=e||window.event,!u||e.key&&e.key!=="session-"+u)e.key&&f[e.key]&&(e.oldValueObj=e.oldValue&&h(e.oldValue,"value"),e.newValueObj=e.newValue&&h(e.newValue,"value"),f[e.key].forEach(function(t){t(e)}));else for(var t=0,n=c.length;t<n;t++)c[t](e)}window.addEventListener?window.addEventListener("storage",e,!1):window.attachEvent&&window.attachEvent("onstorage",e)}()}return n.createNs(L,"ta","localStorage"),L});
define("ta/util/SessionStorage",["vanillajs","ns-exporter"],function(e,t){var n={};return n.canUseSessionStore=function(){try{if(window.sessionStorage){var e="taLsTest";sessionStorage.setItem(e,"1");var t=sessionStorage.getItem(e);return"1"==t}}catch(e){return!1}},n.canUseSessionStore()?(n.setObject=function(e,t){sessionStorage.setItem(e,JSON.stringify(t))},n.getObject=function(e){var t=sessionStorage.getItem(e);return t?JSON.parse(t):null},n.remove=function(e){sessionStorage.removeItem(e)}):(n.setObject=function(){},n.getObject=function(){return null},n.remove=function(){}),t.exportTo(n,"ta.util.sessionStorage"),n});
define("ta/util/LocalStorage",["vanillajs","ns-exporter","ta/Core/TA.LocalStorage","ta/util/SessionStorage"],function(e,t,o,a){"use strict";var n={canUseLocalStore:function(){return o.enabled},canUseSessionStore:function(){return a.canUseSessionStore()}};return t.exportTo(n,"ta.util.localstorage"),n});
define("ta/commerce/MetaJson",["lib/jquery-amd","ta/util/LegacyDateShim","ta/Core/TA.Store","ta/Core/TA.Event","ta/Core/TA.Record","ta/util/Error","ns-exporter","ta/commerce/MetaPolling","ta/util/ajax","ta/util/LocalStorage"],function(e,t,r,a,n,o,i,l,c,s){"use strict";function d(){var e=[];for(var t in E)t in T||e.push(t);return e}function u(t,r){P=!0;try{for(var n in t)if(t.hasOwnProperty(n)){var o=t[n];if(o in E)for(var i in E[o])if(E[o].hasOwnProperty(i)){var l=E[o][i];e(l.selector).each(function(e,t){if(t){var n=l.updater(g(o),r);n&&(t.innerHTML=n,a.fireEvent("refreshedDOMContent",t))}})}}}finally{P=!1}}function f(e,t,a){T[e]=t,r.has("improve_sd_sort")||"HotelHighlight"===window.pageServlet||u([e],a)}function g(e){if(e in T)return T[e]}function h(e,a,n){var o,i,l,c=t,s={"loc":m(e),"baseLocId":n,"shortSponsors":v(e),"finalRequest":a>0,"referringServlet":window.pageServlet};if(r.retrieve("hotel_highlight")&&window.modelLocId&&(g(window.modelLocId)&&"partial"!==g(window.modelLocId).status||(s.calXSellFor=window.modelLocId)),c&&(s.validDates=c.datesInRange(),c.datesInRange())){o=c.getCheckRatesData();for(i in o)s[i]=o[i]}if(window.modelGeoId&&(s.geo=window.modelGeoId),r.has("meta.widget.mcid")&&(s.cmcid=r.retrieve("meta.widget.mcid")),r.has("additionalMetaParams")){l=r.retrieve("additionalMetaParams");for(i in l)s[i]=l[i]}return s}function v(e){var t="";return t}function m(e){for(var t="",r=0;r<e.length;r++)r>0&&(t+=","),t+=e[r];return t}function w(e,t){if(e&&0!==e.length){t=t||0;var o=window.modelLocId||-1,i=(new Date).getTime();c({method:"GET",url:"/MetaJsonAjax",data:h(e,t,o),onSuccess:function(o){var c,d,g,h=!1;if(r.store("isTrackTreeFresh",!0),o.debugInfo&&(console.log(o.debugInfo),s.cpcOverride=o.debugInfo),o.hasOwnProperty("rateCalendar")&&(o.rateCalendar&&o.hasOwnProperty("calXSell")?(d=o.calXSell.pricing.length,n.trackEventOnPage("CalXSell",d)):n.trackEventOnPage("CalXSell",-1)),o.numProperties)for(c in o.data)"code"!==c&&"status"!==c&&("partial"===o.data[c].status&&(h=!0),f(c,o.data[c],o.features),!p&&window.modelLocId&&c===window.modelLocId&&o.data[c].availCount>0&&(p=!0));(r.has("improve_sd_sort")||"HotelHighlight"===window.pageServlet)&&u(e,o.features),t<1&&r.store("isTrackTreeFresh",!0),r.has(I)&&i<r.retrieve(I)&&(h=!1),t>=l.getMaxPollingAttemptNumber()&&(h=!1),o.complete=!h,h?(g=setTimeout(function(){w(e,t+1)},l.getPollWaitTimeForPollingAttempt(t+1)),r.store(C,g)):a.fireEvent("MetaFetchComplete")}.bind(this)})}}var p=!1,T={},C="BULK_FETCH_TIMEOUT_KEY",I="BULK_FETCH_CANCEL_TIMESTAMP",E={},P=!1,S={refetchAll:function(){var e=[];for(var t in E)E.hasOwnProperty(t)&&e.push(t);T={},u(e),p=!1,w(e)},clearCache:function(){T={}},registerTarget:function(e,t,r){if(P)throw new Error("Cannot register during dispatch");if(e in E){var n=!1;for(var i in E[e])E[e][i].selector==t&&(n=!0);n?o.record(null,"target already registered",null,{"locId":e,"selector":t}):E[e].push({"selector":t,"updater":r})}else E[e]=[{"selector":t,"updater":r}];if(g(e)){var l=document.querySelector(t);if(l){var c=r(g(e));c&&(l.innerHTML=c,a.fireEvent("refreshedDOMContent",l))}}},unregisterTarget:function(e,t){if(P)throw new Error("Cannot unregister during dispatch");if(e in E){for(var r in E[e])E[e][r].selector==t&&E[e].splice(r,1);0===E[e].length&&delete E[e]}},fetch:function(){p=!1,w(d(),0)},cancelCurrentBulkFetch:function(){var e=r.retrieve(C);e&&clearTimeout(e),r.store(I,(new Date).getTime())},clearPartials:function(){var e,t;for(e in T)t=T[e],t.status&&"partial"===t.status&&delete T[e]},unregisterAll:function(){T={},E={}}};return i.exportTo(S,"ta.commerce.metajson"),S});
define("maps/cards/DetailCard",["lib/jquery-amd","maps/cards/MapCard","maps/utils/template","ta/util/Error","ta/Core/TA.Record","ta/Core/TA.Store","ta/util/Element","ta/util/LegacyDateShim","ta/Core/TA.Event","ta/prwidgets","ta/commerce/MetaJson","ns-exporter"],function(e,a,t,i,r,n,s,o,l,d,c,p){"use strict";function v(e,a,i){if(!e)return"<!-- empty results in drawTextOffers -->";for(var r=[],s=[],o=0,l=e.data.length;o<l&&o<y;o++){var d=o%2>0?r:s,c=e.data[o];if(c){var p="withPrice",v="minPrice";"maybe"===c.available?(p="withSprite",v="rightSprite sprite-visitSite"):"false"===c.available&&(p="noLnk",v="rightSprite sprite-noAvailability"),d.push(t(a,"mapsv2-textoffer",{providername:c.vendor,offer_author_name:c.author,price:"true"===c.available?c.displayPrice+"*":"",contentid:c.contentId,clickdata:c.commerceClickData,navarea:M,offerclass:p,priceclass:v,availability:"true"===c.available?"Available":"maybe"===c.available?"Maybe_Avail":"Not_Avail",openbehavior:c.openBehavior}))}}return e.data.length>y?s.push(t(a,"mapsv2-more",{locid:i.id,num:e.data.length})):n.retrieve("tablet_maps_v1")&&s.push(t(a,"mapsv2-more",{locid:i.id,num:e.data.length})),"<ul class='leftMost'>"+s.join("")+"</ul><ul class='rightMost'>"+r.join("")+"</ul><div class='clearFix'></div>"}function m(e,a,i){if(!e)return"<!-- empty resultsData in drawChevron -->";var r=e[0],s=t(a,"mapsv2-chevron",{providername:r.author,offer_author_name:r.author,logosrc:r.logo,price:r.displayPrice,contentid:r.contentId,clickdata:r.commerceClickData,navarea:M,addclass:"maybe"===r.available?"maybe":"",availability:"true"===r.available?"Available":"maybe"===r.available?"Maybe_Avail":"Not_Avail",openbehavior:r.openBehavior});return(r.length>1||n.retrieve("tablet_maps_v1"))&&(s+=t(a,"mapsv2-more",{locid:i.id,num:r.length})),s}function u(a,i){if(!e.isArray(a))return"<!-- invalid data for drawDropdown -->";var r="";a.forEach(function(e,n){if(0!==n){var s=n===a.length-1?"last":"";"maybe"===e.available?s+=" maybe":"false"===e.available&&(s+=" unavail");var o="";o="false"===e.available?'<span class="sprite-noAvailability"></span>':e.displayPrice?e.displayPrice+"*":'<span class="sprite-visitSite"></span>',r+=t(i,"mapsv2-dropdownitem",{providername:e.vendor,offer_author_name:e.author,price:o,contentid:e.contentId,clickdata:e.commerceClickData,navarea:M,addclass:s,openbehavior:e.openBehavior})}},this);var n="";return n=a[0].displayPrice?a[0].displayPrice+"*":'<span class="sprite-visitSite-black"></span>',t(i,"mapsv2-metadropdown",{providername:a[0].vendor,offer_author_name:a[0].author,price:n,contentid:a[0].contentId,clickdata:a[0].commerceClickData,navarea:M,listitems:r,addclass:"true"===a[0].available?"":"maybe",openbehavior:a[0].openBehavior})}function f(e){var a={};return e.filter(function(e){return!a[e.vendor]&&(a[e.vendor]=!0,!0)})}function h(e){if(e){var a=document.querySelector(".mapsv2-collapsedmeta");a&&(a.innerHTML=e)}}function g(e){if(e){var a=document.querySelector(".mapsv2-detailmeta");a&&(a.innerHTML=e)}}function b(a){if(a){var t=e(a).find("[data-targetEvent]");0!==t.length&&t.each(function(e,a){var t=a.getAttribute("data-targetEvent");if(t)try{l.fireEvent(t,a)}catch(e){i.record(e,{errorMessage:"ERROR in handler for "+t})}})}}function C(){function i(){A.setCardClass("mapsv2-detailcard")}function p(){var e="",a=P.getMapModel().activeSponsors;for(var t in a)a[t]&&(e+=(e.length>0?",":"")+t);return e}function C(){A.isHidden()||S()}function M(){P.toggleMapLayer("hotel",!0),P.fireMapEvent("locationCleared",[L,!0]),r.trackEventOnPage("detail_card_more_hotels","click")}function y(a,i){if(null!=i){if("empty"===i.status)return t(x,"mapsv2-noprices",{locid:L.id});if("partial"===i.status)return t(x,"mapsv2-loading");if(n.retrieve("tablet_maps_v1")){var r=A.getCardElements(".flexCard");r.length>0&&o.datesInRange()&&e(r[0]).addClass("withMeta")}if("invalid"===i.status){var d="mapsv2-showprices";return n.retrieve("feature.flat_buttons_sitewide")&&(d="mapsv2-showprices_alt"),t(x,d,{locid:L.id})}if(setTimeout(function(){s.makeTextFitOneLine(".mapsv2-chevron .price, .mapsv2-chevron .checkSite"),l.fireEvent("refreshedDOMContent",document.querySelector(".mapsv2-chevron"))},0),0==i.availCount&&0==i.maybeAvailCount)return t(x,"mapsv2-unavail",{num:i.totalCount})+v(i,x,L);var c=f(i.data),p="";return c&&c.length>0?a?p+=u(c,x):(p+=m(c,x,L),e(A.getCollapsedContent()).find(".meta_date_wrapper").hide(),p+=t(x,"mapsv2-disclaimer")+"<div class='clearFix'></div>"):p+=t(x,"mapsv2-noprices"),p}}function _(e){g(y(!1,e)),h(y(!0,e))}function w(e){L&&_(e?e[L.id]:{"status":"invalid"})}function E(){w(P.getMapModel().getMetaInfo())}function k(){var e=A.getCardElements(".mapsv2-morehotels .back-text");e.length>0&&(e[0].innerHTML="1"===getEntryCategory()?n.retrieve("mapsv2.more_hotels"):n.retrieve("mapsv2.more_accom"))}function T(a){var t=e(A.getCardContent());t.html(a),x=t.find(".mapsv2-templates"),x.detach();var i=t.find(".collapsedView");i.length>0&&(e(A.getCollapsedContent()).empty().append(i),i.find(".mapsv2-collapsedheader").on("click",function(){A.expand(),r.trackEventOnPage("detail_card_collapsed","expand"),l.fireEvent("refreshedDOMContent",t)})),e(A.getCardElements(".mapsv2-closebutton")).on("click",function(){return P.fireMapEvent("locationCleared",[L,!1]),!1}),e(A.getCardElements(".mapsv2-morehotels")).on("click",M),n.has("mapsv2.listView")||n.has("mapsv2.listViewRoadtrip")?E():(c.cancelCurrentBulkFetch(),c.unregisterTarget(L.id,".mapsv2-detailmeta"),c.unregisterTarget(L.id,".mapsv2-collapsedmeta"),c.clearPartials(),c.registerTarget(L.id,".mapsv2-detailmeta",y.bind(this,!1)),c.registerTarget(L.id,".mapsv2-collapsedmeta",y.bind(this,!0)),c.fetch());var s=document.querySelector(".listing.meta_card.unifiedDates");if(s&&d.initWidgets(document.querySelector(".mapsv2-detail-info.entry.listing.meta_card")),b(t),A.show(),P.fireMapEvent("afterLocationSelected",L),k(),l.fireEvent("refreshedDOMContent",t),require.defined("maps/performanceMetrics")){var o=require("maps/performanceMetrics");o.detailCardShown(L.id)}}function D(e){if(e&&e.item&&("hotel"===e.poiType||"hotel"===e.item.type||e.item.isLodging||0===e.poiType.indexOf("sponsor_"))){if(L&&e.id==L.id&&!A.isHidden())return void A.expand();!L||n.has("mapsv2.listView")&&n.has("mapsv2.listViewRoadtrip")||(c.cancelCurrentBulkFetch(),c.unregisterTarget(L.id,".mapsv2-detailmeta"),c.unregisterTarget(L.id,".mapsv2-collapsedmeta")),L=e,S(),A.expand()}else A.hide()}function S(){if(A.hide(),L){var e=getBaseMapsUrl("detailView",L.id,window.pageServlet);e+=a.buildHomePinParam(P.getMapModel()),require.defined("ta/page")&&require("ta/page").usingUnifiedDates&&(e+="&unifiedDates=true");var t=p();t&&(e+="&sponsors="+t);var i=n.retrieve("roadtrip.sponsoredHotels");!t&&i&&i[L.id]&&(e+="&sponsors="+i[L.id]),new Request({url:e,onSuccess:T}).get()}}var L,x,P,A=new a;this.bindToManager=function(e){if(P=e,A.bindToManager(P,!0),P.addMapEventListener("locationSelected",D),P.addMapEventListener("locationCleared",A.hide.bind(A)),P.addMapEventListener("userPinDropped",D),P.addMapEventListener("sponsorToggled",C),n.has("mapsv2.listView")||n.has("mapsv2.listViewRoadtrip")){P.getMapModel().addMetaUpdateListener(E);var a=this;P.getMapModel().addOnDateChangeListener(function(){a.pinData&&_({"status":"partial"})})}},this.collapse=function(){A.collapse()},this.getCardElement=function(){return A.getCardElement()},this.addExpandListener=function(e){A.addExpandListener(e)},this.addCollapseListener=function(e){A.addCollapseListener(e)},i()}var M="QC_Meta_Map_Detail",y=2,_={poiCardClearDates:function(a){if(a){var t=e(a).closest(".flexCard");t&&t.removeClass("withMeta")}var i=document.querySelector(".showPriceTxt"),r=document.querySelector(".mapsv2-detailmeta"),s=document.createElement("div");if(s){var o="mapsv2-showprices";n.retrieve("feature.flat_buttons_sitewide")&&(o="mapsv2-showprices_alt"),s.className=o,s.onclick=function(){c&&c.refetchAll()},i&&e(s).text(i.innerHTML),r&&(r.innerHTML="",e(r).appendTo(s))}},sponsorDatesCallback:function(){var e=document.getElementById("mapsv2-sponsordetail");e&&!n.retrieve("multiDP.priorDates")&&r.trackEventOnPage("FloatingMap","sponsor_info_checkrates",e.getAttribute("data-sponsor"))}};return p.exportTo(_,"ta.mapsv2.DetailCard"),C});
define("maps/cards/InfoCard",["lib/jquery-amd","maps/cards/MapCard","utils/ajax"],function(e,n,t){"use strict";function i(i,a,d){function s(){f.setCardClass("mapsv2-infocard "+v)}function r(){return p.fireMapEvent("locationCleared",[u,!1]),!1}function o(n){var t=e(f.getCardContent());t.html(n);var i=e(f.getCollapsedContent());i.empty();var a=t.find(".collapsedView");if(a.length>0&&(i.append(a),a.find(".mapsv2-collapsedheader").on("click",f.expand.bind(f))),e(f.getCardElements(".mapsv2-closebutton")).on("click",m),f.show(),p.fireMapEvent("afterLocationSelected",u),require.defined("maps/performanceMetrics")){var d=require("maps/performanceMetrics");d.detailCardShown(u.id)}}function c(){if(f.hide(),u){var e=getBaseMapsUrl(C,u.id,window.pageServlet);e+=n.buildHomePinParam(p.getMapModel()),e+="&ext=true",t({url:e,method:"get",success:function(e){h(e)}})}}function l(e){if(e&&(e.poiType===v||e.item&&e.item.type===v||e.item&&e.item[g])){if(u&&e.id===u.id&&!f.isHidden())return void f.expand();u=e,c(),f.expand()}else f.hide()}var p,u,f=new n(!0),h=o,m=r,C=i,v=a,g=d;this.getPinData=function(){return u},this.updateContent=function(e,n){o(e,n)},this.setUpdateListener=function(e){h=e},this.close=function(){r()},this.setCloseListener=function(e){m=e},this.bindToManager=function(e){p=e,f.bindToManager(e),p.addMapEventListener("locationSelected",l),p.addMapEventListener("locationCleared",f.hide.bind(f)),p.addMapEventListener("userPinDropped",l),c()},this.show=function(){f.show()},this.isCollapsed=function(){return f.isCollapsed()},this.collapse=function(){f.collapse()},this.getCardElement=function(){return f.getCardElement()},this.addExpandListener=function(e){f.addExpandListener(e)},this.addCollapseListener=function(e){f.addCollapseListener(e)},s()}return i});
define("maps/cards/InfoCardVR",["lib/jquery-amd","utils/ajax","ta/util/Element","maps/cards/InfoCard","ns-exporter"],function(e,t,n,a,r){"use strict";function i(a){var r=e("#VR_MAP_CARD_PRICE");if(0!==r.length){r.hide(),e(".mapsv2-showprices").hide();var i=e(".mapsv2-loading");if(0!==i.length){i.show();var o=document.querySelector(".vacationrental .meta_card"),s=getBaseMapsUrl("getVRPrice",a,window.pageServlet);t({url:s,methdod:"get",success:function(t){i.hide(),r.html(t),r.show(),setTimeout(function(){n.makeTextFitOneLine(".mapsv2-chevron .price")},0),o&&e(o).addClass("VRRateShown")},error:function(){i.hide()}})}}}function o(e,t,n){function r(){s.setUpdateListener(o)}function o(e){s.updateContent(e),s.getCardElement().querySelector(".mapsv2-showprices")||i(s.getPinData().id)}var s=new a(e,t,n);this.bindToManager=function(e){s.bindToManager(e)},this.collapse=function(){s.collapse()},this.getCardElement=function(){return s.getCardElement()},this.addExpandListener=function(e){s.addExpandListener(e)},this.addCollapseListener=function(e){s.addCollapseListener(e)},r()}var s={VRClearDates:function(){var t=document.querySelector(".vacationrental .meta_card"),n=document.querySelector(".vacationrental .mapsv2-showprices"),a=document.getElementById("VR_MAP_CARD_PRICE");if(n)e(n).show();else{var r=document.createElement("div"),i=document.querySelector(".showPriceTxt");r&&(r.className="mapsv2-showprices"),i&&e(r).text(i.innerHTML),t&&e(r).appendTo(t)}t&&e(t).removeClass("VRRateShown"),a&&e(a).hide()},getVRPrice:function(e){i(e)}};return r.exportTo(s,"ta.mapsv2.InfoCard"),o});
define("maps/cards/InfoCardNeighborhood",["lib/jquery-amd","ta/Core/TA.Record","maps/cards/InfoCard"],function(e,n,o){"use strict";function a(a,t,i){function r(){g.setUpdateListener(c),g.setCloseListener(s)}function d(){l.toggleMapLayer("neighborhood",!0),l.fireMapEvent("locationCleared",[g.getPinData(),!0]),n.trackEventOnPage("dynamic_large_map","neighborhood_card_click","more_neighborhoods")}function c(n){g.updateContent(n),e(g.getCardElement()).find(".mapsv2-moreneighborhoods").on("click",d)}function s(){n.trackEventOnPage("dynamic_large_map","neighborhood_card_click","close"),g.close()}var l,g=new o(a,t,i);this.bindToManager=function(e){l=e,g.bindToManager(e)},this.collapse=function(){g.collapse()},this.getCardElement=function(){return g.getCardElement()},this.addExpandListener=function(e){g.addExpandListener(e)},this.addCollapseListener=function(e){g.addCollapseListener(e)},r()}return a});
define("maps/cards/FiltersUtil",["lib/jquery-amd","ta/Core/TA.Store","ns-exporter"],function(e,t,o){"use strict";function a(e){if(e.nextElementSibling)return e.nextElementSibling;do e=e.nextSibling;while(e&&1!==e.nodeType);return e}function r(o,a){"price"===o||"hotel_class"===o||t.retrieve("mapsv2.map_is_on_vr")||e(e(a).find(".map-filter-tag.selected:not(.sponsored)").get().reverse()).each(function(t,o){o=e(o);var a=o.parent();o.detach().prependTo(a)})}var n={putSelectedTagsOnTop:r,toggleMore:function(t,o,r){o=e(o);var n=o.parent(),i=!o.hasClass("hidden-tile");if(r&&!i||!r&&i){do o.toggleClass("hidden-tile"),o=a(o);while(o);n.toggleClass("scrollable",i),i&&e(n).animate({scrollTop:n.offset()+n.height()},500)}},toggleExpandFilter:function(t,o,a){t.stopPropagation?t.stopPropagation():t.cancelBubble=!0,e(".map_filter_bar.jfy_filter_bar_"+a).first().toggleClass("expanded")},toggleTab:function(t,o){var a=o.getAttribute("data-locationType"),n=".map_filter_bar.jfy_filter_bar_neighborhood",i={"popular":e(n+" .location_popular"),"neighborhood":e(n+" .location_neighborhood"),"attraction":e(n+" .location_attraction")},l={"popular":e(n+" .lnk_popular"),"neighborhood":e(n+" .lnk_neighborhood"),"attraction":e(n+" .lnk_attraction")};for(var s in i)if(i.hasOwnProperty(s)){var p=i[s];if(p.length>0){var g=s===a;p.toggleClass("hidden",!g),g&&r(a,p[0]),l[s].toggleClass("selected",g)}}}};return o.exportTo(n,"ta.mapsv2.FiltersUtil"),n});
define("maps/cards/FiltersMapCard",["lib/jquery-amd","maps/cards/MapCard","ta/util/Error","ta/Core/TA.Record","ta/Core/TA.Store","maps/cards/FiltersUtil","ta/util/LegacyDateShim","ta/util/I18N","ns-exporter"],function(e,t,a,i,n,r,l,o,s){"use strict";function c(e){var t=g[e];return t?t:e}function d(t,i){try{var n;if("price"===t)n="vrPriceRangeMax";else{if("beds"!==t)return;n="vrBedroomsMin"}if(e("div."+n+".selected").each(function(t,a){e(a).removeClass("selected")}),!i)return;var r;"price"===t?r=i[1]:"beds"===t&&(r=i[0]);var l=t+"_"+r+"_map_item";e("div."+l).each(function(t,a){e(a).addClass("selected")})}catch(e){a.record(e,"Unable to update filter list display for VR maps")}}function f(t,i){try{if(e("div."+t+"_map_filter_item.selected").each(function(t,a){e(a).removeClass("selected"),a.firstElementChild&&(a.firstElementChild.checked=!1)}),!i)return;for(var n=0;n<i.length;n++){var r=t+"_"+i[n]+"_map_lbl";e("div."+r).each(function(t,a){e(a).addClass("selected"),a.firstElementChild&&(a.firstElementChild.checked=!0)})}}catch(e){a.record(e,"Unable to update filter set display for VR maps")}}function p(e){var t=e.getVRSelectedFilters();if(t)for(var a in t)if(t.hasOwnProperty(a)){var i=t[a];"beds"===a||"price"===a?d(a,i):f(a,i)}}function u(a){function s(){S.setCardClass("mapsv2-filterscard");var t=a.getOrigOps();M=t.filtersType,O=document.querySelector(".filters_enabled_flyout"),O&&e(O).hide().appendTo(S.getCardElement()),w=document.querySelector(".no_pins_flyout"),e(w).hide().removeClass("hidden"),t.p13NFilters?(k={jfy_amenities:"a",brand:"b",neighborhood:["t","d","r"],hotel_class:"s",style:["t","y"]},n.retrieve("hotels_map_price_filter")&&(k.price="p")):k={style:"zff",user_rating:"trating",neighborhood:"zfn",hotel_class:"zfc",jfy_amenities:"zfa",brand:"zfb",cuisine:"cat",dining_options:["opt","zfp"],price:"pid",attraction:"cat",activity:"cat",nightlife:"cat"}}function d(t,a,s,d){if(!P[a]){var f=d("MAP_FILTER_OVERLAY_"+a),u=n.retrieve("tablet_maps_v1"),g=!1;if(null!=f){var _=document.createElement("div");_.className="jfy_filter_bar_top_arrow map-filter-arrow-"+a;var v=document.createElement("div");v.className="jfy_filter_bar_top_spacer",v.insertBefore(_,null);var m=document.createElement("div");m.className="map_filter_bar jfy_filter_bar_"+a,m.innerHTML=f.innerHTML,"price"===a&&(e(f.querySelectorAll(".date_picker")).each(function(e,t){t.id="dummy-"+t.id}),e(m.querySelectorAll(".date_picker")).each(function(e,t){t.id=t.id.replace("dummy-","")}));var h=document.createElement("div");if(h.insertBefore(v,null),h.insertBefore(m,null),u&&("brand"===a||"jfy_amenities"===a||"neighborhood"===a||"cuisine"===a||"dining_options"===a)){var C=document.createElement("div");C.className="map_filter_bar_gradient",h.insertBefore(C,null),e(h).find(".map_filter_bar").addClass("map_moveableBlock")}g=u&&pageServlet&&("Attractions"===pageServlet||"Attraction_Review"===pageServlet||"ShowUserReviewsAttractions"===crPageServlet),require(["overlays/Overlay","overlays/styles/modal","overlays/position","overlays/options/autoReposition","overlays/options/closeOnDocClick","overlays/options/closeOnSourceClick","overlays/options/closeOnEscape"],function(d,f,_,v,m,C,y){var b;b=o.isRtl()&&!u?158:g?o.isRtl()?150:350:-9;var M=P[a]=new d(t,[f(t,"below","jfy_filter_bar_top dg map-filter-overlay no_padding small","","",h.innerHTML),_.bottomRight([b,g?66:-3]),v,y,C,g?null:m]);if(u){var k=e(".footerPocketWithInsert");k.is(":visible")&&(M.domParent=k.get(0))}var O=e(t);O.on("click",M.show.bind(M));var w,F=function(){w||(w=setTimeout(function(){M.hide(),w=0},1e3))},T=function(){w&&clearTimeout(w),w=0},R=e(M.container);M.on("show",function(){if("price"===a&&R.find(".price_filter_buckets").length>0){var o=l.hasPageDates();e(".price_filter_buckets").toggleClass("hidden",!o),e(".price_filter_calendar").toggleClass("hidden",o),R.trigger("updated")}else"hotel_class"!==a&&r.putSelectedTagsOnTop(a,R.get(0));if("neighborhood"===a){var s=R.find(".location_title");s&&0===s.find(".location_lnk.selected").length&&r.toggleTab(null,s.find(".lnk_popular").get(0)),R.toggleClass("with-tabs",s)}t&&n.retrieve("tablet_maps_v1")&&O.addClass("active"),L=M,O.on("mousemove",T),O.on("mouseout",F),R.on("mousemove",T),R.on("mouseout",F);var d=c(a);i.trackEventOnPage("Filters_Map","open",d),p(E.getMapModel())}).on("hide",function(){i.trackEventOnPage("Filters_Map","close",c(a)),g&&e(S.getCardElement()).toggleClass("mapsv2-cardcollapsed",!0),O.off("mousemove",T),O.off("mouseout",F),R.off("mousemove",T),R.off("mouseout",F),t&&n.retrieve("tablet_maps_v1")&&O.removeClass("active")}),R.find(".map-filter-tag").each(function(t,n){n=e(n),n.on("click",function(e){if(n.hasClass("sponsored")){var t=n.attr("data-tracking-action");i.trackEventOnPage("Filters_Map",n.hasClass("selected")?"unclick":"click",t),s.toggleSponsorFilter(e,n)}else"Hotels"===window.pageServlet&&i.trackEventOnPage("Filters_Map","selected_filter","Hotels");n.toggleClass("selected");var r=n.get(0).id.substring(4).split("_");s.toggleFilter(r[0],r[1]);var l;l="style"===a&&n.attr("data-name")?"Style_"+n.attr("data-name").toLowerCase():"attraction"===a||"activity"===a||"nightlife"===a?a+"_"+r[1]:c(r[0])+"_"+r[1],i.trackEventOnPage("Filters_Map",n.hasClass("selected")?"click":"unclick",l)})}),R.on("updated",function(){M.reposition()})})}else require(["overlays/Overlay","overlays/styles/tooltip","overlays/position","overlays/options/autoReposition","overlays/options/closeOnDocClick","overlays/options/closeOnSourceClick","overlays/options/closeOnEscape"],function(n,r,l,o,s,c,d){var f=document.querySelector(".tile_disabled_flyout_text"),p=P[a]=window.price_overlay=new n(t,[r(t,"right","tile_disabled_flyout no_padding small",f&&f.innerHTML),l.right(),o,d,c,g?null:s]);"price"===a&&p.on("show",i.trackEventOnPage.bind(null,"Filters_Map","open",a)),e(t).on("click",p.show.bind(p))})}}function f(){S.hide();var e=E.getMapModel();e.buildRequest("filtersCard"+M,function(e){h(e)},"post").get()}function u(){var e=E.getMapModel();S.toggleVisibility(!E.getMapController().getCustomFilter()&&e.isFiltersEnabled())}function g(t){if(t&&R&&T){var a,n=S.getCardContent(),r=0,l={},o=function(e){if(t.hasOwnProperty(e)){var a=t[e];if("number"==typeof a){var i=a;l["map_"+e+"_"+i]=i}else if(a&&a.length>0){var n=a.split(",");n.forEach(function(t){l["map_"+e+"_"+t]=t})}}},s=function(e,t){var i=l.hasOwnProperty(t.id);a+=i?1:0,t.toggleClass("selected",i)};for(var c in k)if(k.hasOwnProperty(c)){a=0;var d=P[c];if(d){l={};var f=k[c];"function"==typeof f.forEach?f.forEach(o):o(f);var p=e(d.container);Object.keys(l).length>0?(p.find(".map-filter-tag").each(s),p.find(".location_title").length>0&&p.find(".location_popular").length>0&&(a/=2)):p.find(".map_filter_bar .map-filter-tag").removeClass("selected")}r+=a;var u=e(n).find(".map-filter-tile."+c).first();u&&(u.find(".jfy_filter_bar_jewel").toggleClass("hidden",!a).text(a),u.find(".map-filter-icon").toggleClass("hasJewel",a))}var g=r>0,_=!1;if(e(S.getCardElements(".filter-counter")).each(function(t,a){e(a).text(r)}),e(S.getCardElement()).toggleClass("has-filters",g),w){var v=E.getMapView(),m=E.getMapModel();_=!(m.hasVisiblePOIPins(v)||m.getSelectedPin()&&v.isProviderMarkerInView(m.getSelectedPin().id)),_?(e(w).fadeIn(),i.trackEventOnPage("dynamic_large_map","No_Pin_Warning")):e(w).fadeOut()}if(F){F=!1,i.trackEventOnPage("Filters_Map","open_map",g?"filters_applied":"no_filters_applied");var h=window.pageServlet;"Hotels"===h&&(i.trackEventOnPage("Map_Has_Filters",h||""),document.querySelector(".mapsv2-card.neighborhood")&&i.trackEventOnPage("Map_Has_Neighborhoods",h||"")),!_&&g&&S.isCollapsed()&&O&&(e(O).fadeIn(),window.setTimeout(function(){e(O).fadeOut()},4e3))}}}function _(){L&&L.hide(),S.collapse();var t=e(S.getCardElement()).find("#MORE_TILE");t&&r.toggleMore(null,t,!0)}function v(){_(),i.trackEventOnPage("Filters_Map","Close_Filter_Card",window.pageServlet||"")}function m(t){var a,i,n;if(t){var l=e("<div>").html(t);a=l.find("#FILTER_MAP_CARD_EXPANDED").get(0),i=l.find("#FILTER_MAP_CARD_COLLAPSED").get(0),n=function(e){return l.find("#"+e).get(0)}}else if(a=document.getElementById("FILTER_MAP_CARD_EXPANDED"),i=document.getElementById("FILTER_MAP_CARD_COLLAPSED"),n=function(e){return document.getElementById(e)},(!a||!i)&&M)return void f();if(!a||!i)return void S.toggleVisibility(!1);R=!0;var o=S.getCardContent();o.innerHTML=a.innerHTML,o.querySelector(".title").onclick=v;var s=S.getCollapsedContent();s.innerHTML=i.innerHTML,P={},e(o).find(".map-filter-tile").each(function(t,a){a=e(a);var i=a.attr("data-type");"more"!==i?a.hasClass("disabled")||d(a.get(0),i,E.getMapController(),n):a.on("click",function(e){r.toggleMore(e,a)})}),e(S.getCardElements(".clear-filters")).each(function(t,a){e(a).on("click",function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0,e.preventDefault?e.preventDefault():e.returnValue=!1,E.getMapController().clearFilters()})}),t&&(g(E.getMapModel().getFilters()),u())}function h(e){F=!0,m(e)}function C(){L&&L.hide()}function y(e){T=!0,g(e.filterStateChanged)}function b(){S.expand();var e=window.pageServlet;i.trackEventOnPage("Filters_Map","Open_Filter_Card",e||"")}var E,M,k,P,O,w,L,S=new t,F=!1,T=!1,R=!1;this.bindToManager=function(e){E=e,S.bindToManager(e),S.addCollapsedContentListener("click",b),E.addMapEventListener("filtersVisibilityChanged",u),E.addMapEventListener("openingMap",h),E.addMapEventListener("mapClosed",C),E.getMapModel().addUpdateListener(y)},this.collapse=function(){_()},this.getCardElement=function(){return S.getCardElement()},this.addExpandListener=function(e){S.addExpandListener(e)},this.addCollapseListener=function(e){S.addCollapseListener(e)},s()}var g={"zfn":"neighborhood","d":"neighborhood","r":"neighborhood","zfc":"hotel_class","hotel-class":"hotel_class","s":"hotel_class","zfa":"amenities","jfy_amenities":"amenities","a":"amenities","zfb":"hotel_brand","brand":"hotel_brand","b":"hotel_brand","zff":"styles","style":"styles","prng":"price","trating":"traveler_rating","user-rating":"traveler_rating","cat":"cuisine","pid":n.retrieve("hotels_map_price_filter")?"active_price":"price","zfp":"dining_options","opt":"dining_options"},_={dateSelectedCallback:function(t,a){if(l.hasPageDates){var i=e(a).closest(".ui_overlay");i.find(".price_filter_calendar").addClass("hidden"),i.find(".price_filter_buckets").removeClass("hidden"),i.trigger("updated")}}};return s.exportTo(_,"ta.mapsv2.FiltersMapCard"),u});
define("maps/cards/ListCard",["lib/jquery-amd","maps/cards/MapCard","maps/utils/template","utils/ajax","ta/Core/TA.Store","ta/Core/TA.Event","ta/Core/TA.Record","ta/util/Error","ta/util/LegacyDateShim"],function(e,t,a,i,n,r,l,s,o){"use strict";function c(t,a){var i=t.getMapHeight();if(i>=0&&a&&a.style)try{var n=t.getSize().y,r=e(a).outerHeight(),l=n-r,o=Math.min(_,Math.max(h,i-63-20-l));a.style.maxHeight=o+"px"}catch(e){s.record(e,"error updating map list view card height")}}function d(){return o.datesInRange()}function v(e){var t="",a=e.activeSponsors;for(var i in a)a[i]&&(t+=(t.length>0?",":"")+i);return t}function p(t){return function(a){var a=a||window.event,i=a.target||a.srcElement;if(i=e(i).closest("[data-locid]"),i.length>0){var n=a.fromElement||a.relatedTarget;if(e.contains(i,n))return;t(i.attr("data-locid"))}}}function u(t,a){var a=a||window.event,i=e(a.target||a.srcElement),n=i.hasClass("mapsv2-unavail")||i.hasClass("mapsv2-noprices");!n&&i.closest(".mapsv2-listmeta").length>0||(i=i.closest("[data-locid]"),i.length>0&&t(i.attr("data-locid")))}function m(t){if(!t)return!1;var a=e.extend({},t.stickyPins,t.allPins);if(Object.keys(a).length>0){var i=!1,r=n.retrieve("mapsv2.map_is_on_vr");for(var l in a)if(a.hasOwnProperty(l)){var s=a[l];if(s.type){if(r&&"vacationrental"===s.type){i=!0;break}if("hotel"===s.type||0===s.type.indexOf("sponsor_")){i=!0;break}}}return i}return!1}function f(s){function f(){O.setCardClass("mapsv2-listcard"),e(H).detach(),O.initCardContentFromId("LIST_VIEW_EXPANDED"),O.initCollapsedContentFromId("LIST_VIEW_COLLAPSED"),O.addCollapseListener(_),O.addExpandListener(h);var t=e(O.getCardContent());t.find(".title").on("click",O.collapse.bind(O)).on("click",function(){l.trackEventOnPage("list_view_card","manual_collapse","",0)}),t.find(".listarea-availability-check").on("click",b),e(O.getCollapsedContent()).find(".title").on("click",function(){l.trackEventOnPage("list_view_card","manual_expand","",0)}),y(),A=t.find(".mapsv2-listarea").get(0)}function _(){l.trackEventOnPage("list_view_card","Collapse","",0)}function h(){I.toggleMapLayer("hotel",!0),c(I,A),l.trackEventOnPage("list_view_card","Expand","",0)}function y(){var t=n.retrieve(d()?"mapsv2.best_prices":"mapsv2.enter_dates"),a=I?getEntryCategory():"1",i=n.retrieve("1"===a?"mapsv2.list_hotels":"mapsv2.list_accom");1==n.retrieve("mapsv2.map_is_on_vr")&&(i=n.retrieve("mapsv2.list_vrs")),e(O.getCardContent()).find(".card-title-text").html(t).parent().prop("title",t),e(O.getCollapsedContent()).find(".card-title-text").html(i).parent().prop("title",i)}function C(){e(A).toggleClass("loading",!0)}function b(t){var a=O.getCardContent().querySelector(".availability-checkbox");t&&t.target!==a&&(t.preventDefault?t.preventDefault():t.returnValue=!1,a.checked=!a.checked),a&&(I.getMapModel().toggleUnavailPinVisibility(a.checked),l.trackEventOnPage("only_show_confirmed_availability",a.checked?"On":"Off","",0)),e(".not_avail").toggle(!a.checked)}function M(){if(!I.getMapModel().isUsingUnifiedDates()){var e=O.getCardContent(),t=e.querySelector('[data-datetype="CHECKIN"] .date_picker'),a=e.querySelector('[data-datetype="CHECKOUT"] .date_picker'),i=o.getPageInDate(),r=o.getPageOutDate(),l=o.getDatePickerFormat("classic");t.innerHTML=i?o.dateToString(i,l):n.retrieve("multiDP.checkIn"),a.innerHTML=r?o.dateToString(r,l):n.retrieve("multiDP.checkOut")}}function L(e,t){if(y(),!t||"invalid"===t.status)return a(H,"mapsv2-noprices");if("empty"===t.status)return a(H,"mapsv2-noprices");if("partial"===t.status)return a(H,"mapsv2-loading");if(0===t.availCount&&0===t.maybeAvailCount){var i=n.retrieve("mapsv2.no_availailability_from_partners");return a(H,"mapsv2-unavail",{sold_out_text:i})}var r=t.data;if(r&&r.length>0){var l="",s="",o="",c=/%availability%/;r.forEach(function(t,i){if(0!==i){var n=i===r.length-1?"last":"";"maybe"===t.available?n+=" maybe":"false"===t.available&&(n+=" unavail"),o="true"===t.available?"Available":"false"===t.available?"Not_Avail":"Maybe_Avail",s=g.replace(c,o);var d="";d="false"===t.available?'<span class="sprite-noAvailability"></span>':t.displayPrice?t.displayPrice:'<span class="sprite-visitSite"></span>',l+=a(H,"mapsv2-dropdownitem",{providername:t.vendor,offer_author_name:t.author,price:d,contentid:t.contentId,locationid:e,clickdata:t.commerceClickData,navarea:s,addclass:n,openbehavior:t.openBehavior})}},this);var d="";return d=r[0].displayPrice?r[0].displayPrice:'<span class="sprite-visitSite-black"></span>',o="true"===r[0].available?"Available":"false"===r[0].available?"Not_Avail":"Maybe_Avail",s=g.replace(c,o),a(H,"mapsv2-metadropdown",{providername:r[0].vendor,offer_author_name:r[0].author,price:d,contentid:r[0].contentId,locationid:e,clickdata:r[0].commerceClickData,navarea:s,listitems:l,addclass:"true"===r[0].available?"":"maybe",openbehavior:r[0].openBehavior})}return a(H,"mapsv2-noprices")}function E(e,t){if(y(),!t||"invalid"===t.status)return a(H,"mapsv2-noprices");if("success"===t.status&&t.minRateDisplay){var i=n.retrieve("mapsv2.vr_rate_period_map");return a(H,"mapsv2-vrprice",{rate_price:t.minRateDisplay,rate_periodicity:i[t.ratePeriodicityIndex]})}return a(H,"mapsv2-noprices")}function k(){var t=e(A).find("li"),a=function(e){var t=!0;if(e){var a=e.querySelector(".mapsv2-dropdownfirstitem");!a||a.classList.contains("maybe")||a.classList.contains("unavail")||(t=!1)}t?e.classList.add("not_avail"):e.classList.remove("not_avail")};if(n.retrieve("mapsv2.map_is_on_vr")){var i=I.getMapModel().getVRACInfo();if(!i)return;t.each(function(e,t){var a=t.getAttribute("data-locid"),n=E(a,i[a]);if(n){var r=document.querySelector(".listitem_"+a+" .mapsv2-listmeta");r&&(r.innerHTML=n)}})}else{var l=I.getMapModel().getMetaInfo();if(!l)return;t.each(function(e,t){var i=t.getAttribute("data-locid"),n=L(i,l[i]);if(n){var r=document.querySelector(".listitem_"+i+".mapsv2-listitem");if(r){var s=r.querySelector(".mapsv2-listmeta");s&&(s.innerHTML=n,a(r))}}}),r.fireEvent("MapListMetaComplete")}}function P(t){if(!n.retrieve("mapsv2.map_is_on_vr")&&A&&t){var a=e(A);a.toggleClass("loading",!0);var i=a.find("li");if(i.length>0){a.empty();var r={};i.each(function(e,t){r[t.getAttribute("data-locid")]=t});for(var l=0;l<t.length;l++){var s=r[t[l]];s&&a.append(s)}}a.toggleClass("loading",!1)}}function S(t){var a=e(A);a.empty().append(t),d()&&(k(),P(I.getMapModel().getHotelSortOrder())),V=!1,e(A).toggleClass("loading",!1)}function w(t){if(!V){var a=getBaseMapsUrl("listView",s,window.pageServlet,!0),r=v(I.getMapModel());r&&(a+="&sponsors="+r);var l=e.extend({},t.stickyPins,t.allPins),o=[];for(var c in l)if(l.hasOwnProperty(c)){var d=l[c];d.type&&("hotel"===d.type||"home"===d.type||n.retrieve("mapsv2.map_is_on_vr")&&"vacationrental"===d.type||0===d.type.indexOf("sponsor_"))&&o.push(c)}o&&o.length>0&&(V=!0,i({url:a,method:"post",success:S.bind(this),error:function(){V=!1},data:{locs:o.join(",")}}))}}function T(){d()&&!n.retrieve("mapsv2.map_is_on_vr")&&(O.getCardContent().querySelector(".listarea-availability-check").style.display="block")}function x(t){if(t){var a=m(t),i=e(O.getCardContent()).find(".mapsv2-listempty");if(!a)return A.innerHTML="",void i.show();i.hide(),w(t),T()}}function D(){I.isMapLayerVisible("hotel")||n.retrieve("mapsv2.map_is_on_vr")&&I.isMapLayerVisible("vacationrental")||O.collapse()}var I,A,O=new t(!1),H=document.getElementById("LIST_VIEW_TEMPLATES"),V=!1;this.bindToManager=function(t){function a(e){i.fireMapEvent("locationSelected",[i.getModel().getPinData(parseInt(e)),!1,!0])}I=t,O.bindToManager(I,!0),I.addMapEventListener("locationCleared",function(e,t){t&&(I.isMapLayerVisible("hotel")||n.retrieve("mapsv2.map_is_on_vr")&&I.isMapLayerVisible("vacationrental"))?O.expand():O.collapse(),M(),O.show()}),I.addMapEventListener("locationSelected",function(e){e&&("hotel"===e.poiType||e.item&&("hotel"===e.item.type||e.item.isLodging))&&O.hide()}),I.addMapEventListener("openingMap",M);var i=I.getMapController();e(A).on("click",u.bind(this,a)).on("mouseover",p(i.handlePinHover.bind(i))).on("mouseout",p(i.handlePinBlur.bind(i)));var r=i.getModel();r.addPinUpdateListener(x),r.addMetaUpdateListener(k),r.addMetaRequestListener(C),r.addHotelSortChangeListener(P),r.addOnDateChangeListener(T),I.addMapEventListener("layersToggled",D),I.addMapEventListener("mapWindowResized",c.bind(this,I,A)),D(),x()},this.collapse=function(){O.collapse()},this.getCardElement=function(){return O.getCardElement()},this.addExpandListener=function(e){O.addExpandListener(e)},this.addCollapseListener=function(e){O.addCollapseListener(e)},f()}var g="QC_Meta_Mini|Text|%availability%|map_list|Desktop",_=900,h=200;return f});
define("maps/cards/ListCardRoadtrip",["lib/jquery-amd","maps/cards/MapCard","maps/utils/template","utils/ajax","ta/Core/TA.Store","ta/Core/TA.Event","ta/Core/TA.Record","ta/util/Error","ta/util/LegacyDateShim"],function(t,e,a,i,n,r,o,l,s){"use strict";function d(){return s.datesInRange()}function p(t){var e="",a=t.activeSponsors;if(a)for(var i in a)a[i]&&(e+=(e.length>0?",":"")+i);return e}function c(t,e){for(var a=[],i=0;i<e.length;i++)t[e[i]]&&a.push(t[e[i]]);return a}function v(t,e){var a=t.getMapHeight();if(a>=0&&e&&e.style)try{var i=Math.min(h,Math.max(y,a-63-166-20));e.style.maxHeight=i+"px"}catch(t){l.record(t,"error updating map list view card height")}}function u(e){return function(a){var a=a||window.event,i=a.target||a.srcElement;if(i=t(i).closest("[data-locid]"),i.length>0){var n=a.fromElement||a.relatedTarget;if(t.contains(i,n))return;e(i.attr("data-locid"))}}}function m(e){if(e){e=t(e),e.addClass("hotel-featured");var a=e.find(".mapsv2-listinfo");if(a){a.find(".sponsored").remove();var i=document.createElement("span");i.innerHTML="Sponsored",i.className="sponsored",a.prepend(i)}}}function f(e,a){var a=a||window.event,i=t(a.target||a.srcElement),n=i.hasClass("mapsv2-unavail")||i.hasClass("mapsv2-noprices");!n&&i.closest(".mapsv2-listmeta").length>0||(i=i.closest("[data-locid]"),i.length>0&&e(i.attr("data-locid")))}function g(s){function g(){F.setCardClass("mapsv2-listcardroadtrip"),F.initCardContentFromId("LIST_VIEW_EXPANDED"),F.initCollapsedContentFromId("LIST_VIEW_COLLAPSED"),n.has("roadtrip.id")&&(U=n.retrieve("roadtrip.id")),n.has("roadtrip.featuredHotels")&&(z=n.retrieve("roadtrip.featuredHotels")),F.addCollapseListener(L),F.addExpandListener(M);var e=F.getCardContent();j=e.querySelectorAll(".list-toggle-types .toggleType"),t(j).on("click",function(t){var e=t.target&&t.target.getAttribute("data-type")||null;e&&H(e)}),h(),O=e.querySelector(".mapsv2-listarea")}function h(){var e=R?getEntryCategory():"1",a=n.retrieve("1"===e?"mapsv2.list_hotels":"mapsv2.list_accom");n.retrieve("mapsv2.map_is_on_vr")===!0&&(a=n.retrieve("mapsv2.list_vrs")),t(F.getCollapsedContent()).find(".card-title-text").html(a).parent().prop("title",a)}function y(){t(O).toggleClass("loading",!0)}function b(t,e){o.trackEventOnPage("roadtrip_map",t?t:"unknown_action",e?e:"",U)}function L(){o.trackEventOnPage("list_view_card_roadtrip","Collapse","",0)}function M(){v(R,O),o.trackEventOnPage("list_view_card_roadtrip","Expand","",0)}function P(e){var a=0;if(e){var i=t(e).closest(".mapsv2-listitem");return i&&(a=i.attr("data-locid")?i.attr("data-locid"):0),a}}function T(t,e){if(h(),!e||"invalid"===e.status)return a(N,"mapsv2-noprices");if("empty"===e.status)return a(N,"mapsv2-noprices");if("partial"===e.status)return a(N,"mapsv2-loading");if(0===e.availCount&&0===e.maybeAvailCount){var i=n.retrieve("mapsv2.no_availailability_from_partners");return a(N,"mapsv2-unavail",{sold_out_text:i})}var r=e.data;if(r&&r.length>0){for(var o="",l="",s="",d=/%availability%/,p=1;p<r.length;p++){var c=r[p],v=p===r.length-1?"last":"";"maybe"===c.available?v+=" maybe":"false"===c.available&&(v+=" unavail"),s="true"===c.available?"Available":"false"===c.available?"Not_Avail":"Maybe_Avail",l=_.replace(d,s);var u="";u="false"===c.available?'<span class="sprite-noAvailability"></span>':c.displayPrice?c.displayPrice+"*":'<span class="sprite-visitSite"></span>',o+=a(N,"mapsv2-dropdownitem",{providername:c.vendor,offer_author_name:c.author,price:u,contentid:c.contentId,locationid:t,clickdata:c.commerceClickData,navarea:l,addclass:v,openbehavior:c.openBehavior})}var m="";return m=r[0].displayPrice?r[0].displayPrice+"*":'<span class="sprite-visitSite-black"></span>',s="true"===r[0].available?"Available":"false"===r[0].available?"Not_Avail":"Maybe_Avail",l=_.replace(d,s),a(N,"mapsv2-metadropdown",{providername:r[0].vendor,offer_author_name:r[0].author,price:m,contentid:r[0].contentId,locationid:t,clickdata:r[0].commerceClickData,navarea:l,listitems:o,addclass:"true"===r[0].available?"":"maybe",openbehavior:r[0].openBehavior})}return a(N,"mapsv2-noprices")}function E(){var e=O.querySelectorAll("li"),a=R.getMapModel().getMetaInfo();if(a){var i=function(e,a){(e.indexOf("mapsv2-unavail")>-1||e.indexOf("mapsv2-noprices")>-1||e.indexOf("maybe")>-1)&&t(a).addClass("not_avail")};t.each(e,function(e,n){var r=t(n).attr("data-locid"),o=T(r,a[r]);if(o){var l=document.querySelector(".listitem_"+r+" .mapsv2-listmeta");if(l){l.innerHTML=o;var s=t(l).closest(".listitem_"+r);i(o,s)}}}),r.fireEvent("MapListMetaComplete")}}function w(t){var e,a={},i=O.querySelectorAll("li");for(e=0;e<i.length;e++){var n=i[e].getAttribute("data-locid");if(z)for(var r=0;r<z.length;r++)z[r].toString()===n&&(i[e].isFeatured=!0,m(i[e]));a[n]=i[e]}var o=c(a,t),l=document.createDocumentFragment(),s=document.createDocumentFragment();for(e=0;e<o.length;e++)o[e].isFeatured===!0?s.appendChild(o[e]):l.appendChild(o[e]);l.childNodes.length>0&&(O.innerHTML="",s.appendChild(l.cloneNode(!0)),O.appendChild(s.cloneNode(!0)))}function k(e){var a=n.has("roadtrip.order")&&n.retrieve("roadtrip.order")[e]||[];a.length>0&&O.querySelectorAll("li").length>0&&(t(O).toggleClass("loading",!0),w(a),t(O).toggleClass("loading",!1))}function A(e){var a=t(O);a.empty().append(e),"hotel"===B&&d()&&E(),k(B),D=!1,a.toggleClass("loading",!1)}function S(e){if(!D){var a=getBaseMapsUrl("listView",s,window.pageServlet,!0),n=p(R.getMapModel());n&&(a+="&sponsors="+n);var r=C[B]?C[B].reqListType:null;r&&(a+="&placetype="+r);var o=t.extend({},e.stickyPins,e.allPins),l=[];for(var d in o)if(o.hasOwnProperty(d)){var c=o[d];c.type&&(c.type===B||c.type.indexOf("sponsor")>-1&&"hotel"===B)&&l.push(d)}l&&l.length>0&&(D=!0,i({url:a,method:"post",success:A,error:function(){D=!1},data:{locs:l.join(",")}}))}}function x(t){var e=t&&t.getProviderMap();if(e){var a=n.retrieve("roadtrip.routeData");if(a&&a.from&&a.to){var i=a.from,r=a.to,o=a.waypoints;t.zoomAndPanToFitLocations([new ta.maps.util.GeoPoint(i[0],i[1]),new ta.maps.util.GeoPoint(r[0],r[1])]),t.renderRoute(i,r,o,null,function(t){var e=R.getMapController(),a={locId:"roadtrip_start_pin",lat:t.startPinLatLng[0],lng:t.startPinLatLng[1],pinProminent:!0,hoverClass:"homeHover",customHover:{title:"Road trip start"}};e.addPin(a,"home_roadtrip",!1);var i={locId:"roadtrip_end_pin",lat:t.endPinLatLng[0],lng:t.endPinLatLng[1],pinProminent:!0,hoverClass:"homeHover",customHover:{title:"Road trip end"}};e.addPin(i,"home_roadtrip",!1),e.fireModelUpdate(),G=!0},function(t){l.record(t,"Couldn't render the Route.")})}}}function V(e){if(!e)return!1;var a=t.extend({},e.stickyPins,e.allPins);if(Object.keys(a).length>0){var i=!1;for(var n in a)if(a.hasOwnProperty(n)){var r=a[n];if(r.type&&(r.type==B||0===r.type.indexOf("sponsor_"))){i=!0;break}}return i}return!1}function I(e){if(e){var a=V(e),i=t(F.getCardContent()).find(".mapsv2-listempty");if(!a)return O.innerHTML="",void i.show();i.hide(),S(e)}G||x(R.getMapView())}function q(){var e=B,a=t(j);if(R.isMapLayerVisible("hotel")?(B="hotel",a.removeClass("active"),a.eq(0).addClass("active")):R.isMapLayerVisible("restaurant")?(B="restaurant",a.removeClass("active"),a.eq(1).addClass("active")):R.isMapLayerVisible("attraction")?(B="attraction",a.removeClass("active"),a.eq(2).addClass("active")):(B="none",F.collapse()),e!==B){var i=R.getMapModel(),n={allPins:i.getPins(),stickyPins:i.getStickyPins()};y(),I(n)}}function H(t){var e=R.getMapModel(),a=!1;switch(t){case"hotel":e.toggleTypeVisibility("hotel",!0),e.toggleTypeVisibility("restaurant",!1),e.toggleTypeVisibility("attraction",!1),a=!0;break;case"restaurant":e.toggleTypeVisibility("restaurant",!0),e.toggleTypeVisibility("hotel",!1),e.toggleTypeVisibility("attraction",!1),a=!0;break;case"attraction":e.toggleTypeVisibility("attraction",!0),e.toggleTypeVisibility("hotel",!1),e.toggleTypeVisibility("restaurant",!1),a=!0}a&&(b("toggle_location_type",t),q())}var O,D,R,F=new e(!1),N=document.getElementById("LIST_VIEW_TEMPLATES"),B="hotel",j=null,U=0,W=0,z=null,G=!1;this.bindToManager=function(e){function a(t){i.fireMapEvent("locationSelected",[i.getModel().getPinData(parseInt(t)),!1,!0])}R=e,F.bindToManager(R,!0),R.addMapEventListener("locationCleared",function(t,e){if(W=0,F.expand(),F.show(),t&&t.poiType&&"home"!==t.poiType){var a=e?"hide_location_more":"hide_location";b(a,t?t.id:null)}}),R.addMapEventListener("locationSelected",function(t){W=t.id||0,F.hide(),b("show_location",t.id)});var i=R.getMapController(),n=t(O);n.on("click",f.bind(this,a)).on("mouseover",u(i.handlePinHover.bind(i))).on("mouseout",u(i.handlePinBlur.bind(i)));var r=i.getModel();r.setLowerZoomLimit(!1),r.addPinUpdateListener(I),r.addMetaUpdateListener(E),r.addMetaRequestListener(y),r.addHotelSortChangeListener(k),R.addMapEventListener("layersToggled",q),R.addMapEventListener("mapWindowResized",v.bind(this,R,O)),q(),n.on("click","li.mapsv2-listitem .mapsv2-listmeta .mapsv2-dropdownfirstitem",function(){b("listview_meta_click",P(this)+"_"+this.getAttribute("data-vendorname"))}),n.on("click","li.mapsv2-listitem .mapsv2-listmeta .mapsv2-listbutton",function(){b("listview_meta_list_click",P(this))}),n.on("click","li.mapsv2-listitem .mapsv2-listmeta .ui_button",function(){b("listview_showprice_click",W)}),I()},this.collapse=function(){F.collapse()},this.getCardElement=function(){return F.getCardElement()},this.addExpandListener=function(t){F.addExpandListener(t)},this.addCollapseListener=function(t){F.addCollapseListener(t)},g()}var h=900,y=200,_="QC_Meta_Mini|Text|%availability%|map_list|Desktop",C={"hotel":{reqListType:"Accommodation"},"restaurant":{reqListType:"Eatery"},"attraction":{reqListType:"Attraction"}};return g});
define("maps/POIMapController",["ta/util/ajax","ta/Core/TA.Store","ta/Core/TA.Record","ta/Core/TA.Event","ta/util/Error","ta/util/ActionRecord","ta/util/I18N","maps/BasicMapController","maps/POIMapModel","maps/POIMapView","maps/cards/CardManager","maps/cards/LayersMapCard","maps/cards/NeighborhoodListCard","maps/cards/DetailCard","maps/cards/InfoCard","maps/cards/InfoCardVR","maps/cards/InfoCardNeighborhood","maps/cards/FiltersMapCard","maps/cards/ListCard","maps/cards/ListCardRoadtrip"],function(e,t,i,o,n,a,r,s,l,d,c,p,g,v,u,m,f,y,h,P){"use strict";function w(w,C){function T(e){var i="inner_poi_map";(e.origOps.isEatery||e.origOps.noSponsors)&&(i+=" no_sponsors"),"Tourism"!==e.servlet&&(i+=" hasTravelTime");var n=!1;e.isTabletMaps&&(n=ta.common.tablet&&ta.common.tablet.isManualOverlayZoom(),fe=Te,C.mapDiv.addEventListener("touchstart",function(){var e=document.getElementById("MAP_ADD_LOCATION_INPUT"),t=document.querySelector(".map_typeahead");e&&t&&t.hasClass("visible")&&e.blur()})),Se.inline?(me={innerDivClass:i,content:C.floatContent.getChildren(),container:C.floatContent},Ce=!0,_e(Pe),I(e)):require(["overlays/Overlay","overlays/styles/modal","overlays/position","overlays/options/autoReposition","overlays/options/closeOnEscape","overlays/styles/windowshade"],function(a,r,s,l,d,c){var p=i+" footerPocketWithInsert no_padding";me=new a(null,[r(null,"center",p,"","",C.floatContent),s.framed(e.isTabletMaps&&!n?[0,0]:[fe,fe]),l,d,e.isTabletMaps?null:c()]),C.floatContent.style.display="block",me.container.querySelector(".ui_close_x").removeClass("ui_close_x").addClass("sprite-map_close").setStyle("position","absolute"),me.container&&me.container.setStyle("z-index",9996),me.shade&&me.shade.setStyle("z-index",9995),me.on("show",function(){Ce=!0,_e(Pe);var i=t.retrieve("mapProviderFeature.maps_api");(i&&"ta-maps-autonavi"===i||e.isTabletMaps)&&window.scrollTo(0,0),o.fireEvent("mapOverlayOpened")}).on("hide",$.bind(Pe)),me.show(),I(e)})}function M(e,t){C.mapDiv.addEvent(e,t)}function S(e,t){C.mapDiv.removeEvent(e,t)}function _(){var e=K.bind(this);window.addEvent("resize",e),window.addEvent("load",e)}function I(e){var i,o;_(),M("locationSelected",W.bind(Pe)),M("afterLocationSelected",q.bind(Pe));var n=ta.api.maps.providerFactory.createProviderImplementationInstance(),a=e.initLoc;ve=E(e),ve.setCenter(a,!0);var r=C.mapDiv.getSize();ve.setWidthHeight(r.x,r.y);var l=!1;if(e.useHistoryToLoadState&&(l=oe()),M("onMapLoad",function(){se(),l||z(ve.getOrigOps(),o||i),he.selectFirstProductPOI&&ge()}),l||(ve.setOrigOps(Se),A(Se,e.servlet),"function"==typeof ve.setupFilters&&ve.setupFilters(Se)),F(Se),e.eventTrackingName||(e.eventTrackingName="dynamic_large_map"),ue=H(ve,e,C,n),be[ve.getOriginalLocId()]=!0,window.mapDivId&&window[window.mapDivId]&&window[window.mapDivId].vbLocs){var d={name:"dmo",baseZ:ve.Z_INDEX_DMO},c=0;window[window.mapDivId].vbLocs.forEach(function(e){e.locId="dmo"+c,e.hoverClass="dmoHover",e.pinProminent=!0,ve.addPinFromItem(e,d.name,null,!0,d.baseZ),c++})}updateTrkPxl(".inner_poi_map",!0),ue.injectCallbacks({onCenterChanged:Pe.onPan,onPanStart:Pe.onPanStart,onPinClicked:Pe.onPinClicked,onPinHoverStart:Pe.onPinHoverStart,onPinHoverEnd:Pe.onPinHoverEnd,onPinAnimationChanged:Pe.onPinAnimationChanged,onPolygonClicked:Pe.onPolygonClicked,onPolygonHoverStart:Pe.onPolygonHoverStart,onPolygonHoverEnd:Pe.onPolygonHoverEnd,onZoomChanged:Pe.onZoomChange,onInfoWindowShown:Pe.onInfoWindowShown,onHoverInfoWindowShown:Pe.onHoverInfoWindowShown,onHoverInfoWindowHoverStart:Pe.onHoverInfoWindowHoverStart,onStreetViewStatusChange:Pe.onStreetViewStatusChange,onUpdateFinished:Pe.onUpdateFinished}),we=new s(e,ue,ve),re(),ve.addUpdateListenerOnce(function(){Pe.fireMapEvent("onMapLoad",null,1)}),i=Z(ve.getOrigOps()),i&&i.id&&Se.homeStartsOpen&&G(i.id),K(),ve.addUpdateStartListener(ue.startSpinners),ve.addUpdateEndListener(ue.updateSponsorFlyout),ve.addZoomedOutTooFarListener(ue.showMapZoomExcessBox),ve.addZoomedWithinLimitListener(ue.hideMapZoomExcessBox),M("locationCleared",Q.bind(Pe)),Pe.fireMapEvent("openingMap");var p=t.retrieve("neighborhood_polygon_json");p?(o=ta.maps.util.readPolygonFromJson(ta.util.escaping.unescapeHTMLSafe(p)),o.poiType="neighborhood"):o=null;var g=t.retrieve("mapsv2.neighborhoods"),v=g&&!l&&("Neighborhood"===e.servlet||"NeighborhoodList"===e.servlet);g&&L(o,Pe.fireModelUpdate.bind(Pe),v),v||(ve.resetZoom(),Pe.fireModelUpdate()),e.isTabletMaps&&(ta.common.tablet&&ta.common.tablet.addMapEventHandlers(),document.body.addClass("stop-scrolling"),O());var u={};C.mapDiv.getParent(".inner_poi_map").getElements(".nearbyFilterItem").each(function(e){var t=e.getProperty("class"),i=t.split(" ")[1],o=B.bind(Pe).partial(Function._,e,i);u[i]=o,e.addEvent("click",function(t){e.toggleClass("selected"),e.removeClass("hovering");var n=window.pageServlet;Pe.trackEvent(e.hasClass("selected")?"sidebar_poi_check":"sidebar_poi_uncheck",n||""),Pe.trackEvent(e.hasClass("selected")?"sidebar_poi_check":"sidebar_poi_uncheck",i),o(t,e,i)}),e.addEvent("mouseover",function(){e.addClass("hovering"),e.addClass("hoverCur")}),e.addEvent("mouseleave",function(){e.removeClass("hovering"),e.removeClass("hoverCur")})}),t.store("floatMapCbxFunctions",u),V(ve.getOrigOps())}function O(){var e=document.querySelector(".footerPocketWithInsert");if(e){var t=!1;e.addEvent("touchstart",function(e){e.target&&e.target.getParent(".map_filter_bar")&&(t=!0)}),e.addEvent("touchmove",function(){t&&(i.trackEventOnPage("dynamic_large_map","Filters_Menu_Tablet","Overlay_Scroll"),t=!1)}),e.addEvent("touchmove",function(e){!e.touches||1!==e.touches.length||e.target&&(e.target.hasClass("map_moveableBlock")||e.target.getParent(".map_moveableBlock"))||(e.preventDefault(),e.stopPropagation())})}}function E(e){var t=new l({lowerZoomLimit:Me,pinSelectionApproach:e.pinSelectionApproach||"v2",zoom:e.origOps.zoom,noDates:e.origOps.noDates,preferredIds:e.origOps.preferredIds},e.servlet,e.origOps.locId);return e.initialZoom&&e.origOps.zoom&&t.setZoom(Math.max(e.origOps.zoom,Me)),t}function H(e,i,o,n){var a=o.mapDiv;return new d(n,a,{eventTrackingName:i.eventTrackingName,center:e.mapCenter(),zoom:e.getZoom(),lowerZoomLimit:Me,reuseHoverDivs:i.origOps.reuseHoverDivs,searchBar:t.has("mapsv2.search"),disableMapStyling:i.origOps.disableMapStyling,isTabletMaps:i.isTabletMaps,isManualZoom:i.isManualZoom,zoomControls:a.getParent(".inner_poi_map").getElements(".zoom"),typeControls:a.getParent(".inner_poi_map").getElements(".mapType"),dynamicHoverPosition:"Hotels"===window.pageServlet||"Hotel_Review"===window.pageServlet,iconVer:i.iconVer,callbacks:{onload:function(){Pe.trackEvent("open_with_zoom_lvl",i.origOps.locId,ue.getProviderZoom())}}})}function k(e,t){Pe.zoomAndPanToFitLocations(e,15,function(){ve.setOriginalCenter(ue.getProviderCenter()),ve.setZoom(ue.getProviderZoom()),ve.setCenter(ue.getProviderCenter()),ve.setZoomInitialized(),"function"==typeof t&&t()})}function L(e,t,i){var o=function(){"function"==typeof t&&t()};ve.buildRequest("neighborhoods",function(t){var n=new Element("div",{html:t}),a=n.getElementById("data"),r=ta.util.escaping.unescapeHTMLSafe(a.getProperty("text"));if(r&&r.length>0){var s=ta.maps.util.readPolygonListFromJson(r);if(s&&s.length>0)if(s.each(function(e){e.poiType="neighborhood",ve.addPolygon(e)}),i){var l=[];e?(ve.setActivePolygon(e),l.append(e.coordinates)):s.each(function(e){l.append(e.coordinates)}),l.length>0?k(l,o):o()}else o()}else o();Pe.fireMapEvent("neighborhoodsLoaded",n)},"get",o).get()}function V(e){Pe.fireMapEvent("filtersVisibilityChanged",e);var i=me.container.querySelector(".mapPOIFilters"),o=t.has("mapsv2.show_sidebar");i&&i.setStyle("display",o?"none":"block")}function F(e){var t=!(!e||!e.customFilter);C.mapDiv.getParent(".inner_poi_map").getElements(".nearbyFilterItem").each(function(e){var i=e.getProperty("class").split(" ")[1];e.toggleClass("hidden",e.hasClass("hideable")&&!t),e.toggleClass("selected",ve.isVisible(i))}),Pe.fireMapEvent("layersToggled",ve)}function A(e,t){ve.setAllTypesVisible(),ve.toggleTypeVisibility("vacationrental",!1),ve.toggleTypeVisibility("neighborhood",!1),e.customFilter?(e.customFilter.contains("restaurants")||ve.toggleTypeVisibility("restaurant",!1),e.customFilter.contains("attractions")||ve.toggleTypeVisibility("attraction",!1),e.customFilter.contains("hotels")||ve.toggleTypeVisibility("hotel",!1)):"RestaurantsNear"===t?(ve.setZoom(16),ve.toggleTypeVisibility("hotel",!1),ve.toggleTypeVisibility("restaurant",!0),ve.toggleTypeVisibility("attraction",!1)):"AttractionsNear"===t?(ve.setZoom(16),ve.toggleTypeVisibility("hotel",!1),ve.toggleTypeVisibility("restaurant",!1),ve.toggleTypeVisibility("attraction",!0)):"HotelsList"===t?(ve.toggleTypeVisibility("restaurant",!1),ve.toggleTypeVisibility("attraction",!1)):"VacationRentals"===t||"VRACSearch"===t||"VacationRentalsNear"===t?(ve.setAllTypesInvisible(),ve.toggleTypeVisibility("vacationrental",!0)):e.isLodging?(ve.toggleTypeVisibility("restaurant",!1),ve.toggleTypeVisibility("attraction",!1)):e.isEatery?(ve.toggleTypeVisibility("hotel",!1),ve.toggleTypeVisibility("attraction",!1)):e.isAttraction?(ve.toggleTypeVisibility("hotel",!1),ve.toggleTypeVisibility("restaurant",!1)):"Tourism"===t||"ShowForum"===t||"AllReviews"===t?(ve.toggleTypeVisibility("restaurant",!1),ve.toggleTypeVisibility("hotel",!1),e.isBroadGeoMap&&ve.toggleTypeVisibility("attraction",!1)):"Hotels"===t?(ve.toggleTypeVisibility("restaurant",!1),ve.toggleTypeVisibility("attraction",!1)):"Restaurants"===t||"RestaurantSearch"===t?(ve.toggleTypeVisibility("hotel",!1),ve.toggleTypeVisibility("attraction",!1)):"Attractions"===t?(ve.toggleTypeVisibility("restaurant",!1),ve.toggleTypeVisibility("hotel",!1)):"Neighborhood"===t||"NeighborhoodList"===t?(ve.toggleTypeVisibility("hotel",!1),ve.toggleTypeVisibility("neighborhood",!0)):"Airport"!==t&&"RoadTrip"!==t||(ve.toggleTypeVisibility("restaurant",!1),ve.toggleTypeVisibility("attraction",!1)),F(e),V(e)}function D(e){ve.getOriginalLocId()!==e.locId&&(ve.setOrigOps(Object.merge(ve.getOrigOps(),e)),ve.setOriginalCenter(new ta.maps.util.GeoPoint(e.lat,e.lng)),ve.resetToOriginalCenterAndZoom(),ie())}function x(e){if((e.homeIcon||e.isLodging||e.isEatery||e.isAttraction)&&!e.suppressHomePin){var t={isLodging:e.isLodging,isEatery:e.isEatery,isAttraction:e.isAttraction,locId:e.locId,lat:e.lat,lng:e.lng,pinProminent:!0,hoverClass:"homeHover",startsOpen:e.homeStartsOpen,customHover:{title:e.title,url:getBaseMapsUrl("info",e.locId,he.servlet),titleUrl:e.url}};return ve.addPinFromItem(t,"home",null,!0,ve.Z_INDEX_HOME)}}function Z(e){var t=!e.userPoi||!e.userPoi.keepHomePin;t&&ve.removePinsByType("home",!0);var i;if(e.userPoi&&!e.userPoi.keepHomePin||(i=x(e)),e.userPoi){var o=R(e.userPoi,e);e.userPoi.keepHomePin||(i=o)}else C.searchBar&&ta.mapsv2.SearchBar.setInputText(C.searchBar,"",C.errorLabel);return i}function R(e,t){if(e){var i;if(i=t.userPoi.locId===t.locId&&t.userPoi.keepHomePin?ve.getPin(t.locId):ve.addPinFromItem(e,"home",null,!0,ve.Z_INDEX_HOME),e.keepHomePin){var o=new ta.maps.util.GeoPoint(t.lat,t.lng);ue.zoomToFitLocations(o,new ta.maps.util.GeoPoint(e.lat,e.lng),function(){ve.setCenter(new ta.maps.util.GeoPoint(t.lat,t.lng)),ve.setZoom(ue.getProviderZoom())})}else ve.setCenter(new ta.maps.util.GeoPoint(e.lat,e.lng),!0),ve.resetZoom(),ve.setInitialLoadDone(!0);return ie(e.locId),C.searchBar&&ta.mapsv2.SearchBar.setInputText(C.searchBar,e.name,C.errorLabel),i}}function z(e,t){t&&(t.target=window.event&&event.target),t&&(e.isLodging||e.isEatery||e.isAttraction||e.isNeighborhood)?Pe.fireMapEvent("locationSelected",[t,!0]):Pe.fireMapEvent("locationCleared",[t,!0])}function B(e,t,i){var o=t.hasClass("selected");ve.toggleTypeVisibility(i,o),Pe.fireMapEvent("layersToggled",ve),ie(),new Request({url:getBaseMapsUrl("typeToggled",ve.getLocationId())}).send(),o&&"vacationrental"===i&&U("Check_VR")}function N(){ve.resetToOriginalCenterAndZoom(),z(ve.getOrigOps()),ve.updateBasedOnCurrentState(),Pe.trackEvent("reset","")}function U(e){var t="";"Hotels"===window.pageServlet?t="_HM":"Tourism"===window.pageServlet&&(t="_TM");var i="VR_"+e+t;new Request({url:"/ActionRecord?action="+i+"&geo="+modelGeoId}).send()}function W(e,t,i){if(e)if(Q(),e.item){var o=e;!o.item||"home"===o.poiType&&"hotel"!==o.item.type&&"restaurant"!==o.item.type&&"attraction"!==o.item.type||(j(o,i),ue.onInfoWindowShown(o.item,o.id,!t,null,i?"ListView":null))}else{var n=e;ve.setActivePolygon(n),ve.commitUpdatesAndNotifyListeners(),ue.onInfoWindowShown(n,n.id,!t,null,null)}}function q(e){if("neighborhood"===e.poiType)e.center&&ue.panProviderToLocation(e.center,{x:-150,y:0},function(){ve.setCenter(ue.getProviderCenter()),ve.setZoom(ue.getProviderZoom()),ve.updateBasedOnCurrentState()});else{var t=ue.getProviderMarkerPixelPosition(e.id),i=ne(),o=ae();(!ue.isProviderMarkerInView(e.id)||t.x<i.x+o.x&&t.y<i.y+o.y)&&ue.panProviderToLocation(e.latLng)}}function G(e){var t=function(){e&&Pe.view.getProviderLocationMarker(e)&&(Pe.handlePinHover.apply(Pe,[e,!0]),o.off("onUpdateFinished",t))};o.on("onUpdateFinished",t)}function j(e,t){var i=ve.getSelectedPin();if(!i||i.id!==e.id){var o=e.poiType;"home"===o&&e.item.type&&(o=e.item.type);var n;n=0===o.indexOf("sponsor_")?o:"home";var a=Object.merge({},e.item,{pinProminent:!0,type:o,animate:t,noInfo:!0});ve.setSelectedPin(e),ve.removePin(e.id),ve.addPinFromItem(a,n,null,!0,ve.Z_INDEX_SELECTED,null,!0,!0)}}function X(){var e=ve.getSelectedPin();e&&(ve.removePin(e.id),ve.addPinFromItem(e.item,e.poiType),ve.setSelectedPin(null),ve.commitUpdatesAndNotifyListeners(),he.isTabletMaps&&(i.trackEventOnPage("dynamic_large_map","POI_Card","Close"),ue.closeHoverInfoWindow()))}function J(){ve.setActivePolygon(null),ve.commitUpdatesAndNotifyListeners()}function Q(){ve.getSelectedPin()?X():ve.getActivePolygon()?J():he.isTabletMaps&&ve.getOrigOps().userPoi&&ue.closeHoverInfoWindow()}function K(){Y(C.mapDiv),ue&&ue.informOfResize(),Pe.fireMapEvent("mapWindowResized")}function Y(e){var t=!he.isTabletMaps||r.isRtl()&&he.isManualZoom?window.getSize().y:window.innerHeight,i=ee();0!==i||he.isTabletMaps||me.container.addClass("no_footer");var o=i>0?fe+i:2*fe,n=t-o;e.setStyle("height",n),ve&&ve.setWidthHeight(e.getSize().x,e.getSize().y)}function $(e,n){if(Ce){if(Ce=!1,Pe.fireMapEvent("mapClosed"),i.trackEventOnPage("dynamic_large_map","exit","close_overlay",0),t.store("maps_v2_open",!1),he.origOps.userPoi){var a=he.origOps.userPoi;delete he.origOps.userPoi,ve.removePin(a.locId)}var r=ve.getFilters();if("Hotels"===pageServlet&&ve.isFiltersEnabled())he.isTabletMaps?ta.hac.filters.updateResults.delay(2e3):ta.hac.filters.updateResults();else if("Restaurants"!==pageServlet&&"RestaurantSearch"!==pageServlet||!ve.isOldFiltersEnabled()||"function"!=typeof updateList)"Attractions"===pageServlet&&ve.isOldFiltersEnabled()&&r&&r.cat!==t.retrieve("mapsv2.attractions_map_filter_category")&&(n=!0,r.zfn?ta.servlet.Attractions.viewTabClicked(he.origOps.locId,r.cat,r.zfn):ta.servlet.Attractions.viewTabClicked(he.origOps.locId,r.cat));else{var s;if(r){s={};var l=0;r.pid&&r.pid.split(",").each(function(e){do l|=1<<e%10,e=Math.floor(e/10);while(e>0)}),s.priceRange=l,s.options=r.opt||"",s.combinedOptions=r.zfp||"",s.neighborhood=r.zfn||"",s.cuisine=r.cat||"",ta.restaurant_filter&&(s.itags=r.itags||ta.restaurant_filter.makeItagParam(".jfy_filter_bar_tags"),s.etags=r.etags||ta.restaurant_filter.makeEtagParam(".jfy_filter_bar_tags"))}updateList(null,null,ACTION_FILTERCHANGED,s)}he.isTabletMaps&&ta.common.tablet&&(ta.common.tablet.removeMapEventHandlers(),document.body.removeClass("stop-scrolling")),he.onCloseFunc&&he.onCloseFunc(n),N(),ue.closeStreetView(),ue.closeInfoWindow(),o.fireEvent("mapOverlayClosed")}}function ee(){return Te}function te(e,o){var a=ve.getHomePinData();if(a&&o&&o.hasClass("travelTimesUnknown")){if(a.item.locId===e)return;var r=ve.getPinData(e)||ve.getSelectedPin();if(!r)return;var s;if(r.travelTimes&&r.travelTimes.distance&&he.isTabletMaps){var l=o.getParent(".mapsv2-card"),d="";l&&l.hasClass("restaurant")?d=".restaurant ":l&&l.hasClass("attraction")?d=".attraction ":l&&l.hasClass("vacationrental")&&(d=".vacationrental ");var c=document.querySelector(d+".distance_bar .distance");if(!c)return;var p=c.innerHTML;p=p.replace("<br>",""),c.set("text",p.replace("{0}",parseFloat(r.travelTimes.distance)).replace("{1}",a.item.customHover.title)),s=r.travelTimes;var g;if(s.driving){g=d+".distance_bar .drivingTime";var v=document.querySelector(g);v&&v.set("text",s.driving)}if(s.walking){g=d+".distance_bar .walkingTime";var u=document.querySelector(g);u&&u.set("text",s.walking)}if(s.transit){g=d+".distance_bar .transitTime";var m=document.querySelector(g);m&&m.set("text",s.transit)}var f=document.querySelector(d+".distance_bar");if(f&&f.removeClass("travelTimesUnknown"),he.isTabletMaps&&l){var y=l.querySelector(".map_bar");y&&(y.style.display="block")}}var h=a.latLng,P=r.latLng;if(!r.travelTimes)return void ue.getProviderTravelTime(h,P,function(t){r.travelTimes=t,te(e,o)},function(e){n.record("unexpected code encountered when requesting travel times",e)},window[window.mapDivId].units);var w=o.getElementsByTagName("a"),b=function(e){a&&a.item.customHover&&r&&r.item.customHover&&e&&(e.href="https://www.google.com/maps?saddr="+h.lat()+","+h.lng()+"&daddr="+P.lat()+","+P.lng(),e.title=t.retrieve("mapsv2.directions").replace("{0}",a.item.customHover.title).replace("{1}",r.item.customHover.title));var o=a.item.type||a.item.isLodging&&"hotel"||a.item.isEatery&&"restaurant"||a.item.isAttraction&&"attraction"||"geo";e&&(e.onclick=function(){return i.trackEventOnPage("dynamic_large_map","click_directions",r.poiType+"_"+o),!0})};if(w&&w.length>0&&b(w[0]),he.isTabletMaps){var C=document.getElements(".directionTxt a, .distance_bar a");C.each(b)}s=r.travelTimes;var T=function(e,t,i){var n=o.querySelector(t);n.set("text",i),n.set("style","display:inline !important"),o.querySelector(e).set("style","display:inline !important")};s.distance&&T(".dist",".distance",s.distance),s.driving&&T(".drive",".drivingTime",s.driving),s.walking&&T(".walk",".walkingTime",s.walking),s.transit&&T(".transit",".transitTime",s.transit),o.removeClass("travelTimesUnknown")}}function ie(e){if(Ce&&ta.mapsv2.Factory.isHistorySupported()){var t={zoom:ve.getZoom(),centerLng:ve.mapCenter().lng(),centerLat:ve.mapCenter().lat(),invisTypes:ve.getInvisibleTypes(),infoWindowMarkerId:e,activePolygonId:ve.getActivePolygon()&&ve.getActivePolygon().id,origOps:ve.getOrigOps()};window.history.replaceState(t,null,null)}}function oe(){if(ta.mapsv2.Factory.isHistorySupported()&&window.history.state&&window.history.state.invisTypes){var e=window.history.state;return ve.setOrigOps(e.origOps),ve.setZoom(e.zoom),ve.setCenter(new ta.maps.util.GeoPoint(e.centerLat,e.centerLng),!0),e.invisTypes.each(function(e){ve.toggleTypeVisibility(e,!1)}),ve.setInitialLoadDone(!0),"number"==typeof e.infoWindowMarkerId&&le("onMapLoad",Pe.onPinClicked.bind(Pe).partial(e.infoWindowMarkerId,!0)),"number"==typeof e.activePolygonId&&le("onMapLoad",Pe.onPolygonClicked.bind(Pe).partial(e.activePolygonId,!0)),"function"==typeof ve.setupFilters&&ve.setupFilters(e.origOps),!0}return!1}function ne(){return C.cardManager?C.cardManager.getSize():{x:0,y:0}}function ae(){return C.cardManager?C.cardManager.getPosition(!0):{x:0,y:0}}function re(){if(!C.cardManager){var e=C.cardManager=new c(C.mapDiv,Pe);if(he.isTabletMaps){var i=document.querySelector(".unifiedNavBar");i&&i.adopt(e.getContainer(),new Element("div").addClass("closeButtonSpacer"))}e.addCard(new v),e.addCard(new u("infoCardRest","restaurant","isEatery")),e.addCard(new u("infoCardAttr","attraction","isAttraction")),e.addCard(new m("infoCardVR","vacationrental","isVR")),t.retrieve("mapsv2.listView")&&e.addCard(new h(ve.getOriginalLocId())),t.has("mapsv2.listViewRoadtrip")&&e.addCard(new P(ve.getOriginalLocId()));var o=t.retrieve("mapsv2.neighborhoods");o&&(e.addCard(new f("infoCardNeighborhood","neighborhood","isNeighborhood")),!he.isTabletMaps&&t.retrieve("mapsv2.neighborhoods_list")&&e.addCard(new g)),ve.getOrigOps().hasOwnProperty("filtersType")&&e.addCard(new y(ve)),t.has("mapsv2.show_sidebar")&&e.addCard(new p)}}function se(){if(window.mapDivId&&window[window.mapDivId]&&window[window.mapDivId].vbLocs&&window[window.mapDivId].isBroadGeoMap)try{var e=[],t=ve.getStickyPins();for(var i in t)if(t.hasOwnProperty(i)){var o=t[i].item;o&&o.lat&&o.lng&&e.push(new ta.maps.util.GeoPoint(o.lat,o.lng))}ue.zoomAndPanToFitLocations(e)}catch(e){n.record(e,"POIMapController couldn't zoom to DMO pins")}}function le(e,t){var i=function(){t.apply(this,arguments),S(e,i)};M(e,i)}function de(t,i,o){var n=i.querySelector(".fromPrice");n&&n.hasClass("priceUnknown")&&e({method:"GET",url:getBaseMapsUrl("getLowestPrice",t,he.servlet),onSuccess:function(e){var a=n.querySelector(".fromPriceAmount");if(a&&""!==e.bestPrice)i.hasClass("ui_tooltip")||i.hasClass("ui_popover")||!i.getParent()||(i.getParent().style.width="auto"),n.removeClass("priceUnknown"),a.innerHTML=e.bestPrice;else if(!e.hasComplete&&o>0)de.delay(b,Pe,[t,i,o-1]);else{var r=i.querySelector(".unavailableText");r&&r.removeClass("hidden")}if(!i.hasClass("ui_tooltip")&&!i.hasClass("ui_popover")){var s=me.container?me.container.getSize():null,l=ue.getProviderMarkerPixelPosition(t),d=i.getSize();if(s&&l&&l.x+15+d.x>s.x){var c=i.querySelector(".rightSidePriceInfo"),p=i.getParent();c&&p&&(p.style.left=parseInt(p.style.left)-c.getSize().x+"px")}}}})}function ce(e,t,i,o,n,a){we.activateHoverHighlightAndInfoWindow(e,t,i,o,n,a)}function pe(){return t.retrieve("roadtrip.specificLocations")}function ge(){var e=pe();if(e)for(var t=0;t<e.length;t++){var i=ve.getPinData(e[t]);if(i&&i.latLng&&i.latLng.lat())return void z({isAttraction:!0},i)}}var ve,ue,me,fe=20,ye=3,he=w,Pe=this,we=null,be={},Ce=!1,Te=0,Me=9,Se=w.origOps,_e=w.onShowFunc,Ie=w.origOps.customFilter;this.getModel=function(){return ve},this.getView=function(){return ue},this.getCardManager=function(){return C.cardManager},this.getCustomFilter=function(){return Ie},this.isMapOpen=function(){return Ce},this.isLayerVisible=function(e){return ve.isVisible(e)},this.triggerUpdate=function(){ve.updateBasedOnCurrentState()},this.reopenMap=function(e,t){if(e&&"function"==typeof e){var i=_e;i&&i!==e&&(_e=e)}if(t){D(t),Ie=t.customFilter;var o=Z(t);o&&o.id&&t.homeStartsOpen&&G(o.id),be[t.locId]||(be[t.locId]=!0,updateTrkPxl(".inner_poi_map",!0)),"function"==typeof ve.setupFilters&&ve.setupFilters(t),A(t,he.servlet);var n=t.isNeighborhood?ve.getPolygon(t.locId):o;z(t,n)}_();var a=!1;if(he.isTabletMaps){a=ta.common.tablet&&ta.common.tablet.isManualOverlayZoom();var r={draggable:!a,scrollwheel:!a,isManualZoom:a};ue.initProviderOptions(r)}me.show&&me.show(),K(),ve.addUpdateListenerOnce(function(){this.trackEvent("open_with_zoom_lvl",t.locId,ue.getProviderZoom())}.bind(this)),this.fireMapEvent("openingMap"),ve.updateBasedOnCurrentState(null,null,!0),he.isTabletMaps&&ta.common.tablet&&(ta.common.tablet.addMapEventHandlers(),document.body.addClass("stop-scrolling")),he.selectFirstProductPOI&&ge()},this.addPin=function(e,t,i){we.addPin(e,t,i)},this.addUserPin=function(e){var t=ve.getOrigOps(),i=t.userPoi;i&&ve.removePin(i.locId),t.userPoi=e,ve.setOrigOps(t),Z(t),ve.updateBasedOnCurrentState(function(){this.fireMapEvent("userPinDropped",ve.getPinData(e.locId))}.bind(this))},this.toggleLayer=function(e,t){var i=C.mapDiv.getParent(".inner_poi_map").querySelector(".nearbyFilterItem."+e);i&&(i.toggleClass("selected",t),B(null,i,e))},this.toggleFilter=function(e,t){ve.toggleFilter(e,t),ve.updateBasedOnCurrentState()},this.clearFilters=function(){ve.clearFilters(),ve.updateBasedOnCurrentState()},this.isMarkerInView=function(e){return ue&&ue.isProviderMarkerInView(e)},this.handlePinHover=function(e,t){ue.triggerProviderHover(e,t)},this.handlePinBlur=function(e){ue.triggerProviderBlur(e)},this.onPinClicked=function(e,i){var o=ve.getPinData(e);if(o&&o.item){var n=o.item.isVR||"vacationrental"===o.poiType||"vacationrental"===o.item.type;n&&(o.vrMinRateDisplay?a.record("VR_PricePinClick_MAP"):a.record("VR_DotPinClick_MAP")),"home"===ve.getPinType(e)&&o.item.type&&"address"===o.item.type&&!o.item.isLodging||(o.item.isLodging||"hotel"===o.poiType||"hotel"===o.item.type||0===o.poiType.indexOf("sponsor_")||t.retrieve("mapsv2.show_sidebar")&&(o.item.isEatery||"restaurant"===o.poiType||"restaurant"===o.item.type||o.item.isAttraction||"attraction"===o.poiType||"attraction"===o.item.type||n)?(o.target=window.event&&event.target,Pe.fireMapEvent("locationSelected",o,i)):we.onPinClicked(e),ie(e))}},this.onPolygonClicked=function(e,t){var i=ve.getPolygon(e);i&&(i.target=window.event&&event.target,Pe.fireMapEvent("locationSelected",[i,t]),ie(e))},this.onPolygonHoverStart=function(e,t){we.onPolygonHoverStart(e,t),t||Pe.fireMapEvent("polygonHoverStart",e)},this.onPolygonHoverEnd=function(e){we.onPolygonHoverEnd(e),Pe.fireMapEvent("polygonHoverEnd",e)},this.onHoverInfoWindowHoverStart=function(e){var t=ve.getPolygon(e);t&&ue.closeHoverInfoWindow()},this.onPinAnimationChanged=function(e){var t=ve.getPinData(e);t&&t.item.type&&!t.item.noInfo&&!he.isTabletMaps&&ce(e,!0,!1,!1)},this.onStreetViewStatusChange=function(e){C.cardManager&&C.cardManager.setVisible(!e)},this.onInfoWindowShown=function(e){if(we.onInfoWindowShown(e),e.track&&e.container&&!e.noDates){var t=e.container.querySelector(".crOverlayButton.custom_area_QC_Button_Map");t&&t.addEvent("click",function(){i.trackEventOnPage("dynamic_large_map","ShowPrices")});var o=e.container.querySelector(".travelTimes");te(e.id,o)}},this.onUpdateFinished=function(){ue.stopSpinners(),o.fireEvent("onUpdateFinished")},this.onHoverInfoWindowShown=function(e){we.onHoverInfoWindowShown(e),e.track&&e.container&&!e.noDates&&de(e.id,e.container,ye)},this.onPinHoverStart=function(e,t){we.onPinHoverStart.apply(we,arguments),Pe.fireMapEvent("onPinHoverStart",e,t);var i=ve.getPinData(e);if(i&&i.item){var o=i.item.isVR||"vacationrental"===i.poiType||"vacationrental"===i.item.type;o&&(i.vrMinRateDisplay?a.record("VR_PricePinHover_MAP"):a.record("VR_DotPinHover_MAP"))}},this.onPinHoverEnd=function(e){we.onPinHoverEnd.apply(we,arguments)&&Pe.fireMapEvent("onPinHoverEnd",e)},this.zoomAndPanToFitLocations=function(e,t,i){we.zoomAndPanToFitLocations(e,t,i)},this.onZoomChange=function(e){we.onZoomChange(e),Pe.fireMapEvent("mapMoved"),ie()},this.onPan=function(e){we.onPan(e),ie()},this.onPanStart=function(){Pe.fireMapEvent("mapMoved")},this.fireModelUpdate=function(){we.fireModelUpdate()},this.fireMapEvent=function(e,t,i){C.mapDiv.fireEvent(e,t,i)},this.trackEvent=function(e,t,i){we.trackEvent.call(we,e,t,i)},this.bindMapEvent=M,this.removeMapEvent=S,this.close=function(){me&&me.hide&&($(me,!0),me.hide())},T(w)}var b=1e3;return w});
define("maps/Factory",["ns-exporter","utils/browserutils","ta/Core/TA.Load","ta/util/Load","maps/POIMapController","maps/BasicMapModel","maps/BasicMapView","maps/BasicMapController"],function(t,e,a,o,r,n,i,s){"use strict";var l=function(t){return{mapDiv:t.getElement(".js_map"),errorDiv:t.getElement(".js_error"),recenter:t.getElement(".js_mapHome"),floatContent:t.getElement(".js_floatContent"),footerPocket:t.getElement(".js_floatContent .js_footerPocket"),searchBar:t.getElement("#MAP_ADD_LOCATION_INPUT"),errorLabel:t.getElement("#MAP_ADD_LOCATION_ERROR")}},c=function(t){return"maps.controller"+t},p=!1,m=!1,u=function(t,e,a,o,n,i){var s=ta.retrieve("tablet_maps_v1"),l={miniInfoWindowOnHover:s||!e.tabletFullSite,initLoc:new ta.maps.util.GeoPoint(e.lat,e.lng),servlet:a,onShowFunc:o,onCloseFunc:ta.mapsv2.Factory.undoHashRedirectOnClose.bind(this).partial(Function._,i),origOps:e,useHistoryToLoadState:n,isTabletMaps:s,isManualZoom:e.isManualZoom||s&&ta.common.tablet&&ta.common.tablet.isManualOverlayZoom()},c=ta.retrieve("mapsv2.controller_class");return"ta.maps.ProductPOIMapController"===c&&(ta.has("roadtrip.specificLocations")&&(l.lowerZoomLimit=7),l.initialZoom=!0,l.suppressHomePin=!0,l.selectFirstProductPOI=!0),new r(l,t)},d=function(t,e,a,o,r,n){if("string"==typeof a)try{a=ta.fn(a)}catch(t){ta.util.error.record(new Error,"callback error "+a)}return v(t,e,function(){a&&a.delay(250)},o,r,n)},v=function(t,e,r,n,i,s){var p=Object.merge({},window[mapDivId],i);if(!p)return void ta.util.error.record(new Error,"Options not found for map: "+mapDivId);var m=p.css||window.g_mapV2Css;if(m&&!ta.retrieve("ta.floatingMapCSS")&&ta.store("ta.floatingMapCSS",new Asset.css(m)),"string"==typeof r&&(r=ta.fn(r)),"string"==typeof s&&(s=ta.fn(s)),r||t&&t.preventDefault&&t.preventDefault(),!ta.retrieve("maps.loaded"))return ta.store("gmaps.APIVersion","3.14"),a.load("ta-mapsv2.js",function(){o.maps(function(){v(t,e,r,n,i,s)})},!0),!1;var d;if(ta.retrieve("infobox_js"))return d=ta.remove("infobox_js"),Asset.javascript(d,{onLoad:function(){v(t,e,r,n,i,s)}}),!1;if(ta.retrieve("mapsv2_restaurant_reservation_js")&&(d=ta.remove("mapsv2_restaurant_reservation_js"),!ta.eateryReservation&&d))return ta.loadInOrder(d,function(){v(t,e,r,n,i,s)}),!1;var f=c(mapDivId),w=window.pageServlet,_=p.isLodging||p.isAttraction||p.isEatery?1:0;_||ta.trackEventOnPage("GEO_Map_Hotels","open","",0),ta.trackEventOnPage("static_map","open_float_map","all",_),ta.trackEventOnPage("map_view",w||"",ta.retrieve("mapsv2.attractions_map_tab_name")||"open_float_map",_),ta.retrieve("extraTrackingNearbyGems")&&ta.trackEventOnPage&&ta.trackEventOnPage("NearbyGems","Map_Opens","gemmapopen"),ta.store("maps_v2_open",!0),p.inline||document.body.addClass("map-overlay-open");var y=null;if(ta.has(f))try{y=ta.retrieve(f),y.reopenMap(r,p)}catch(t){ta.util.error.record(t,"createPOIMap - map exists")}else{ta.util.cookie.setPIDCookie(1102);var g=document.id("FMRD")||document.id("FLOATMAP")||document.id("FLOATMAPMULTI"+mapDivId)||document.id("MAP_TEMPLATE"),M=l(g);r||(r=function(){}),y=u(M,p,w,r,n,s),ta.store(f,y),ta.store("mapStartTime",(new Date).getTime())}return!1},f={createPOIMapViaHashRedirect:function(t,e,a,o,r,n,i,s,l,c,p,m,u,d){!function(t){t&&"object"==typeof t&&(r=t.latitude,n=t.longitude,i=t.id,s=t.name,l=t.url,c=t.userPoi,p=t.isLodging,m=t.isAttraction,u=t.isEatery,d=t.customFilters)}(arguments[4]);var v=null;i&&s&&l&&(v={locId:i,title:s,url:l,isLodging:p,isAttraction:m,isEatery:u}),r&&n&&(v=v||{},v.lat=r,v.lng=n),c&&(v=v||{},v.userPoi=c),d&&(v=v||{},v.customFilter=d);var f={event:t,element:e,onShowFunc:a,onCloseFunc:o,opts:v};t&&t.preventDefault&&t.preventDefault(),ta.mapsv2.Factory.isHistorySupported()&&window.history.pushState(null,null,window.location.href.replace(/#.*|$/,"#MAPVIEW")),ta.mapsv2.Factory.handleHashLocation(!1,f)},undoHashRedirectOnClose:function(t,e){if(ta.mapsv2.Factory.isHistorySupported()&&!t)if(m){m=!1;var a=window.location.protocol+"//"+window.location.host+window.location.pathname;ta.retrieve("mapsv2.map_is_on_vr")&&(a+=window.location.search),window.history.pushState(null,null,a)}else window.history.back();p=!1,document.body.removeClass("map-overlay-open"),"function"==typeof e&&e()},handleHashLocation:function(t,e){if(require.defined("maps/performanceMetrics")){var a=require("maps/performanceMetrics");a.baseLayerStart(a.DRAW_TRIGGERS.LOAD),a.pinsStart(a.DRAW_TRIGGERS.LOAD)}if(p){if(!ta.mapsv2.Factory.isHistorySupported()||"#MAPVIEW"!==window.location.hash){var o=c(mapDivId),r=o&&ta.retrieve(o);r&&r.close(),p=!1}}else p||(e=e||{},ta.mapsv2.Factory.isHistorySupported()&&"#MAPVIEW"!==window.location.hash||(d(e.event,e.element,e.onShowFunc,t,e.opts,e.onCloseFunc),p=!0,m=t))},getMapController:function(){var t=c(mapDivId);return t&&ta.retrieve(t)},closeFromOtherThanX:function(){ta.mapsv2.Factory.getMapController().close(),ta.mapsv2.Factory.undoHashRedirectOnClose(!1,null),p=!1},isHistorySupported:function(){return!(!window.history||!window.history.pushState)},isMapOpen:function(){return p},createEmbeddedDynamicMap:function(t,a,o){var r=window[window.mapDivId];window.g_mapV2Css&&!ta.retrieve("ta.floatingMapCSS")&&ta.store("ta.floatingMapCSS",new Asset.css(g_mapV2Css));var l=ta.retrieve("tablet_maps_v1"),c=l&&ta.common.tablet&&ta.common.tablet.isManualOverlayZoom(),p=Object.merge({eventTrackingName:"embedded_dynamic_map",miniInfoWindowOnHover:!!ta.retrieve("tablet_maps_v1")||!r.tabletFullSite,origOps:{}},a||{}),m=ta.api.maps.providerFactory.createProviderImplementationInstance();p.initPolygon&&(p.initLoc=m.getPolygonCenter(p.initPolygon));var u=Object.merge({center:p.initLoc,lowerZoomLimit:9,reuseHoverDivs:!!e.safari,isTabletMaps:l,isManualZoom:c,dynamicHoverPosition:!0},o||{}),d=new i(m,t,u),v=new n({},p.initLocId);return v.setCenter(p.initLoc,!1),v.setZoom(p.initZoom),new s(p,d,v)},createPOIMap:v};return t.exportTo(f,"ta.mapsv2.Factory"),f});
function getBaseMapsUrl(e,t,a,o){var i="/GMapsLocationController?Action="+e+"&from="+a+"&g="+t+"&geo="+t;if(ta.has("mapProviderFeature.maps_api")){var r=ta.retrieve("mapProviderFeature.maps_api");i+="&mapProviderFeature="+r}if(ta.has("mapInfoParentGeo")){var s=ta.retrieve("mapInfoParentGeo");i+="&parent="+s}if("undefined"!=typeof pageServlet&&"InfoCenter"===pageServlet&&"undefined"!=typeof FM_PROP_LIST&&"undefined"!=typeof FM_PROP_TYPE){var n=["&pList=",FM_PROP_LIST,"&pType=",FM_PROP_TYPE];i+=n.join("")}var p=ta.widgets.calendar;if(p&&(i+="&validDates="+p.datesInRange(),p.datesInRange())){var l=p.getCheckRatesData();for(var d in l)l.hasOwnProperty(d)&&(i+="&"+d+"="+l[d])}return o&&(i+=ta.has("sel.category")?"&cat="+getEntryCategory():""),i}function getEntryCategory(){return ta.has("sel.category")?ta.retrieve("sel.category").substring("cat_".length):"1"}function updateTrkPxl(e,t){require.defined("ta/maps/trackpixel")&&require("ta/maps/trackpixel").loadSponsorTrackingPixel(t)}var requestReset=function(e,t,a,o){if(0!==this.mapWidth()&&0!==this.mapHeight()){t||(t=updateMarkers.bind(this));var i=a||"original",r=new Request({url:getBaseMapsUrl(e,this.origOps.locId,this.getServlet())+"&mc="+this.mapCenter().toUrlValue()+"&mz="+this.getZoom()+"&mw="+this.mapWidth()+"&mh="+this.mapHeight()+"&pinSel="+i,method:"get",onSuccess:function(e){t(e)}});o&&o.each(function(e){r.url+="&"+e.name+"="+e.value}),r.send()}},toggleMarkerType=function(e,t,a){return this.map.getZoom()<this.map.options.minZoom?void e.stop():(null==e?t.checked=!t.checked:(e=new Event(e),e.target!==t&&(e.stop(),t.checked=!t.checked)),this.map.showOrHideType(t.checked,a),t.getParent().toggleClass("cur"),"hotel"!==a&&new Request({url:getBaseMapsUrl("typeToggled",this.map.origOps.locId)}).send(),void ta.trackEventOnPage("dynamic_large_map",t.checked?"sidebar_poi_check":"sidebar_poi_uncheck",a,0))},updateMarkers=function(t){var data=eval("("+t+")");if(data.zoom&&this.getZoom()!==data.zoom&&this.setZoom(data.zoom),updateHomePinOptions(data),!this.initialLoad&&(this.initialLoad=!0,this.addEvent("onMove",checkForUpdate.bind(this)),this.addEvent("onZoom",checkForUpdateZ.bind(this)),data.address)){var locationTitle=$("NMN_TITLE");locationTitle&&(locationTitle.innerHTML=data.address)}if(this.options.isBlenderMap){var revisedBlenderMarkers=get_filtered_blender_markers(data);this.replaceMarkers(revisedBlenderMarkers,"hotel",Object.merge({pid:1360,titlePID:1360},ta.maps.MARKER_HOTEL))}else data.hotelsVisible&&this.replaceMarkers(data.hotels,"hotel",{heightEstimate:148,pid:1099,titlePID:1098}),this.replaceMarkers(data.restaurants,"restaurant",{heightEstimate:130,pid:1100,titlePID:1098}),this.replaceMarkers(data.attractions,"attraction",{heightEstimate:130,pid:1101,titlePID:1098}),document.id("cbx4")&&this.replaceMarkers(data.vacationrentals,"vr_exact",{heightEstimate:148,pid:1099,titlePID:1098});if(data.sponsorLocationIds&&(ta.remove("ta.maps.locsBySponsor"),ta.store("ta.maps.locsBySponsor",data.sponsorLocationIds)),data.sponsorVisible){var t=this,sponsorOpts={heightEstimate:190,zIndexProcess:function(){return 1}};this.options.isBlenderMap&&(sponsorOpts=Object.merge(sponsorOpts,{dontSetZIndex:!0})),Object.each(data.sponsorsAll,function(e,a){t.replaceMarkers(e,a,sponsorOpts)})}},get_filtered_blender_markers=function(e){if(!ta.has("blender_map_markers"))return[];if(!e.sponsorVisible||!e.sponsorsAll)return ta.retrieve("blender_map_markers");var t=[];Object.each(e.sponsorsAll,function(e){t.push.apply(t,e)});var a=ta.retrieve("blender_map_markers").filter(function(e){return!t.some(function(t){return t&&e&&e.locId===t.locId&&e.lat===t.lat&&e.lng===t.lng})});return a},updateHomePinOptions=function(e){var t=window.mapDivId,a=ta.retrieve("origFloatMap");if(t&&a&&!isGeoMap(t)&&("undefined"==typeof a.options.homeIcon||a.options.homeIcon)){var o;if(e.homeSponsored&&e.homeSponsorPinDetails){var i=getBaseMapsUrl("sponsorInfo",t.locId,a.getServlet());i+="&originalloc="+t.locId,i+="&sponsors="+e.homeSponsorPinDetails.sponsorName,o={customHover:{url:i,titleUrl:t.url}},setHomePinWithOptions(o,t,a)}else e.homeSponsored===!1&&(o={customHover:{title:t.title,url:getBaseMapsUrl("info",t.locId,a.getServlet()),titleUrl:t.url}},setHomePinWithOptions(o,t,a))}},setHomePinWithOptions=function(e,t,a){t&&a&&(a.setHomeOps(e),a.removeHome(),a.homeMarker=a.createMarker(Object.merge({lat:t.lat,lng:t.lng},e),"home",{zIndex:65535}),a.addMarker(a.homeMarker,"home"))},isGeoMap=function(e){return!(!e||!e.geoMap)},checkForUpdate=function(e){e||this.getZoom()<this.options.minZoom||requestUpdate.apply(this)},checkForUpdateZ=function(e,t){t<this.options.minZoom||t<=e&&this.origOps.minPins&&this.origOps.minPins.every(function(e){return this.countType(e[0])>=e[1]},this)||requestUpdate.apply(this)},requestUpdate=function(e,t){if(0!==this.mapWidth()&&0!==this.mapHeight()){var a=t||"original",o="";if("original"===a){var i=[],r=[],s=[],n=[];this.getDataForType("hotel").each(function(e){i.push(e.locId)},this),this.getDataForType("restaurant").each(function(e){r.push(e.locId)},this),this.getDataForType("attraction").each(function(e){s.push(e.locId)},this),this.getDataForType("vacationrental").each(function(e){n.push(e.locId)},this),o="&lAccommodations="+i.join(",")+"&lAttractions="+s.join(",")+"&lRestaurants="+r.join(",")+"&lVacationRentals="+n.join(",")}e||(e=updateMarkers.bind(this)),new Request({url:getBaseMapsUrl("update",this.origOps.locId,this.getServlet())+"&mc="+this.mapCenter().toUrlValue()+"&mz="+this.getZoom()+"&mw="+this.mapWidth()+"&mh="+this.mapHeight()+o+"&pinSel="+a,method:"get",onSuccess:e}).send()}};
ta.meta||(ta.meta={}),ta.meta.link||(ta.meta.link={}),function(e){function t(t,a,o,l,c,m,u,g,d,s){"use strict";var f=t,p=new RegExp("(&|\\?)area=[^&]*");if(f=f.replace(p,"$1area="+a),crPageServlet){var v=new RegExp("(&|\\?)from=[^&]*");f=f.replace(v,"$1from=HotelDateSearch_"+crPageServlet)}var _=ta.commerce.meta.tracking.setTimingForNavArea(a);if(_&&m&&!m.hasClass("bookableOffer"))if(f.contains("&metaRequestTiming=")){var h=new RegExp("(&|\\?)metaRequestTiming=[^&]*");f=f.replace(h,"&metaRequestTiming="+_)}else f+="&metaRequestTiming="+_;if(g&&(f+="&m="+g),d&&(f+="&priceShown="+d),s&&(f+="&cpn="+s),document.location&&document.location.href){var P=e.extractPageLocId(document.location.href);P&&(f+="&pageLocId="+P)}var k=f.indexOf("/StartBooking")>=0;k&&crPageServlet&&(f=f+"&from="+crPageServlet),ta.has("assisted_booking_clicks_new_tab")&&c===e.OPEN_IN_NEW_TAB&&k&&ta.browser&&ta.browser.isIE10Metro()&&(c=e.OPEN_IN_SAME_TAB),ta.has("tablet_google_search_app_open_same_tab")&&/GSA\/[0-9]{2}/.test(window.navigator.userAgent)&&(c=e.OPEN_IN_SAME_TAB),k&&ta.page&&ta.page.maybeOpenInlineBooking&&ta.page.maybeOpenInlineBooking(null,l,m,null,f)||(c===e.OPEN_IN_NEW_TAB?r(f,u,o,m):c===e.OPEN_IN_SAME_TAB?n(f,m):i(o,f,u),window.IS_DEBUG&&ta.store("ta.lastCommerceClickUrl",f))}function a(){try{document.domain=document.domain}catch(e){return!0}return!1}function r(e,t,r,o){var i=a(),l=window.open(i?e:"","_blank");return!l&&"undefined"!=typeof Browser&&Browser.ie&&ta.has("ta.ie_commerce_popup_block_fix")&&ta.has("assisted_booking_clicks_new_tab")&&e.indexOf("/StartBooking")>=0?(ta.util&&ta.util.cookie&&ta.util.cookie.setPIDCookie(38822),void n(e,o)):(!i&&ta.popups.PopUtil.redirectToUrl(l,e),void ta.popups.PopUtil.pollForPartnerLoad(l,new Date,r,ta.popups.PopUtil.extractSlotFromCommerceUrl(e),crPageServlet))}function n(e,t){if(ta.meta.treeTrack.logTrackingTreeClickEvtCookie(e,t),ta.meta&&ta.meta.treeTrack){var a=function(){o(e)};if(t&&null!=t.getParentBySelector(".metaCheckRatesOverlay"))ta.meta.treeTrack.logLightboxTreeImpression(a);else if(ta.meta.treeTrack.isInitialized())try{ta.meta.treeTrack.logTreeImpression(a)}catch(t){ta.util.error.record(t," Error in openMetaProviderSameTab"),o(e)}else ta.retrieve("allowSamePageClickWithoutTrackingTree")===!0&&o(e)}else o(e)}function o(e){ta.retrieve("ta.isIE11orHigher")?window.open(e,"_self",null,!1):window.location.href=e}function i(e,t,a){var r,n=e,o=ta.popups.PopUtil.getProviderWindowDims(n,!0),i=1;window&&window.chrome&&(i=0),r={customWidth:o.customWidth,customHeight:o.customHeight,widthOffset:o.widthOffset,heightOffset:o.heightOffset,name:n,url:t,scrollbars:i,providerLogo:a},ta.popups.PopUtil.createCheckRatesWindow(r)}function l(e){var t=ta.retrieve("ta.meta.navArea");(!t||t.indexOf(e)<0)&&ta.store("ta.meta.navArea",e)}function c(e,t,a,r){var n="";t.getParent(".persistentCR")?n=r?"|PCR":"PCR":t.getParent(".photosOverlay")||t.getParent("#LOC_PHOTO_ALBUMS")?n=r?"|Photo_Lightbox":"Photo_Lightbox":t.getParent(".amenities_lightbox")?n=r?"|Amenities_Lightbox":"Amenities_Lightbox":t.getParent("#CHECK_RATES_LB")&&(n=r?"|Photo_LB":"Photo_LB"),n=n?"|"+n:"",e=e?e:"",n=n?n:"",a=a?a:"";var o=[e,n,a].join("|").replace("||","|").replace(/(\|$)/g,"");return o}function m(e,t,a,r,n){ta.util.error.record(e,t,null,{servlet:window.pageServlet,url:a,area:r},n)}function u(e,t){var a,r={"data-navArea-metaType":null,"data-navArea-linkType":null,"data-navArea-availability":null,"data-navArea-placement":null},n=4;if(t)for(a in r)t.hasOwnProperty(a)&&(r[a]=t[a],n--);for(var o=null;e&&n>0;){for(a in r)null===r[a]&&(r[a]=e.get(a),null!==r[a]&&("@trigger"===r[a]&&(o=e),n--));e=e.getParent()}for(;"@trigger"===r["data-navArea-placement"]&&o;){for(;o&&!o.overlay;)o=o.getParent();for(o&&o.overlay.options&&o.overlay.options.trigger?o=o.overlay.options.trigger:(o=null,r["data-navArea-placement"]="null");o&&(r["data-navArea-placement"]=o.get&&o.get("data-navArea-placement"),null===r["data-navArea-placement"]);)o=o.getParent()}var i=[];for(a in r)i.push(r[a]?r[a]:"null");return window.isTabletOnFullSite?i.push(g()?"Portrait":"Landscape"):i.push("Desktop"),i.join("|")}function g(){return ta.common&&ta.common.tablet?ta.common.tablet.isPortrait():window.matchMedia&&window.matchMedia("(orientation: portrait)")&&window.matchMedia("(orientation: portrait)").matches}function d(e){if(!e||e.isVisible())return e;var t=e.get("data-locationid"),a=e.get("data-contentid"),r=".offer";r=e.hasClass("bookableOffer")?r+'.bookableOffer[data-locationid="'+t+'"]':r+'[data-locationid="'+t+'"][data-contentid="'+a+'"]';var n=document.getElement(r);return n?n:e}e.click||(e.OPEN_IN_NEW_TAB="new_tab",e.OPEN_IN_SAME_TAB="same_tab",e.OPEN_IN_NEW_WINDOW="new_window",e.getUrlFromClickElem=function(e){if(!e)return null;var t=e.get("data-commerceClickData");if(!t||!t.trim||""===t.trim()||"function"!=typeof asdf)return null;t=asdf(t).replace(/&amp;/g,"&");var a=ta.retrieve("tracking.impression.key");if(e.hasClass("inlineOffer")&&a){var r=/ik=[a-zA-Z0-9]*/;t=t.replace(r,"ik="+a)}return t},e.getPartnerFromClickElem=function(e){if(!e)return null;var t=e.get("data-offerauthor");return t&&t.trim&&""!==t.trim()?t.trim():null},e.click=function(a,r){"use strict";var n,o,i,l,c,u,g,s,f,p,v=ta.id(r);try{if(v=d(v),n=e.getUrlFromClickElem(v),!n)return;o=v.get("data-vendorName"),i=v.get("data-offerauthor")||v.get("data-offer-author"),l=v.get("data-locationId"),c=e.getNavAreaFromClickElem(v),u=v.get("data-contentId"),g=v.get("data-openBehavior"),s=v.get("data-imageUrl"),f=v.get("data-mcid"),p=v.get("data-pernight"),n&&o&&l?t(n,c,o,l,g,v,s,f,p,i):m(null,"Invalid commerce click",n,c)}catch(e){m(e,"Invalid commerce click",n,c)}setTimeout(function(){try{ta.fireEvent("metaLinkClick",v,o,c,l,u,g,ta.popups.PopUtil.extractSlotFromCommerceUrl(n))}catch(e){m(e,"Commerce click tracking failed",n,c)}},300)},e.getNavAreaFromClickElem=function(e){var t,a,r=ta.id(e),n=r.get("data-navArea");n||(t=r.get("data-navAreaPre"),a=r.get("data-navAreaPost"),n=c(t,e,a)),n&&(n=n.replace("+","|")),ta.browser.isIE10Metro()&&(n="QC_Meta_Metro_Lightbox"),e.getParent("#LOC_PHOTO_ALBUMS")?n+=e.getParent(".featuredImageWrap")?"|PHOTOS_LB|Featured_Reel":"|PHOTOS_LB":e.getParent("#AMENITY_LIGHTBOX")&&(n+="|AMENITIES_LB"),l(n);var o=n;return n=u(r),null!=n&&n.indexOf("null")==-1&&n.indexOf("Unknown")==-1||(n=o),n},e.extractPageLocId=function(t){return e.urlArgNumeric(t,"d","detail")||e.urlArgNumeric(t,"g","geo")},e.urlArgNumeric=function(e,t,a){var r=new RegExp("(-"+t+"([0-9]+))|([?&]"+a+"=([0-9]+))"),n=r.exec(e);if(n){if("undefined"!=typeof n[2])return n[2];if("undefined"!=typeof n[4])return n[4]}return null},e.photoClick=function(t,a,r,n,o){r.hasOwnProperty("area")&&(r.area=e.getPhotoNavArea(t)),require("ta/util/Doer").aimdoit(a,r,n,o)},e.getPhotoNavArea=function(e){return u(e,{"data-navArea-metaType":"Pro_Photo","data-navArea-availability":"NA"})},e.updateNavAreaInCommerceUrl=function(t,a){if(a){var r=e.getNavAreaFromClickElem(a),n=new RegExp("(&|\\?)area=[^&]*");t=t.replace(n,"$1area="+r)}return t})}(ta.meta.link);
require(['ta/rollupAmdShim'], function(rollupAmdShim) {rollupAmdShim.install(["ta/meta/LinkTracking"],[]);});
if(window.requirejs && requirejs.taConfig)requirejs.taConfig({"deferred":{},"name":"build/concat/ta-mapsv2-mvc","files":{"js3":{"src":{"ta":{"meta":{"LinkTracking":1}}}}},"_":{"baseUrl":"/"}});
define("ta/meta/LinkTracking",["vanillajs","api-mod","ns-exporter","ta/Core/TA.Event","ta/util/Error","utils/ajax","ta/Core/TA.Store","ta/Core/TA.Record","utils/urlutils"],function(e,t,r,a,c,i,o,n,l){"use strict";function k(e,t,r,a,i,o){try{u(t,r,a,o)}catch(e){try{c.record(e,"trackMetaClick failure")}catch(e){}}try{if(!e||!(e.className||"").match(/\bbookableOffer\b/)){var n=e&&e.getAttribute("data-pernight")||"",k=e&&e.getAttribute("data-commerceclickdata")||"",d=l.getUrlQueryArgs(l.asdf(k.trim()).replace(/&amp;/g,"&")),g=d&&d.gosox||"";s(a,!0,i,n,g)}}catch(e){try{c.record(e,"trouble loading click-out pixels")}catch(e){}}try{o!=ta.meta.link.OPEN_IN_SAME_TAB&&m(e)}catch(e){try{c.record(e,"problem in ibdmImpressionTracking")}catch(e){}}}function m(e){ta.meta&&ta.meta.treeTrack&&(t.getParent(e,"metaCheckRatesOverlay")?ta.meta.treeTrack.logLightboxTreeImpression():ta.meta.treeTrack.isInitialized()&&ta.meta.treeTrack.logTreeImpression(),ta.meta.treeTrack.logTrackingTreeClickTrk(e))}function s(e,t,r,a,i){try{var o={locId:e,isMetaCheckRates:t,contentId:r,selectedPrice:a,offerStr:i};require(["trjs!ta/common/behavior/Ads-pagemoniker"],function(e){e.loadClickoutMonikers(o)})}catch(e){c.record(e,"click out monikers failure (meta="+t+")")}}function u(e,t,r,a){var c="CheckRates",i=1;n.trackPhysicalCommerce(c,t,i,r),n.trackAttemptedCommerce(c,t,e,i);var o=a?a===ta.meta.link.OPEN_IN_NEW_TAB?"TAB_OPENED":a===ta.meta.link.OPEN_IN_NEW_WINDOW?"WINDOW_OPENED":"SAME_TAB":"";n.trackEventOnPage("COMMERCE_CLICK",o,e||"")}var d={};return d.setup=function(){try{a.on("metaLinkClick",k)}catch(e){c.record(e,"trouble building event - metaLinkClick")}},d.actionRecord=function(e){i("/ActionRecord?action="+e)},d.restoreCRPageServlet=function(){var e=o.retrieve("crPageServlet_orig");e&&(window.crPageServlet=e)},r.exportTo(d,"ta.meta.linkTracking"),d});
ta.commerce.meta.tracking={getTimingForNavArea:function(e){if(e){var r=ta.commerce.meta.tracking.processNavArea(e);return ta.retrieve(r)}},setTimingLockForNavArea:function(e,r){ta.store(e+"-LOCK",r)},isTimingLocked:function(e){var r=ta.commerce.meta.tracking.processNavArea(e),a=ta.retrieve(r);if(!a)return!1;var t=Date.now();return!(t-a>=2e3)||(ta.commerce.meta.tracking.resetTimingLockForNavArea(r),!1)},resetTimingLockForNavArea:function(e){var r=ta.commerce.meta.tracking.processNavArea(e);ta.retrieve(r+"-LOCK")&&ta.remove(r+"-LOCK")},resetAllTimingLocks:function(){for(var e=["QC_Meta_Inline","QC_Meta_Mini","QC_Meta_Metro","QC_Meta_Micro","QC_Meta_Lightbox"],r=0;r<e.length;r++)ta.commerce.meta.tracking.resetTimingLockForNavArea(e[r])},processNavArea:function(e){if(e)return 0===e.indexOf("QC_Meta_Inline")?"QC_Meta_Inline":0===e.indexOf("QC_Meta_Mini")?"QC_Meta_Mini":0===e.indexOf("QC_Meta_Metro")?"QC_Meta_Metro":0===e.indexOf("QC_Meta_Micro")?"QC_Meta_Micro":0===e.indexOf("QC_Meta_Lightbox")?"QC_Meta_Lightbox":void 0},setTimingForNavArea:function(e,r){if(e){r||(r=Date.now());var a=ta.commerce.meta.tracking.processNavArea(e);return ta.commerce.meta.tracking.isTimingLocked(a)?ta.commerce.meta.tracking.getTimingForNavArea(a):(ta.store(a,r),ta.commerce.meta.tracking.setTimingLockForNavArea(a,r),"QC_Meta_Inline"!=a||ta.commerce.meta.tracking.containsSuppressedArea("QC_Meta_Mini")||ta.commerce.meta.tracking.setTimingLockForNavArea("QC_Meta_Mini",r),r)}},updateUrlWithTiming:function(e,r){if(!e||!r)return e;var a=ta.commerce.meta.tracking.setTimingForNavArea(r);if(!a)return e;if(e.contains("&metaRequestTiming=")){var t=new RegExp("(&|\\?)metaRequestTiming=[^&]*");e=e.replace(t,"&metaRequestTiming="+a)}else e+="&metaRequestTiming="+a;return e},suppressImpressionsForArea:function(e){if(e){var r=ta.commerce.meta.tracking.processNavArea(e);if(!ta.commerce.meta.tracking.containsSuppressedArea(r)){var a=ta.retrieve("suppressed.areas");a.push(r),ta.store("suppressed.areas",a)}}},getSuppressedAreas:function(){var e=ta.retrieve("suppressed.areas");return e||(e=[],ta.store("suppressed.areas",e)),e},getSuppressedAreasAsString:function(){var e=ta.commerce.meta.tracking.getSuppressedAreas(),r="";if(e.length>0)for(var a=0;a<e.length;a++)r+=e[a]+";";return r},hasAnySuppressedAreas:function(){var e=ta.commerce.meta.tracking.getSuppressedAreas();return e.length>0},containsSuppressedArea:function(e){if(!e)return!1;for(var r=ta.commerce.meta.tracking.processNavArea(e),a=ta.commerce.meta.tracking.getSuppressedAreas(),t=0;t<a.length;t++)if(a[t]==r)return!0;return!1},removeSuppressedArea:function(e){if(e){var r,a,t=ta.commerce.meta.tracking.processNavArea(e);if(ta.commerce.meta.tracking.containsSuppressedArea(t))for(var n=ta.commerce.meta.tracking.getSuppressedAreas(),i=0;i<n.length;i++)n[i]==t&&(a=i,r=!0),r&&(n=ta.commerce.meta.tracking.removeElementByIndex(n,a),ta.store("suppressed.areas",n))}},removeElementByIndex:function(e,r){return e&&r>=0&&r<e.length&&e.splice(r,1),e},clearSuppressedAreas:function(){ta.store("suppressed.areas",[])}};
require(['ta/rollupAmdShim'], function(rollupAmdShim) {rollupAmdShim.install(["ta/commerce/MetaJson"],[]);});
if(window.requirejs && requirejs.taConfig)requirejs.taConfig({"deferred":{},"name":"build/concat/ta-mapsv2-cards","files":{"js3":{"src":{"ta":{"commerce":{"MetaJson":1}}}}},"_":{"baseUrl":"/"}});
!function(e){e.util.escaping={escapeHTMLSafe:function(e){return"string"==typeof e||e instanceof String?e.replace(/&/gi,"&amp;").replace(/</gi,"&lt;").replace(/>/gi,"&gt;").replace(/"/gi,"&quot;").replace(/'/gi,"&#x27;").replace(/\//gi,"&#x2F;"):""},unescapeHTMLSafe:function(e){return"string"==typeof e||e instanceof String?e.replace(/&amp;/gi,"&").replace(/&lt;/gi,"<").replace(/&gt;/gi,">").replace(/&quot;/gi,'"').replace(/&#x27;/gi,"'").replace(/&#x2F;/gi,"/"):""}}}(ta);
ta||(ta={}),ta.util||(ta.util={}),ta.util.adjust||(ta.util.adjust={}),function(t){t.trimTextToHeight=function(t,e){if(t&&e>0)for(;t.getHeight()>=e;){var a=t.get("text"),i=a.length;if(a=a.replace(/[!$,.:;?]*\s+\S*$/,""),a.length==i&&(a=a.slice(0,-2)+""),""===a)break;t.set("text",a)}}}(ta.util.adjust);
require(['ta/rollupAmdShim'], function(rollupAmdShim) {rollupAmdShim.install(["typeahead/TypeAhead.utils","typeahead/TypeAhead.views","ta/util/Deferred"],[]);});
if(window.requirejs && requirejs.taConfig)requirejs.taConfig({"deferred":{},"name":"build/concat/ta-mapsv2-search","files":{"js3_secure":{"ssl":{"ta":{"util":{"Deferred":1}}}},"js3":{"src":{"typeahead":{"TypeAhead.utils":1,"TypeAhead.views":1}}}},"_":{"baseUrl":"/"}});
define("typeahead/TypeAhead.utils",["vanillajs","ta/util/Deferred","utils/ajax"],function(e,t,o){var n={};return n.query=function(e,n,a,r,i,l,s,u,c,_,d,g,m){return function(e){var f=t(),h={query:e,action:"API",startTime:this.startTime,uiOrigin:this.name,source:this.name,interleaved:!0,geoPages:!i,flightsToPages:!i,nearPages:!1,details:!0,types:n||"geo,hotel,eat,attr,vr",link_type:r||n||"geo,hotel,eat,attr",max:l||12,neighborhood_geos:!!u,requiredFields:s};if(""!==a?(h.nearby=!0,h.local=!0,h.parentids=a):h.global=!0,_&&""!==_&&(h.scopeFilter=_),d&&"[object Array]"===Object.prototype.toString.call(d)&&d.length>0&&(h.filter=d.join(",")),g)for(var p in g)g.hasOwnProperty(p)&&(h[p]=g[p]);if(sessionStorage&&m){var y=JSON.parse(sessionStorage.getItem("mapRect"));y&&(h.max_lat=y.max_lat,h.max_lon=y.max_lon,h.min_lat=y.min_lat,h.min_lon=y.min_lon)}return new o({method:"GET",url:"/TypeAheadJson",data:h,error:function(){c?f.reject(JS_location_not_found):f.reject(JS_location_not_found)},success:function(e){c?e&&e.results&&e.results.length>0&&f.resolve(e)||f.reject(JS_location_not_found):e&&f.resolve(e)||f.reject(JS_location_not_found)}}),f.promise()}},n});
define("typeahead/TypeAhead.views",["vanillajs","ta/util/Deferred","utils/object/set-props","ta/util/I18N"],function(e,s,a,t){var i={};i.iconMap={ALL:"sprite-typeahead-all",GEO:"sprite-typeahead-destination",HOTELOVERVIEW:"sprite-typeahead-destination",HOTEL:"sprite-typeahead-hotel",ATTRACTION:"sprite-typeahead-attraction",EATERY:"sprite-typeahead-restaurant",VACATION_RENTAL:"sprite-typeahead-vr",FLIGHTS_TO:"sprite-typeahead-flight",AIRPORT:"sprite-typeahead-flight",AIRLINE:"sprite-typeahead-flight",THEME_PARK:"sprite-typeahead-themepark",VACATION_PACKAGE:"sprite-typeahead-hotel",SMART_DEAL:"sprite-typeahead-hotel",CHILD_TOP:"sprite-typeahead-connector-top",CHILD_BOTTOM:"sprite-typeahead-connector-bottom",NEIGHBORHOOD:"sprite-typeahead-neighborhood",TRAVEL_GUIDE:"sprite-typeahead-travel-guide"},i.iconFontMap={ALL:"ui_icon globe-world",GEO:"ui_icon map-pin-fill",HOTELOVERVIEW:"ui_icon map-pin-fill",HOTEL:"ui_icon hotels",ATTRACTION:"ui_icon attractions",EATERY:"ui_icon restaurants",VACATION_RENTAL:"ui_icon vacation-rentals",FLIGHTS_TO:"ui_icon flights",AIRPORT:"ui_icon flights",THEME_PARK:"ui_icon amusement-parks",VACATION_PACKAGE:"ui_icon hotels",SMART_DEAL:"ui_icon hotels",CHILD_TOP:"sprite-typeahead-connector-top",CHILD_BOTTOM:"sprite-typeahead-connector-bottom",NEIGHBORHOOD:"ui_icon neighborhoods",TRAVEL_GUIDE:"ui_icon guides",AIRLINE:"ui_icon flights",SHIP:"ui_icon cruises",CRUISE_LINE:"ui_icon cruises",CAR_RENTAL_OFFICE:"ui_icon rental-cars",KEYWORD:"ui_icon search",TAG:"ui_icon search",ACTIVITY:"ui_icon activities",NEARBY:"ui_icon nearby",NEAR_POI:"ui_icon map-pin-fill",UNIVERSITY:"ui_icon classes-workshops",TRAIN_STATION:"ui_icon train",USER_PROFILE:"ui_icon friend-fill",USER_PROFILE_VERIFIED:"ui_icon verified-checkmark",PAGE:"ui_icon search",SHOPPING:"ui_icon shopping-bag",PORT:"ui_icon ports",GENERAL_HOSPITAL:"ui_icon hospital",FERRY:"ui_icon cruises",CORPORATION:"ui_icon office"};var r={PAGE:!0,BLENDER_PAGE:!0,NEAR_POI:!0,VACATION_PACKAGE:!0,SMART_DEAL:!0,FLIGHTS_TO:!0,USER_PROFILE:!0},n={FLIGHTS_TO:!0,VACATION_PACKAGE:!0};i.escapeHTML=function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\u00A0/g,"&nbsp;").replace(/"/g,"&quot;")};var o=function(e,s){var a={},t=[];return e.forEach(function(e){var s=e.type;a[s]=a[s]||[],a[s].push(e)}),s.forEach(function(e){var s=a[e];if(s)for(var i=0;i<s.length;i++)t.push(s[i])}),t};i.configTypeAheadOptionsForSortingByPOIType=function(e,a){var t=e.postResultsFnList||[];t.push(function(e){var t=s();return e.results=o(e.results,a),t.resolve(e),t.promise()}),e.postResultsFnList=t,e.listTemplate=function(e){var s=e.results,a=[];if(s.length>0){a.push("<ul>"),s.forEach(function(){var e="";return function(s){if(e!=s.type){e=s.type;var a=[s.rendered];a.push('<span class="label">'),a.push(s.title),a.push('<img src="/img2/x.gif" class="icon hidden" alt="">'),a.push("</span>"),s.rendered=a.join("")}}}());var t=function(){var e="",s=document.createElement("div");return function(a){var t='<li class="typeahead-choice '+i.escapeHTML(a.title.toLowerCase())+'">'+a.rendered+"</li>";return e!=a.type&&(e=a.type,s.innerHTML=t,s.firstChild.className+=" first",t=s.innerHTML),t}}();a.push(s.map(t).join("")),a.push("</ul>")}return a.join("")}};var l={showChildren:!1,tagLabels:null,poiClasses:"",geoClasses:""};return i.itemTemplate=function(e){e=a(l,e);var s=e.useIconFont,o=s?i.iconFontMap:i.iconMap,p=function(e,s){var a="";if(e&&Object.keys(e).length>0){var t=e[s];a=t||e.values()[0]}return a};return function(a,l){var u,c=[],h="url_small",d="",v="";l=l||{};var _=a.details||a,g=_.highlighted_name||_.name||"",f="TAG"===a.data_type||"local_tag"===a.scope||"overview"===a.scope||e.simpleChild&&a.isChild,y=f?"":_.geo_name||"";if("NEAR_POI"===a.data_type&&(g=a.find_near_name),l.HTMLEscape&&(g=i.escapeHTML(g),y=i.escapeHTML(y)),!a.isChild){a.isNeighborhood?u=o.NEIGHBORHOOD:"NEAR_POI"===a.data_type?u=o.NEAR_POI:"USER_PROFILE"===a.data_type?(v=a.avatar?p(a.avatar,h):"",u=o.USER_PROFILE+(v?" user-avatar":""),d=v?'<span class="ui_avatar labeled-profile-icon small"><img src="'+v+'" class=""></span>':""):u="PAGE"===a.data_type?o.PAGE:"TAG"===a.data_type?o[a.data_type]:o[a.type];var E=a.icon_type||a.data_type;if(E&&n[E.toUpperCase()]&&(u=o[E.toUpperCase()]),!s&&u&&E&&r[E]&&(u+="-list"),u){var T=(s?"":"sprite-image ")+"leftIcon "+u;c.push('<div class="'+T+'">'+d+"</div>")}}var R,A=e.tagLabels;A&&(a.isChild&&a.parent&&a.parent.moved?R=A.newLocation:a.moved===!0?R=A.moved:a.closed===!0&&(R=A.closed));var L="poi-name "+e.poiClasses;y||(L+=" no-geo"),"NEAR_POI"===a.data_type&&(L+=" near_poi"),d&&(L+=" user-avatar"),R&&(L+=" tagged-poi");var I="geo-name "+e.geoClasses;c.push('<div class="main-content">');var O=a.document_id;if(O&&(O=i.escapeHTML(a.document_id)),c.push('<div class="first-row" docId="'+O+'">'),c.push('<span class="'+L+'">'),e.debug&&(c.push('<span class="debug">'),c.push("number"==typeof a.order?a.order:"??"),c.push("("+("number"==typeof a.score?a.score:"??")+")"),c.push("&nbsp;</span>")),c.push(g),"USER_PROFILE"===a.data_type&&a.details.verified===!0){var m=" detailIcon "+o.USER_PROFILE_VERIFIED;c.push("<span>&nbsp;</span>"),c.push('<span class="'+m+'"></span>')}if(c.push("</span>"),R&&c.push('<div class="tag-container"><span class="search-tagged-poi" >'+R+"</span></div>"),c.push("</div>"),c.push('<div class="second-row">'),"USER_PROFILE"===a.data_type){var b=e.geoClasses,C=d?" user-avatar":"";if(c.push('<span class="'+b+C+'">'),c.push('<span class="username">'+a.details.user_name+"</span>"),a.details.followers){c.push("<span>&nbsp;&bull;&nbsp;</span>");var H="";t.isRtl()&&(H=' dir="rtl"'),a.following?c.push("<span"+H+">"+a.following+"</span>"):c.push("<span"+H+">"+a.details.followers+"</span>")}c.push("</span>"),c.push("</div>")}else y?(c.push('<span class="'+I+'">'+y+"</span>"),c.push("</div>")):c.pop();if(c.push("</div>"),e.showChildren&&a.isChild){c.unshift('<div class="child'+(R?" tagged-poi":"")+'">'),c.push("</div>");var N=a.lastChild?o.CHILD_BOTTOM:o.CHILD_TOP,P="sprite-image childIcon leftIcon "+N;c.unshift('<div class="'+P+'"></div>')}return c.join("")}},i.configureTypeAheadForSegmentedResults=function(e,a){var t=a||{},r=t.boldSearchQuery,n=t.groupByScope,o=e.postResultsFnList||[],l="search",p="rescue",u="history",c="suggested",h="overview",d="global",v="local",_="brands",g="hotels",f=function(e){var s={},a=function(e){return e.data_type&&"SEARCH"===e.data_type.toUpperCase()?p:e.type&&"SEARCH"===e.type.toUpperCase()?l:"history"==e.scope?u:"suggested"==e.scope?c:"overview"==e.scope?h:e.scope&&0===e.scope.lastIndexOf("local",0)?v:n&&"global"==e.scope?v:e.data_type&&"ADDRESS"===e.data_type.toUpperCase()?v:"brands"==e.scope?_:"hotels"==e.scope?g:d};return e.forEach(function(e){var t=a(e);if("history"!==t||!e.isChild){var i=s[t]=s[t]||[];i.push(e)}}),s};return o.push(function(e){var a=s();return t.debug&&e.results.forEach(function(e,s){e.order=s}),e.results=function(e){var s=[];e.forEach(function(e){if(s.push(e),e.children)for(var a=e.children.length,t=0;t<a;t++){var i=e.children[t];i.scope=e.scope,i.parent=e,s.push(i)}});for(var a=f(s),t=[],i=[h,u,c,v,d,l,_,g,p],r=0;r<i.length;r++){var n,o=i[r];n=a[o],n&&(t=t.concat(n))}return t}(e.results),a.resolve(e),a.promise()}),e.postResultsFnList=o,e.listTemplate=function(e){var s=[],a=e.results,n=f(a),o=!1,y=!1,E=!1,T=0==a.length,R=!(e.query&&e.query.query||n[v]&&0!==n[v].length||n[d]&&0!==n[d].length),A=function(e,a){var t="resultContainer"+(a?" "+a:"");s.push('<ul class="'+t+'">');for(var i=0;i<e.length;i++){var r=e[i];r&&(s.push('<li class="'+(r.wrapperCSS||"")+'">'),s.push(r.rendered),s.push("</li>"))}s.push("</ul>")};if(n[h]&&n[h].length>0&&(E=!0,t.overviewLabel&&s.push('<div class="title overview">'+t.overviewLabel+"</div>"),A(n[h],"overview")),n[u]&&n[u].length>0&&(o=!0,t.historyLabel&&s.push('<div class="title history">'+t.historyLabel+"</div>"),A(n[u],e.query?null:"history bold_names")),n[c]&&n[c].length>0&&(s.push('<div class="title history">'+t.suggestedLabel+"</div>"),A(n[c],"suggested")),!R&&t.localLabel&&(n[v]&&n[v].length>0||t.noResultsMessage&&!E)&&(y=!0),n[_]&&n[_].length>0){n[_];!e.integrated&&t.brandsLabel&&s.push('<div class="title">'+t.brandsLabel+"</div>"),A(n[_])}if(n[g]&&n[g].length>0&&(t.hotelsLabel&&s.push('<div class="title">'+t.hotelsLabel+"</div>"),A(n[g])),n[v]&&n[v].length>0?(y=!0,A(n[v],"local")):y&&t.showNoResultsMessage&&s.push('<div class="no-results">'+t.noResultsMessage+"</div>"),n[d]&&n[d].length>0&&(t.globalLabel&&(y||o||t.alwaysShowGlobal)&&s.push('<div class="title global">'+t.globalLabel+"</div>"),A(n[d],"global")),!R&&n[l]&&n[l].length>0){var L=n[l][0],I=e.query&&e.query.query||"",O="search resultContainer";L.noResults&&(O+=" noResults"),r?s.push('<ul class="'+O+'"><li class="searchRow">'+L.name.replace("%","<b>"+i.escapeHTML(I)+"</b>")+"</div></li></ul>"):s.push('<ul class="'+O+'"><li class="searchRow">'+i.escapeHTML(L.name.replace("%",I))+" &raquo;</div></li></ul>")}return n[p]&&n[p].length>0&&A(n[p],"rescue"),T&&!R&&t.showNoResultsMessage&&t.noResultsMessage&&s.push('<div class="no-results">'+t.noResultsMessage+"</div>"),s.join("")},t},i.simpleItemTemplate=function(){return function(e){return[e.details.name,'<span class="addr">',e.details.address,"</span>"].join("")}},i.simpleListTemplate=function(e){return function(s){if(!s.results||!s.results.length)return'<div class="noResults">'+e+"</div>";var a,t=s.results||[],i=["<ul>"];return t.forEach(function(e){i.push("<li>"),e.title!==a&&(a=e.title,i.push('<span class="label">',a,'<img src="/img2/icons/typeahead/',e.type.slice(0,1).toLowerCase(),'.gif"/></span>')),i.push(e.rendered),i.push("</li>")}),i.push("</ul>"),i.join("")}},i.ptptListTemplate=function(e){function s(e){var s="history"==e.scope,a=e.type?e.type.toLowerCase():"",t=s?"history":a;return{historyScope:s,choiceType:a,headerType:t}}for(var a=['<div class="typeahead-choices">'],t={},i={history:!0},r=CDNHOST+"/img2/x.gif",n=e.results,o=n.length,l=0;l<o;l++){var p=n[l],u=s(p),c="typeahead-choice "+u.choiceType,h=!1;u.headerType in t||(c+=" first",t[u.headerType]=!0,h=!0),u.historyScope&&(c+=" history"),a.push('<div class="'+c+'">'),a.push('<img src="'+r+'" class="icon" alt="">'),a.push('<span class="cutoff">'),a.push(p.rendered),a.push("</span>"),u.historyScope&&a.push('<img src="'+r+'" class="history_icon" alt="">'),a.push("</div>");var d=n[l+1],v=d&&s(d);v&&i[u.headerType]&&v.headerType!=u.headerType&&a.push('<div class="divider"></div>')}return a.push("</div>"),a.join("")},i});
ta.mapsv2=ta.mapsv2||{},ta.mapsv2.SearchBar=function(){"use strict";function e(e,r,s,o,l,i,d,u){var c=document.id(r);if(null===l)return i?ta.trackEventOnPage(d?"Search_Near_Map":"Search_Near_List","Submit","Err_Out_Of_Bounds"):ta.trackEventOnPage(d?"Search_Near_Map":"Search_Near_List","Submit","Err_Invalid"),ta.mapsv2.SearchBar.setLocationError(s),void c.addClass("error");if(ta.trackEventOnPage(d?"Search_Near_Map":"Search_Near_List","Submit",o),ta.mapsv2.SearchBar.resetInput(c,s),c.addClass("submitted"),c.blur(),l.coords){var p=l.coords.split(",");l.lat=p[0],l.lng=p[1]}if(l.value&&(l.locId=l.value),l.type&&l.urls&&l.urls.length>0?l.customHover={title:l.urls[0].name,title_url:l.urls[0].url,url:getBaseMapsUrl("info",l.value,window.pageServlet)}:(l.locId||(l.locId="".concat(l.lat,",",l.lng)),l.customHover={title:l.name}),n.hasOwnProperty(l.type)?l.type=n[l.type]:l.hasOwnProperty("type")&&delete l.type,l.animate=!0,l.pinProminent=!0,u&&(l.keepHomePin=!0),d){var v=ta.mapsv2.Factory.getMapController();v&&v.addUserPin(l)}else ta.mapsv2.Factory.createPOIMapViaHashRedirect(e,c,null,t.partial(c,s),null,null,null,null,null,l);return a(),!1}function a(){ta.store("maps.time_opened",(new Date).getTime()),window.onunload=t}function t(e,a){var t=ta.remove("maps.time_opened");t&&(new Date).getTime()-t<3e3&&ta.trackEventOnPage("Search_Near_List","Submit","Quick_Close"),ta.mapsv2.SearchBar.resetInput(e,a)}var r={},n={ADDRESS:"address",EATERY:"restaurant",HOTEL:"hotel",ATTRACTION:"attraction"};return{addPoi:function(a,t,r,n,s,o,l){return s.addClass("submitted"),e(a,s.id,t,l||"POI",o,!1,r,n)},addAddress:function(a,t,r,n,s,o){function l(t){var l=null;if(t&&t.length>0){var i=window[window.mapDivId];t.some(function(e){var a=ta.maps.util.GeoPoint.calculateDistance(e,new ta.maps.util.GeoPoint(i.lat,i.lng)),t=Math.round(a/1e3*.621371192);return t<40&&(l={lat:e.lat(),lng:e.lng(),name:e.name,type:e.type},!0)})}e(a,r,n,"Address",l,t&&t.length>0,s,o)}function i(){var e=ta.api.maps.providerFactory.createProviderImplementationInstance();e.getLatLng(u,l)}a.preventDefault();var d=document.id(r);d.addClass("submitted");var u=d.value;0!=u.length&&u!=d.defaultValue&&(ta.retrieve("maps.loaded")?i():ta.util.load.maps(i))},setLocationError:function(e){var a=document.id(e);if(a){var t,r='<div class="triangle"></div>',n=ta.retrieve("mapsv2.map_addressnotfound3"),s=ta.retrieve("mapsv2.geoName");if(n&&s)t=r.concat(n.replace("{0}",s));else{var o=ta.retrieve("mapsv2.map_addressnotfound");t=r.concat(o)}a.set("html",t).removeClass("hidden")}},clearLocationError:function(e,a,t){a.hasClass&&a.hasClass("error")&&a.removeClass("error");var r=document.id(t);r&&r.addClass("hidden")},onClear:function(e,a,t,r){var n=document.id(t);ta.mapsv2.SearchBar.resetInput(n);var s=n.retrieve("typeahead");s&&s.reset(),ta.mapsv2.SearchBar.clearLocationError(e,n,r),n.focus()},onBeforeChange:function(e,a,t){a.removeClass("submitted"),ta.mapsv2.SearchBar.clearLocationError(e,a,t)},setInputText:function(e,a,t){e.hasClass&&e.hasClass("error")&&e.removeClass("error"),a&&a.length>0?(e.value=a,ta.mapsv2.SearchBar.onChange(void 0,e)):ta.mapsv2.SearchBar.resetInput(e),t&&t.addClass("hidden")},onChange:function(e,a){a.hasClass&&a.toggleClass("has_value",a.value.length>0)},bindTypeAheadFactory:function(e,a,t,n,s,o,l){if(!r[a.id]){r[a.id]=!0,"focus"===e.type&&ta.mapsv2.SearchBar.resetInput(a);var i=ta.retrieve("mapsv2.typeahead_css");i&&!ta.has("mapsv2.typeahead_css.loaded")&&ta.store("mapsv2.typeahead_css.loaded",Asset.css(i));var d="air,geo,attr,hotel,eat";l&&(d+=",addr");var u=TypeAhead.utils.query(!1,d,n,"air,geo,attr,hotel,eat",!0,7,"geo_position",null,null,null,null,null,l),c={name:"map_typeahead",minChars:3,maxResults:7,containerParent:a.getParentBySelector("form").getParent(),positionRelative:!0,autopopulateHighlighted:!1,containerClass:"map_typeahead",selectInputText:!1,search:u,itemTemplate:TypeAhead.views.itemTemplate(),itemSelector:"li",selectOnBlur:!1,assumeOnBlur:!1,shouldSubmit:function(){ta.mapsv2.SearchBar.addAddress(e,a,a.id,t,s,o);var r=a.retrieve("typeahead");return r&&(r.hide(),r.abortSearch()),!1},onSelect:function(r,n,l,i,d){if(r.coords){var u={coords:r.coords,name:r.name,scope:r.scope,title:r.title,type:r.type,url:r.url,urls:r.urls,value:r.value};"ADDRESS"===r.data_type?ta.mapsv2.SearchBar.addPoi(e,t,s,o,a,u,r.data_type):ta.mapsv2.SearchBar.addPoi(e,t,s,o,a,u)}else if("googleAutocomplete"===r.provider){var c=ta.api.maps.providerFactory.createProviderImplementationInstance();c.getLatLng(r.name,function(r){if(r&&r.length>0){var n={lat:r[0].lat(),lng:r[0].lng(),name:r[0].name,type:r[0].type};ta.mapsv2.SearchBar.addPoi(e,t,s,o,a,n,"GAddress")}})}},resolveSelection:function(e){return e.name},onShow:function(e){e.container.addClass("visible")},onHide:function(e){e.container.removeClass("visible")}};TypeAhead.views.configureTypeAheadForSegmentedResults(c);var p=new TypeAhead(a,c);a.store("typeahead",p)}},resetInput:function(e){e&&(e.value="",ta.mapsv2.SearchBar.onChange(void 0,e),document.activeElement!==e&&(e.value=e.defaultValue))}}}();
