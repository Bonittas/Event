(this.$WP=this.$WP||[]).push(["v1dn52",(e,r)=>{var a,t,n,i,o,l,s,d,u,c,g,p,v,f,m,h,I,_,y,D,R,P,q,O,T,k,S,C,M,w,A,b,E,N,F,V,L,x,B,z,K,U,j,G,$,Y,Q,W,H,J,X,Z,ee,er,ea,et,en,ei,eo,el,es,ed,eu={__key:18230737020964,id:"1094ac9aa824c9340efaf2f6803488ed",loc:{},definitions:[]},ec={stickyContainer:"E t _g",bookingModulePlacementsContainer:"yPkTu S2 Gi",greenBorderTop:"UdQCX",alignTextCenter:"c",affiliateInfoContainer:"fiyjV Gi f u k Q2 Pk PY Px PK Re Ml Nb MK NC"},eg=({requiredFieldsMissing:e,rapData:r})=>{var n,i,{localize:o}=y(),l=r?.errors?.[0],s=l?.reason==="MIN_STAY_VIOLATION";return e?(n="missing-required-fields",i=o("vr_inquiry_missing_required_error_ffffdcba")):i=s?o("vr_min_stay_error",{minStay:r?.minStay??null}):l?.message,!!i&&a(ea,{in:!0,children:t("div",{"data-automation":"violationErrorPDP",className:p({marginBottom:"spacing-04"}),children:[a(en,{variant:"warning",children:a(et,{variant:"input-04",color:"inherit",children:i})}),s&&a(et,{variant:"body-01",marginTop:"spacing-02",children:o("vr_min_stay_error_suggestion")})]})},n)},ep=({children:e,errorKey:r,...t})=>a(ea,{in:!0,children:a("div",{className:"xaSZP c","data-automation":"violationErrorPDP",children:a(et,{variant:"input-04",color:"inherit",...t,children:e})})},r),ev=e=>{var r=g(),{localize:i}=y(),{actions:o}=d(M),l="MOBILE"===r,s=a(X,{elementKey:Z.INPUTS_PICKER,children:a(ee,{onInputsChange:e.onInputsChange,startDate:e.startDate,endDate:e.endDate,adults:e.adults,pets:e.pets,numberOfMonths:e.numberOfMonths,kids:e.kids,calendarData:e.calendarData,startDateOverlayAlignEdge:e.startDateOverlayAlignEdge,endDateOverlayAlignEdge:e.endDateOverlayAlignEdge,errorReason:e.errorReason,includePetsFilter:e.includePetsFilter,withTracking:!0,tripSearch:e.tripSearch,autoOpen:e.autoOpen,clearDates:e.clearDates})}),u=a(X,{elementKey:Z.INPUTS_PICKER,children:a(er,{calendarData:e.calendarData??void 0,alignCalendarOverlayDirection:"right",alignGuestOverlayDirection:l?"left":"right",setRequiredFieldsMissing:e.setRequiredFieldsMissing,withTracking:!0,clearDates:o?.resetDefault})}),c=a(el,{rapData:e.rapData,requiredFieldsMissing:e.requiredFieldsMissing});return t("div",{className:!l&&e.showOldVersion?v({backgroundColor:"secondaryBackground"}):void 0,children:[!e.showOldVersion&&t("div",{className:l?void 0:p({marginTop:"spacing-02"}),children:[c,u]}),e.showOldVersion&&t(n,{children:[(()=>{if(e.requiredFieldsMissing)return a(es,{errorKey:"missing-required-fields",marginBottom:"spacing-03",children:i("vr_inquiry_missing_required_error_ffffdcba")});var r=e.rapData?.errors?.[0],n=r?.reason==="MIN_STAY_VIOLATION",o=n?i("vr_min_stay_error",{minStay:e.rapData?.minStay??null}):r?.message;return!!o&&t(es,{errorKey:r?.reason||"",marginBottom:"spacing-03",children:[n&&a(ei,{}),o,n&&a(et,{variant:"body-01",marginTop:"spacing-02",children:i("vr_min_stay_error_suggestion")})]})})(),s]})]})},ef=({setVrTravelerInfo:e,rapResponse:r,...i})=>{var{params:o}=I(),v=x(),P="geoId"in o?o.geoId??null:null,q="detailId"in o?o.detailId??null:null;if(null===P||null===q)throw Error("geoId and/or detailId are missing in route params");var{localize:T}=y(),C=D(),w=_(),A="MOBILE"===g(),b=l(()=>A?"left":"right",[A]),{vr:{checkInDate:$,checkOutDate:X,adults:Z,children:ee},update:er}=h(),{pets:ea}=i.travelerInfo||{},[et,en]=u(!1),[{rental:ei,fetching:el}]=S({currencyCode:C,rentalId:q}),[{data:es,fetching:ed}]=function({rentalId:e}){var[r,a]=H({query:eu,variables:{propertyIds:[e]}});return l(()=>[{...r,data:function(e){if(!e)return null;var{bookedBits:r,...a}=e;return{...a,bookedBits:(r||[]).reduce((e,r)=>r?.key&&"boolean"==typeof r.value?{...e,[r.key]:r.value}:e,{})}}(r.data?.RentalInformation_getCalendarData?.[0])},a],[r,a])}({rentalId:q}),{state:{newRapData:eg,oldRapData:ep}}=d(M),[ef]=B(),{data:em}=(ef&&!ei?.requiresPetInput?eg:ep)??{};!function({rapData:e}){var{vr:{checkInDate:r,checkOutDate:a}}=h();s(()=>{!e?.errors?.length&&e?.subtotal?O.set("rapResponseTotal",e?.subtotal):O.set("rapResponseTotal",""),e?.stayLength&&O.set("rapResponseStayLength",e?.stayLength),r&&a?O.set("rapResponseIsDated",!0):O.set("rapResponseIsDated",!1)},[e?.errors,e?.subtotal,e?.stayLength,r,a])}({rapData:em});var eh=E({rental:ei,rapData:em}),eI=et?"NO_DATES":em?.errors?.[0]?.reason;!function({errorReason:e,isInquiryModalShowing:r}){var a=R();s(()=>{e&&a(eo.rapError(e))},[a,e]);var t=J(r);s(()=>{t&&!r&&a(eo.closeInquiryForm)},[t,r,a])}({errorReason:eI,isInquiryModalShowing:i.isInquiryModalShowing});var e_=R(),ey=c(()=>e_(eo.showAffiliateInfoTooltip),[e_]),eD=c(()=>en(!0),[]),eR=c(r=>{er.vr.setTravelInfo(r.startDate,r.endDate,r.adults,r.kids),e?.({start:r.startDate,end:r.endDate,adults:r.adults,kids:r.kids,pets:r.pets})},[er.vr,e]),eP=c(e=>{eR({startDate:$,endDate:X,adults:Z,kids:ee,pets:ea,...e}),en(!1)},[Z,$,X,ee,ea,eR]),eq=c(()=>{e_(eo.clearDates),eR({startDate:null,endDate:null,adults:Z,kids:ee||0,pets:ea})},[Z,ee,e_,ea,eR]),eO=l(()=>N(ei?.requiresPetInput??!1),[ei?.requiresPetInput]),eT=()=>{var e=!O.get("triggeredAutoOpenCalendarOnPdp")&&!$&&!X;return a(ev,{onInputsChange:eP,startDate:$,endDate:X,adults:Z||2,pets:ea,numberOfMonths:A?1:2,kids:ee,calendarData:es??void 0,startDateOverlayAlignEdge:b,endDateOverlayAlignEdge:"right",errorReason:eI??void 0,includePetsFilter:ei?.requiresPetInput,withTracking:!0,tripSearch:!1,autoOpen:e,clearDates:{handleClearDateEvent:eq,addClearDate:!0},rapData:em,requiredFieldsMissing:et,showOldVersion:eO,setRequiredFieldsMissing:en})},ek=()=>{var e=z(ei?.vrSource);return v&&!!ei?.isAffiliate&&t("div",{className:ec.affiliateInfoContainer,children:[a(K,{affiliateSourceId:ei.vrSource,logoUrl:ei.affiliateLogoUrl,providerOrdinal:ei.providerOrdinal}),!!e&&U(ei.providerOrdinal)&&a(m,{triggeringElement:a(G,{size:20}),title:T("vr_pdp_booking_contract_title",{brandPartnerName:z(j(ei.providerOrdinal))}),content:T("vr_pdp_booking_contract_info",{brandPartnerName:e}),variant:"top-caret",alignment:"right",onShowTooltip:ey})]})},eS=eO?ec.greenBorderTop:void 0;return!i.isInline&&A?null:t(n,{children:[A?t("div",{className:p({marginBottom:"spacing-03"}),children:[eT(),!!(ei&&eh.has(V.SEND_MESSAGE)&&$&&X)&&a("div",{className:p({marginTop:"spacing-02"}),children:a(W,{variant:"primary",fullWidth:!0,children:T("vr_send_message")})}),ek(),a(L,{oldRapData:r,rental:ei,geoId:P,showMissingRequireFields:eD})]}):t("div",{className:ec.stickyContainer,children:[a("div",{className:`${ec.bookingModulePlacementsContainer} ${eS}`,children:el||ed?a("div",{className:ec.alignTextCenter,children:a(f,{variant:"large"})}):t(n,{children:[eT(),a(F,{rapResponse:{data:r},rental:ei,travelerInfo:i.travelerInfo,detailId:q,geoId:P,readonlyMode:!1,trackingUid:w,loading:i.isRapLoading,showMissingRequireFields:eD,locale:i.locale,currencyCode:C})]})}),ek(),a(k,{size:"300x250",position:"rail1"})]}),a(Q,{modalId:Y})]})},em=e=>a(b,{oldRapData:l(()=>({data:A(e.rapResponse),fetching:e.isRapLoading}),[e.rapResponse,e.isRapLoading]),children:a(ef,{...e})}),eh=e=>{var{localize:r}=y();return a(ed,{...e,localize:r})};return[()=>{eo=Object.freeze({rapError:e=>({module:"VR",action:`VR_RAP_error|${e}`}),clearDates:{module:"VR_PDP",action:"VR_PDP_calendar_clear_dates"},closeInquiryForm:{module:"VR",action:"VR_Close_inquiryform_VRR"},showAffiliateInfoTooltip:{module:"VR",action:"VR_PDP_affiliateTooltipShown"}}),el=i.memo(eg),es=o.memo(ep),ed=q(P({data:(e,r)=>{$.stage(e,r);var a=e.travelerInfo.vr;if(!a)return()=>({});var{detail:t}=e.route,n=C(a,t,e.auth.csrfToken,e.travelerInfo.preferences.currency),i=n?r(n):null;return w.stage(e,r),(r,a)=>({travelerInfo:e.travelerInfo.vr,rapResponse:i?.get().data||(i?.get().error?{errors:[{reason:"API_ERROR",message:a.localize.string("vr_please_refresh")}]}:void 0),isRapLoading:!!i?.get().loading,isInquiryModalShowing:e.overlays.global===Y,locale:e.i18n.locale})},actions:{setVrTravelerInfo:T.travelerInfo.setVrTravelerInfo}})(em)),e("default",o.memo(eh))},[e=>(a=e.jsx,t=e.jsxs,n=e.Fragment),e=>(i=e,o=e.default,l=e.useMemo,s=e.useEffect,d=e.useContext,u=e.useState,c=e.useCallback),e=>g=e.useViewportCategory,e=>(p=e.margin,v=e.backgroundColor),e=>f=e.Spinner,e=>m=e.HoverTooltip,e=>h=e.useTravelInfo,e=>(I=e.useRoute,_=e.usePageviewUid),e=>(y=e.useLocalize,D=e.useCurrency),e=>R=e.useGARecorder,e=>(P=e.bind,q=e.loadOnMount),e=>O=e.default,e=>T=e.actions,e=>k=e.RailAd,e=>S=e.useJerseyDetailRentalData,e=>C=e.getRapUrl,e=>(M=e.RapContext,w=e.PriceHat,A=e.transformOldData,b=e.RapContextProvider,E=e.useRapAllowedActions,N=e.shouldShowOldBookingModule,F=e.RapView,V=e.RAP_ACTIONS,L=e.RapFooter),e=>(x=e.useMetaRolloutTest,B=e.useNewRapApiFeatureFlag),e=>(z=e.affiliateSourceName,K=e.AffiliateInfo,U=e.showBookingContractInfo,j=e.getAffiliateSourceIdFromProviderOrdinal),e=>G=e.default,e=>($=e.ConnectedInquiryForm,Y=e.MODAL_ID,Q=e.ConnectedModalInquiryForm,W=e.InquiryButton),e=>H=e.useQuery,e=>J=e.default,e=>(X=e.ScrollableElement,Z=e.SCROLLABLE_ELEMENT_KEYS),e=>(ee=e.TravelerInputsPicker,er=e.PdpTravelerInputs),e=>ea=e.default,e=>et=e.default,e=>en=e.InlineAlert,e=>ei=e.default]]},["121h32","1o4yt4","1ys6v1","gw8uw6","1qndsd","1xm2jz","1etaac","fgwvq1","17thqz","32pwc7","16z5q2","tp1g68","45ddp0","19m912","189zkc","xlpvch","owxqxc","1ipqm0","68adql","zq967r","1e32ha","1mqwhq","dlu2yg","aqceaf","1abxv6","1kcvbr","1essqv","lt9m20","1y0uq3"]]);
