(this.$WP=this.$WP||[]).push(["1bt3bv",(e,t)=>{var r,a,n,i,s,l,o,u,c,d,m,v,I,p,b,g,E,T,f,y,w,_,A,S,C,z,P,h,R,B,k,L,V,j,D,x,H,Z,q=["Hotels","Hotel_Review","AttractionProductReview"],X="experiences_exit_interstitial_v1_1690405639",G="ExperiencesExitIntentInterstitial",Y="EXP_EXIT",K=["HotelsFusion"],M="braze_integration_test__h_lithium_1691691916",N="EXIT",W="brazeInitialized",O="brazeInterstitialsData",U="visible",$="USER",J=()=>{var{page:e}=b(),t=K.includes(e),r=g(E.TARGETING),{userAgentCategory:a}=T(),n=f({experimentKeys:[M],page:e},!(t&&r&&"DESKTOP"===a));return n?.[M]&&n?.[M]!=="control"},Q=(e,t)=>{var[r,i]=a(!1);return n(()=>{var r;return t||(r=setTimeout(()=>i(!0),e)),()=>clearTimeout(r)},[e,t]),r},F=()=>{var{page:e}=b(),t=q.includes(e),r=g(E.TARGETING),{userAgentCategory:a}=T(),n=B();return k(0,!1)&&(t&&r&&"DESKTOP"===a||n)},ee=()=>{var[e,i]=a(null),s=I(),l=!!(s.startsWith("hare")||s.includes("qa.tripadvisor-preview.com"));return n(()=>{var e;return(async()=>{var{initialize:r,automaticallyShowInAppMessages:a,openSession:n,destroy:s}=await t("1tnit4"),o=r(l?"33cabfd1-22ad-4bb9-b839-923528e22192":"6e55efa5-e689-47c3-a55b-e6d7515a6c5d",{baseUrl:"sdk.iad-05.braze.com",sessionTimeoutInSeconds:300,minimumIntervalBetweenTriggerActionsInSeconds:1,enableLogging:l,allowUserSuppliedJavascript:!0,manageServiceWorkerExternally:!0,noCookies:!0,inAppMessageZIndex:10104});o?(a(),n(),e=s,p.set(W,!0,P)):p.set(W,!1,P),i(o)})(),()=>{e&&e()}},[l]),r(d,{component:m.braze,status:e?v.ok:v.missing,enabled:null!==e})},et=()=>L()?r(l,{children:r(ee,{})}):null,er={error:"/HD6ArEBAtTwBI7ZVjta90qp4unZxfbHurUTBGj19rQQ0+FVYV8WhM5fZH0wzrq+",ok:"/HD6ArEBAtTwBI7ZVjta9/W82wQIR3jyvbLaRjmIOqY="},ea=()=>{var e=L(),{browser:r,os:a}=T(),n=w(),s=_(),l=y(),{params:o}=b(),u="detailId"in o?o.detailId:0,c="geoId"in o?o.geoId:0,d=j.useConstantIncrementCallback();return i(async({event:i,eventProperties:o})=>{if(p.get(W)&&e){var{logCustomEvent:m}=await t("1tnit4");try{m(i,{...o,page:l,detailId:u,geoId:c,deviceType:n,locale:s}),d(er.ok)}catch(e){console.error(`[Braze] Problem occurred on: ${r.family} - ${r.majorVersion} | ${a.family} - ${a.majorVersion} | `,e),d(er.error)}}},[e,l,u,c,n,r,a,s,d])},en=(e,t,r)=>{var a=e.get(t),n=new Date().getTime();return a&&a?.find(e=>e.key===r&&(!e.ttl||e.ttl>=n))||null},ei=(e,t,r)=>{var a=es(),n=en(a,e,t)?.value;return n&&"object"==typeof n?n[r]:null},es=()=>new Map(p.get(O)),el=(e,t,r)=>{var a=e.get(t),n=new Date().getTime();return a=a?.filter(e=>e.key!==r.key&&(!e.ttl||e.ttl>=n))||[],r.ttl&&(r.ttl+=n),a.push(r),e.set(t,a),e},eo=(e,t,r,a)=>{if(null!=e){var n=es();el(n,e,{key:t,value:r,ttl:a}),p.set(O,Array.from(n.entries()))}},eu=(e,t,r,a)=>{if(null!=e){var n=ei(e,a,t);eo(e,a,{[t]:null==n?1:n+1},r)}},ec=e=>{var t=x.getObjectValueFromStorage(e,U,$);return null==t?0:t},ed=()=>{var{params:e}=b(),t=y(),r=!!z(),a=C();return{trackImpression:i(({itemName:n,customData:i})=>{a({itemName:n,page:t,geoId:"geoId"in e&&e.geoId||null,locationId:"detailId"in e&&e.detailId||null,customData:JSON.stringify({...i,signedIn:r})})},[a,e,t,r])}},em=({dismiss:e=()=>{}})=>{var t=D(),r=s(t),{trackImpression:l}=H(),[o,u]=a(!1),[c,d]=a(!0),m=f({experimentKeys:[X]},c),v=m?m[X]:"",I=i(()=>ec(Y)+1,[]),p=i(e=>{"test"===v&&e<=3&&l({itemName:G,customData:{impressionCount:e,sessionCount:e}})},[v,l]),b=s(p),g=i(e=>{if(o){if(e.clientY<=0&&v){var r=I();t({event:N,eventProperties:{abTestValue:v,displayCount:r}}),p(r)}else e.clientY<=0&&!v&&d(!1)}},[o,v,I,t,p]);return n(()=>{r.current!==t&&(r.current=t),b.current!==p&&(b.current=p)},[t,p]),n(()=>{if(!c&&v){var e=I();r.current({event:N,eventProperties:{abTestValue:v,displayCount:e}}),b.current(e)}},[v,c,I]),n(()=>{var e=setTimeout(()=>u(!0),R);return()=>{e&&clearTimeout(e)}},[]),S("mouseout",g),S("beforeunload",e),null},ev=()=>{var e=e=>r(em,{dismiss:e}),t="interstitials-braze";return A({factory:({dismiss:t})=>e(t),eventTypes:[t],key:t,tier:700}),null};return[()=>{h=12*(30*(P=864e5)),R=15e3,B=J,k=Q,L=F,V=et,j=new o({metricName:"/HD6ArEBAtTwBI7ZVjta93C0lsh0r5m7+1h2uMR+Ctj6S7rKi5+tmJVNyp6fjPiaq5rr6c5rsp+XGnGmyrZ6y64ZVL67MHPVqEacrZP0wZY=",version:0,additionalLabels:["/HD6ArEBAtTwBI7ZVjta98Sr44QR3Z1Lmq5fKuJGI7cdKriEzyXX7YlewxVwwfzY"],labelHooks:[u,c]}),D=ea,x={getObjectValueFromStorage:ei,getBrazeStorageData:es,saveValueToLocalStorage:eo,saveDisplayCountToBrazeStorage:eu},H=ed,Z=ev,e({Braze:V,EXP_EXIT_TEMPLATE:Y,EXP_EXIT_TRACK_ITEM_NAME:G,InterstitialsBraze:Z,LOCAL_STORAGE_TTL_01_YEAR:h,PER_USER_DISPLAY:$,VISIBLE:U,brazeStorage:x,getStoredDisplayCount:ec,useBrazeLogCustomEventCallback:D})},[e=>r=e.jsx,e=>(a=e.useState,n=e.useEffect,i=e.useCallback,s=e.useRef),e=>(l=e.ErrorBoundary,o=e.Counter,u=e.useSourceLabel,c=e.useWebApplicationLabel),e=>(d=e.StatusCounter,m=e.Component,v=e.Status),e=>I=e.useDomainName,e=>p=e.default,e=>b=e.useRoute,e=>(g=e.useConsent,E=e.CategoriesEnum),e=>T=e.useUserAgent,e=>f=e.default,e=>y=e.default,e=>w=e.useViewportCategory,e=>_=e.useLocale,e=>A=e.usePopupHierarchyRender,e=>S=e.useWindow,e=>C=e.default,e=>z=e.useUserId]]},["121h32","1o4yt4","183pm0","16nmgr","qlcuu5","19b9b1","fgwvq1","1973cc","1nnprh","gugp1d","eqoaya","1ys6v1","17thqz","1xo1is","ltllz9","xg719z","52far5"]]);
