(this.$WP=this.$WP||[]).push(["1a85j3",(e,r)=>{var t,i,a,n,l,o,d,c,s,u,p,v,m,h,g,f,b,T,y,I,C,w,N,k,P,S,E,x,D,M,B,j,_,O,L,R,A,G,V,q,F,z,W,Y,H,Z,J,Q,U,$,K,X,ee,er,et,ei,ea,en,el,eo,ed,ec,es,eu,ep,ev,em,eh,eg,ef,eb,eT,ey,eI,eC,ew,eN,ek,eP,eS,eE,ex,eD,eM,eB,ej,e_,eO,eL,eR,eA,eG,eV,eq,eF,ez=({children:e})=>{var[r,i]=l(!1),a=o(()=>({isStickyHeaderOpen:r,setIsStickyHeaderOpen:i}),[r,i]);return t(eT.Provider,{value:a,children:e})},eW=()=>{var e=d(eT);if(null==e)throw Error("useStickyHeaderContext used when not inside of a StickHeaderContextProvider");return e},eY=({children:e,scrollContainerRef:r,sectionRefMapping:i})=>{var[a,n]=l(0),d=s(i),c=s(new Map);u(()=>{d.current=i},[i]);var v=p((e,r)=>{var t="string"==typeof e?d.current.get(e):e;if(null==t||null==r)return()=>{};var i=c.current.get(t)||[];return i.push(r),c.current.set(t,i),function(){c.current.set(t,i.filter(e=>e!==r))}},[]),m=p(e=>{var t="string"==typeof e?d.current.get(e):e;if(t?.current){var i=c.current.get(t);i?.length?i.forEach(e=>e(n,t,a)):n(a)}function n(e){if(t?.current){var{y:i}=t.current.getBoundingClientRect();r?.current?.scrollBy({top:i-e,behavior:"smooth"})}}},[a,r]),h=o(()=>({sectionRefMapping:i,scrollOffset:a,setScrollOffset:n,scrollToSection:m,registerHandler:v,scrollContainerRef:r}),[i,a,n,m,v,r]);return t(eI.Provider,{value:h,children:t(ey,{children:e})})},eH=()=>{var e=d(eI);if(null==e)throw Error("useSectionScrollContext used when not inside of a SectionScrollProvider");return e},eZ=(e,r)=>{var{registerHandler:t}=eH(),i=s(void 0);u(()=>{i.current=r});var a=p((e,r,t)=>{i.current?.(e,r,t)},[]);u(()=>t(e,a),[t,a,e])};function eJ({onScroll:e,throttle:r,useDebounce:t,useCapture:i,scrollContainerRef:a}){var l=r||200,o=n.useMemo(()=>D(e,l,{trailing:!t}),[e,l,t]);return n.useEffect(()=>{var e=a?.current;if(null!=e&&null!=o)return e.addEventListener("scroll",o,i),()=>{e.removeEventListener("scroll",o,i)}},[a,o,i]),null}var eQ={sticky:"aGWPa _U l",stickyHeader:"SRyWz t",visible:"APidY",row:"f u k",tabWrapper:"hJsNx _u Pj PN Pw PA",saveOrViewTripCtaWrapper:"jZhZO I"},eU=({anchorRef:e,tabBar:r,tabSectionRefs:a,onVisible:l,onActiveTabChange:o,saveOrViewTripCta:d})=>{var c=M(),s=S(),[u,p]=n.useState(0),[v,m]=n.useState(!1),[h,g]=n.useState(0),f=n.createRef(),{scrollToSection:b,setScrollOffset:T,scrollContainerRef:y}=eH(),{setIsStickyHeaderOpen:C}=eW(),w=n.useCallback(()=>{if(e.current){var{offsetTop:r}=e.current,{top:t}=e.current.getBoundingClientRect(),i=t<r;m(i),C(i)}},[e,C]),N=n.useCallback(()=>{var e=f.current?.getBoundingClientRect()?.top??0,r=(f.current?f.current.offsetHeight+10:10)+e;g(r),T(r)},[f,T,g]),k=n.useCallback(()=>{var e=h+1,r=Number.MAX_SAFE_INTEGER,t=0;a.forEach((i,a)=>{if(i.current){var n=Math.abs(i.current.getBoundingClientRect().y-e);n<r&&(t=a,r=n)}}),t!==u&&o(t),p(t)},[a,h,u,o]),P=n.useCallback(()=>{w(),N(),k()},[k,N,w]);return(n.useEffect(()=>{w(),N()},[N,w]),n.useEffect(()=>{v&&l?.()},[v,l]),s)?null:t("div",{ref:f,className:E(eQ.sticky,eQ.stickyHeader,v&&eQ.visible),children:i(I,{children:[t(x,{callback:P,throttle:300}),t(eJ,{scrollContainerRef:y,onScroll:P,throttle:300}),i("div",{className:eQ.row,children:[t("div",{className:eQ.tabWrapper,children:r(b,u)}),t("div",{className:eQ.saveOrViewTripCtaWrapper,children:"MOBILE"!==c&&d("sticky-header")})]})]})})},e$={"title-02":28,"title-03":24,"title-04":18,"body-01":16},eK=({width:e,variant:r="body-01"})=>t("div",{style:{width:e,height:e$[r]},className:ec("NvuUX o",{BfjIN:"title-02"===r,zhRLt:"title-03"===r,loyuq:"title-04"===r,gfvTs:"body-01"===r}),children:t(A,{})}),eX=["95%","97%","92%","98%","96%"],e0=({lines:e=5,...r})=>{var[i]=es(r);return t("div",{className:eu(i),children:[...Array(e).keys()].map(e=>t("div",{className:"tyqkd",children:t(eN,{width:eX[e%eX.length]})},e))})},e1=()=>t("div",{className:"w _Z Re o",children:t(A,{})}),e2=()=>i("div",{children:[t(A,{}),t("div",{className:"_Q t l w",children:t(G,{})})]}),e5=({name:e,link:r,pricingInfo:a,tripId:n,itemId:l,bookableExperienceId:o})=>{var d=b(),c=C(),s=p(()=>{c("TripDetailsCTAClick",{tripId:n,itemId:l,bookableExperienceId:o})},[c,n,l,o]);if(!a?.fromPrice||!e)return null;var u=t(el,{price:t(F,{variant:"supporting-03",display:"inline",children:d.formatCurrency(a.fromPrice)}),isPerGroupPricing:"UNIT"===a.pricingType,isTieredPricing:a.isTieredPricing||void 0,maxTravelersPerUnit:a.maxTravelersPerUnit||void 0});return i("div",{className:"QrFps f Q3 u Pj PX Pw PJ",children:[t(en,{size:24}),i("div",{className:"f Fh w k u",children:[t(F,{variant:"supporting-01",lineClamp:2,children:e}),t("div",{className:"F0",children:t(F,{variant:"supporting-01",children:r?t(Y,{onClick:s,theme:"standalone",href:r,activated:!0,target:"_blank",children:u}):u})})]})]})},e3=({link:e,tripId:r,itemId:a,bookableExperienceId:n,pricingInfo:l})=>{var o=b(),d=C(),c=p(()=>{d("TripDetailsSeeOptions",{tripId:r,itemId:a,bookableExperienceId:n})},[d,r,a,n]);if(!l?.fromPrice)return null;var s=t(el,{price:t(F,{variant:"supporting-03",display:"inline-block",children:o.formatCurrency(l.fromPrice)}),isPerGroupPricing:"UNIT"===l.pricingType});return i("div",{className:"f Q3 u k Mj",children:[t(F,{variant:"supporting-01",children:s}),e&&t(B,{variant:"secondary-commerce",size:"small",href:e,target:"_blank",onClick:c,children:"See options "})]})},e4=({item:e,tripId:r})=>{if(e?.object?.recommendedProduct){var i=e.object.recommendedProduct;return t(e5,{name:i.title?.text||null,pricingInfo:i.pricingInfo,link:i.route?.url,bookableExperienceId:e.object.recommendedProduct.activityId,tripId:r,itemId:e.id})}var a=e?.object?.object;if(et(a)){var n=a.object;if(n?.placeType==="ACTIVITY"&&n?.locationV2?.details?.__typename==="LocationSelection_AttractionProductDetails"&&n?.locationV2.details.productDetails?.pricingInfo)return t(e3,{tripId:r,itemId:e?.id,bookableExperienceId:a.locationId,name:n.name,pricingInfo:n.locationV2.details.productDetails.pricingInfo,link:n.route?.url})}return null},e6=({cardLink:e,tripId:r,title:a,description:n,award:o,photos:d,reviewSummary:c,tripItem:s,onSaveFeedbackItem:u,onClick:p,onIndividualSaveComplete:v})=>{var m=eo(),h="MOBILE"===M(),g=et(s.object?.object)&&s.object?.object?.object||null,[f,b]=l(0),T=(e,t)=>{m({itemName:"SuccessfulItemSave",itemType:"ViewGAI",customData:{itemId:s.id,gaiTripId:r,destinationTripId:t,saveCreationMethod:"GAI",isNew:"CREATED"===e}})},{rating:y,ratingCounts:I}=c||{},C=I&&I.reduce((e,r)=>null!==e&&null!==r?e+r:e,0),w=o?.year?t(H,{size:"large",color:"BOTB"===o.awardType?"yellow":"green",year:o.year}):void 0,N=X(s.object?.object),k=t(K,{id:N?.id??0,type:N?.type,onSaveComplete:v,viewTripOpensNewTab:!0,onViewTripToastVisible:T,onAutosavedToTripToastVisible:T,sourceTripId:r,tripItemId:s.id??0}),P=d?t(Z,{award:w,action:k,roundedCorners:!0,children:t(Y,{theme:"image",href:e,target:"_blank",onClick:p,children:t($,{itemRenderer:e=>t(W,{source:d?.[e],width:"100%",height:"100%"}),totalCount:d.length,currentIndex:f,onNav:e=>b(e),arrowSize:"small"})})}):void 0;return i(J,{header:t(ei,{onClick:p,title:a,reviewData:y&&C?{reviewCount:C,rating:y}:void 0,itemLink:e,content:g?.placeType&&t(ea,{item:g,variant:"extended"})}),media:P,secondary:t(eE,{tripId:r,item:s}),variant:"vertical",mediaLayout:{type:"FlexMediaVerticalHeight",height:h?150:200},children:[t(Q,{children:t(U,{children:n})}),g&&t(er,{item:g,tripId:r,onSaveFeedback:u})]})},e9={__key:0xacbc555d50e5,id:"acbc555d50e5d83af54aad71c275e1f7",loc:{},definitions:[]},e7=e=>{if(!e)return null;var{locationItem:r}=e;return r?.object?.placeType==="ACTIVITY"&&r?.object?.locationV2?.details?.__typename==="LocationSelection_AttractionProductDetails"&&r?.object?.locationV2.details.productDetails?.pricingInfo?r?.locationId:e?.tripItem?.object?.recommendedProduct?e?.tripItem?.object?.recommendedProduct?.activityId:null},e8=(e,r)=>{var t=96/(e.length||1);return Math.min(100,Math.round(e.reduce((e,r)=>0===r.items.length?e+(r.description?1:0):e+t*((r.items.filter(e=>null!=e.gaiNarration).length+(r.description?1:0))/(r.items.length+1)),0)+(r?4:0)))},re=e=>{var r=e?.object?.object;if(!et(r))return null;var t=r?.object;return r&&t?.locationId&&e.id?{id:e.id,latitude:t.latitude,longitude:t.longitude,placeType:t.placeType,name:t.name||null,gaiNarration:e?.object?.narrativeDescription?.plainText||null,reviewSummary:t.reviewSummary,photos:ee(t),url:t.route?.url||null,award:t.locationV2?.bestAwardForActiveYearV2?.year?{year:t.locationV2?.bestAwardForActiveYearV2.year,awardType:t.locationV2?.bestAwardForActiveYearV2.awardType??void 0}:void 0,tripItem:e,locationItem:r}:null},rr=e=>{var r=e.generatedTripRequest?.locationIds?.[0],t=r?e.tripLocations?.find(e=>e?.location?.locationId===r):null;return t?t?.location:e.tripLocations?.[0]?.location},rt=(e,r)=>{var{title:t,description:i,items:a,structure:n,generatedTripRequest:l}=e,{locationId:o,latitude:d,longitude:c,name:s}=rr(e)??{},u=new Map;a?.forEach(e=>{e?.id&&u.set(e.id,e)});var p=n?.buckets?.filter(Boolean).map((e,t)=>{var i=r.string("triplist_itineraryday_ffffe73c",{0:t+1}),a=e.narrativeDescription?.plainText,n=e.narrativeDescription,l=[];return(e.items?.filter(Boolean).map(e=>u.get(e)).filter(Boolean)??[]).forEach(e=>{var r=re(e);r&&l.push(r)}),{id:e.id,title:i,description:a,formattedDescription:n,items:l}})??[];return{title:t,description:i,days:p,centerPoint:null!=d&&null!=c?{latitude:d,longitude:c}:null,geoId:o??null,geoName:s??"",includeChildren:l?.includeChildren??!1,travelingWith:l?.travelingWith,tripDate:l?.tripDate,progress:e8(p,null!=i)}},ri=(e,r,t)=>{var i=T(),{localize:a}=y(),[n,o]=l(!0),d=s(null),c=s(null),[{fetching:p,error:v,data:m},h]=ed({query:e9,variables:{tripIds:[e??0],currency:i},pause:!e}),g=m?.Trips_getTrips?.[0]??null;return u(()=>{!p&&r&&d.current!==r&&(d.current&&(o(!0),c.current=g,h({requestPolicy:"network-only"})),d.current=r)},[h,p,g,r]),u(()=>{n&&"LOADING"!==t&&c.current!==g&&o(!1)},[n,t,g]),{fetching:p||n,error:v,trip:g?rt(g,a):null}},ra=e=>`day:${e}`,rn=(e,r)=>`item:${e}-${r}`,rl={container:"ryxip",sidebar:"JXcQL",bar:"fCjSP",card:"ImYPs",marker:"ZrEaT Gy u j Pb PO Po PB",titleMarker:"tGROH"},ro=({tripId:e,dayId:r,item:i,step:a,locationId:n,initiallyExpanded:o=!1,isConnected:d=!0,loading:c,onSaveFeedbackItem:s,onIndividualSaveComplete:u})=>{var[v,m]=l(o),{sectionRefMapping:h,scrollOffset:g,scrollContainerRef:f}=eH(),b=C(),T=h.get(rn(r,i.id)),y="MOBILE"===M(),{setSelectedItemId:I}=k(),w=p(()=>{y||I(i.id)},[I,i.id,y]),N=p(()=>{I(null)},[I]);eZ(T,(e,r)=>{var t=r?.current?.offsetTop??0;m(!0),setTimeout(()=>{f?.current?.scrollTo({top:t-g,behavior:"smooth"})},0)});var P=p(()=>{b("TripDetailsItemClick",{tripId:e,itemId:i.id,location:i.locationItem?.object?.name,bookableExperienceId:e7(i)})},[i,b,e]),S=p(t=>{b(t?"TripDetailsCollapse":"TripDetailsExpand",{tripId:e,dayId:r,locationId:n}),m(e=>!e)},[b,e,r,n]);if(c&&null==i.gaiNarration)return t(ej,{step:a,isExpanded:v});var E=t(ex,{onClick:P,tripId:e,title:i.name,cardLink:i.url||void 0,photos:i.photos,award:i.award,reviewSummary:i.reviewSummary,onSaveFeedbackItem:s,description:t(F,{variant:"body-01",children:i.gaiNarration}),tripItem:i.tripItem,onIndividualSaveComplete:u});return t(eM,{ref:T,step:a,title:i.name,content:E,isOpen:v,isConnected:d,onExpandCollapseClick:S,onMouseEnter:w,onMouseLeave:N})},rd=({step:e=1,isExpanded:r=!1,isConnected:i=!1})=>{var a="MOBILE"===M();return t(eM,{step:e,title:t(eN,{variant:"title-04",width:250}),content:t(J,{header:t(eN,{variant:"title-04",width:200}),media:t(eP,{}),variant:"vertical",mediaLayout:{type:"FlexMediaVerticalHeight",height:a?150:200},children:t(Q,{children:t(U,{children:t(ek,{})})})}),isOpen:r,isConnected:i})},rc={openMapButton:"f u j w _Z",openMapOverlay:"VlNqW w _Z",closeMapButton:"BprOh",modal:"emGhX s _U Za Gg"},rs=({tripId:e,days:r,centerPoint:n,geoId:d,loading:c,hideMarkers:s})=>{var v="MOBILE"===M(),[h,g]=l(null),f=C(),{localize:b}=y(),{setSelectedItemId:T}=k();u(()=>{null!==h&&T(null)},[h,T]);var I=o(()=>s?[]:r.flatMap(e=>e.items).filter(e=>!c||null!=e.gaiNarration).map(({id:e,latitude:r,longitude:t,placeType:i,reviewSummary:a,name:n,photos:l,url:o,locationItem:d})=>e&&n&&r&&t&&i?{itemId:e,name:n,latitude:r,longitude:t,placeType:i,reviewSummary:a,thumbnail:l?.[0],url:o,locationItem:d}:null).filter(Boolean),[r,s,c]),w=p(r=>{f(r.zoom>r.oldZoom?"TripDetailsZoomIn":"TripDetailsZoomOut",{tripId:e})},[f,e]),P=p(()=>{f("TripDetailsMapScroll",{tripId:e})},[f,e]),S=p(r=>{f("TripDetailsMapPinClick",{tripId:e,itemId:r})},[f,e]);return d&&n?h?t(O,{hideBackdrop:!0,className:rc.modal,children:t(_,{children:t(m,{children:t(N,{locations:I,latitude:n.latitude,longitude:n.longitude,geoId:d,loading:c,onZoomChange:w,onPanStart:P,onPinClick:S,cardPositioning:"map-bottom",children:t("div",{className:rc.closeMapButton,children:t(j,{icon:L,onClick:()=>g(!1),"aria-label":b.string("phoenix_accessibility_back_label")})})})})})}):t(N,{locations:I,latitude:n.latitude,longitude:n.longitude,geoId:d,loading:c,onZoomChange:w,onPanStart:P,onPinClick:S,hideLoadingIndicator:!0,children:v&&i(a,{children:[t("div",{className:rc.openMapOverlay}),t("div",{className:rc.openMapButton,children:i(B,{variant:"secondary",onClick:()=>g(!0),children:[t(R,{size:20}),"Map view"]})})]})}):c?t(eS,{}):null},ru=({formattedText:e,referenceHighlighter:r,fallbackText:i})=>{if(!e?.text)return i;var a=new Map(e.references?.filter(Boolean).filter(e=>e?.name!=null).map(e=>[`{{${e.name}}}`,e]));return(e.text.match(RegExp("\\{\\{(?<tag>[\\w-]+)\\}\\}","gu"))||[]).every(e=>a.has(e))?e.text.split(RegExp("(?<tag>\\{\\{[\\w-]+\\}\\})","u")).map((e,i)=>{var n=a.get(e);return t(h,{children:n?r(n):e},i)}):i},rp={container:"XBzgG Y",content:"wltje _ Y",visible:"qKrBp"},rv=({children:e,placeholder:r,ready:a})=>{var[n,o]=l(!1);return u(()=>{var e=setTimeout(()=>{o(!0)},50);return()=>clearTimeout(e)},[]),i("div",{className:E(rp.container,n&&rp.visible),children:[t("div",{className:E(rp.content,a&&rp.visible),children:a?e:null}),!a&&r]})},rm={highlight:"Wb _S"},rh=({tripId:e,id:r,title:n,geoId:l,formattedDescription:o,fallbackDescription:d,items:c,expandFirstItem:s=!1,loading:u,onSaveFeedbackItem:p,onIndividualSaveComplete:v})=>{var{sectionRefMapping:m,scrollToSection:h}=eH(),g=C(),f=m.get(ra(r)),b=o||d?t(eO,{formattedText:o,fallbackText:d,referenceHighlighter:({value:i,itemId:a})=>{var n=a?m.get(rn(r,a)):null;if(!n)return i;var l=()=>{g("TripDetailsTextJump",{tripId:e,itemId:a,text:i}),h(n)};return t("span",{role:"button",onClick:l,onKeyDown:e=>"Enter"===e.key&&l(),tabIndex:0,className:rm.highlight,children:t(F,{variant:"button-01",elementType:"span",children:i})})}}):null;return t("div",{ref:f,children:i(eL,{ready:!u||null!=b&&c.length>0,placeholder:i(a,{children:[t(F,{variant:"title-03",children:n}),t(ek,{marginTop:"spacing-02",marginBottom:"spacing-03"}),t(ej,{step:1,isConnected:!0,isExpanded:s}),t(ej,{step:2,isConnected:!0}),t(ej,{step:3})]}),children:[t(F,{variant:"title-03",children:n}),b&&t(F,{variant:"body-01",marginTop:"spacing-02",marginBottom:"spacing-03",children:b}),c.length>0&&c.map((i,a)=>t(eB,{tripId:e,dayId:r,item:i,locationId:l,initiallyExpanded:s&&0===a,step:a+1,isConnected:a!==c.length-1,loading:u,onSaveFeedbackItem:p,onIndividualSaveComplete:v},i.id))]})})},rg={text:"yEZLz _T",completed:"xSFoe"},rf=({text:e,keySpeed:r=25,onComplete:i})=>{var[a,n]=l([]),[o,d]=l(!1),c=s([...e].reverse());return u(()=>{var e=setInterval(()=>{if(c.current.length<=0){d(!0),i?.(),clearInterval(e);return}var r=c.current.pop();n(e=>e.concat(r||""))},r);return()=>{clearInterval(e)}},[r,i,e]),t("div",{className:E(rg.text,o&&rg.completed),children:a.join("")})},rb=({tripId:e,tripTitle:r,tripDescription:n,geoId:o,days:d,loading:c,onReady:s,onSaveFeedbackItem:v,onIndividualSaveComplete:m})=>{var[h,g]=l(!1),[f,b]=l(!1);u(()=>{if(n&&h&&!f){var e=setTimeout(()=>{b(!0)},1e3);return()=>clearTimeout(e)}},[h,f,n]);var T=p(()=>{g(!0),s?.()},[s]);return i("div",{children:[i("div",{className:"f u Q2 MJ",children:[t("div",{className:"vTQRY Rb f j u",children:t(q,{size:16})}),t(F,{variant:"supporting-02",color:"placeholderText",children:"This trip is powered by AI."})]}),r&&t(F,{variant:"title-02",marginBottom:"spacing-04",children:t(eA,{text:r,onComplete:T})}),(h||!c)&&t(eL,{ready:!!n||!c,placeholder:t(ek,{}),children:!!n&&t(F,{variant:"body-01",children:n})}),(f||!c)&&i(a,{children:[t(V,{marginY:"spacing-04"}),d.map(({id:r,title:i,description:a,formattedDescription:n,items:l},d)=>t(eR,{tripId:e,id:r,geoId:o,title:i,formattedDescription:n,fallbackDescription:a,items:l,expandFirstItem:0===d,loading:c,onSaveFeedbackItem:v,onIndividualSaveComplete:m},r))]})]})};function rT(e){var[r,t]=l(!1);return p((...i)=>{r||(t(!0),e(...i))},[e,r])}var ry={bar:"eAdfK w",fade:"TnzZF",progress:"nDHWc",message:"PXCKk f K o F",spacer:"ghkJD"},rI=({progress:e=0,message:r,"aria-label":a})=>{var[n,o]=l(0),[d,c]=l("LOADING");return 0!==n&&e>n&&o(e),u(()=>{0===n&&o(e)},[n,e]),u(()=>{if(100===n){var e=setTimeout(()=>{c("COMPLETE")},1e3),r=setTimeout(()=>{c("HIDDEN")},2e3);return()=>{clearTimeout(e),clearTimeout(r)}}},[n]),"HIDDEN"!==d?i("div",{className:E(ry.bar,"LOADING"!==d&&ry.fade),role:"progressbar","aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":n,"aria-label":a,children:[t("div",{className:ry.progress,style:{width:`${n}%`}}),r&&i("div",{className:ry.message,style:{width:`${n}%`},children:[t("span",{className:ry.spacer}),t(F,{variant:"supporting-02",color:"accentPurpleText",children:r})]})]}):null},rC={gaiTrip:"OKHCk",content:"KUkEb",itinerary:"CamCP",saveOrViewTripCtaWrapper:"eDWJY",map:"PWuLm",mapWrapper:"vNChN",tabBar:"bYkpq z",chip:"uXLJv",progressBar:"MYIBl"},rw=({tripId:e,title:r,description:a,days:n,centerPoint:d,geoId:c,loading:s,progress:v=0,scrollContainerRef:m,onSaveFeedbackItem:h,saveOrViewTripCta:f,onIndividualSaveComplete:b})=>{var[T,N]=l(s),k=C(),S=w(),{localize:E}=y(),x=rT(p(()=>{S("TripGaiTripDetails",{date:new Date().toISOString(),timestamp:Date.now(),tripId:e,title:r,titleNarration:a,days:n.map(e=>({day:e.title,dayNarration:e.description,items:e.items.map(e=>({id:e.id,location:e.locationItem?.object?.name,GAIItemNarration:e.gaiNarration,bookableExperienceId:e7(e)}))}))})},[n,a,S,r,e])),D=rT(p(()=>{S("TripGAITripGenerated",{date:new Date().toISOString(),timestamp:Date.now(),tripId:e})},[S,e]));u(()=>{s||x()},[s,x]);var M=p(()=>{D(),N(!1)},[D]),B=o(()=>n.flatMap(e=>[ra(e.id),...e.items.map(r=>rn(e.id,r.id))]).reduce((e,r)=>(e.set(r,g()),e),new Map),[n]),j=n[0]?B.get(ra(n[0].id)):void 0,_=n.map(e=>B.get(ra(e.id))).filter(Boolean),O=(r,t)=>{var i=B.get(ra(r));i&&(k("TripDetailsDayJump",{tripId:e,dayId:r}),t(i))},L=p(r=>{var t=n[r];t&&k("TripDetailsScroll",{tripId:e,day:t.title})},[n,k,e]),R=s?Math.min(v,T?20:100):100,A=R<=85?E.string("trips_gai_entry_finalizing_itinerary"):void 0;return t(P,{children:i(eC,{scrollContainerRef:m,sectionRefMapping:B,children:[j&&!s&&t(ew,{saveOrViewTripCta:f,onActiveTabChange:L,anchorRef:j,tabSectionRefs:_,tabBar:(e,r)=>t(ev,{value:r,children:t("div",{className:rC.tabBar,children:n.map((i,a)=>t("div",{className:rC.chip,children:t(ep,{widthVariant:"full",selected:a===r,onClick:()=>O(i.id,e),"aria-label":i.title?.toString(),children:i.title})},i.id))})})}),i("div",{className:rC.gaiTrip,children:[t("div",{className:rC.progressBar,children:t(eV,{progress:R,message:A})}),t(I,{children:i("div",{className:rC.content,children:[i("div",{className:rC.itinerary,children:[!s&&t("div",{className:rC.saveOrViewTripCtaWrapper,children:f("top")}),t(eG,{tripId:e,tripTitle:r,geoId:c,tripDescription:a,days:n,loading:s,onReady:M,onSaveFeedbackItem:h,onIndividualSaveComplete:b})]}),t("div",{className:rC.map,children:t("div",{className:rC.mapWrapper,children:t(e_,{tripId:e,days:n,centerPoint:d,geoId:c,loading:s,hideMarkers:T})})})]})})]})]})})},rN=({tripId:e,onSaveFeedbackItem:r,saveOrViewTripCta:i,onIndividualSaveComplete:a})=>{var{trip:n,fetching:l}=eD(e,null,"COMPLETE");if(!n)return null;var{title:o,description:d,days:c,centerPoint:s,geoId:u,progress:p}=n;return t(rw,{tripId:e,title:o,description:d,days:c,centerPoint:s,geoId:u,loading:l,onSaveFeedbackItem:r,progress:p,saveOrViewTripCta:i,onIndividualSaveComplete:a})};function rk({trip:e,saveOrViewTripCta:r,...i}){return e?t("div",{className:"vnYqC f e Q2",children:t(rw,{title:e.title,description:e.description,days:e.days,centerPoint:e.centerPoint,geoId:e.geoId,progress:e.progress,saveOrViewTripCta:r,...i})}):null}function rP({tripId:e,tripTitle:r,onSave:a,onItemClick:n,onCreateTripInputChange:l,variant:o="light",position:d}){var c=C(),s=w();return t(eh,{saveObject:{id:e,type:"gaiTrip"},initialTitle:r,active:!1,object:null,onComplete:(e,r)=>a(r),onItemClick:n,onCreateTripInputChange:l,onViewTripToastVisible:(r,t)=>{s("SuccessfulItinerarySave",{gaiTripId:e,destinationTripId:t,saveCreationMethod:"GAI",isNew:"CREATED"===r})},children:r=>t(B,{onClick:()=>{c("TripDetailsSaveItinerary",{tripId:e,position:d}),r()},variant:"light"===o?"gai":"gai-dark",children:i("div",{className:"f u j",children:[t(em,{marginRight:"spacing-01"}),t(f,{id:"trips_gai_modal_save_itinerary_cta"})]})})})}var rS={__key:77123089732951,id:"46249e5e1557822574e1f344de5a546d",loc:{},definitions:[]},rE=e=>"COMPLETE"===e,rx=e=>"ERROR"===e||"UNKNOWN"===e,rD=(e,r)=>rE(e)?"COMPLETE":rx(e)?"ERROR":r?"LOADING":"ERROR",rM=e=>{var[{fetching:r,data:t}]=eg({query:rS,variables:{request:{tripId:e||0}},isResultComplete:({data:e})=>{var r=e?.Trips_getGeneratedTripStatus?.status??null;return rE(r)||rx(r)},pollIntervals:eF,pause:!e}),i=t?.Trips_getGeneratedTripStatus?.status??null,a=t?.Trips_getGeneratedTripStatus?.lastUpdated??null,n=rD(i,r);return o(()=>({status:n,lastUpdated:a}),[n,a])},rB=({data:e})=>t("pre",{children:JSON.stringify(e,null,2)}),rj=({tripId:e})=>{var{path:r}=eb(),[{data:a}]=ed({query:e9,variables:{tripIds:[e??0],currency:T()},requestPolicy:"cache-only",pause:!e}),n=a?.Trips_getTrips?.[0];if(!n)return t(F,{variant:"body-01",children:"Loading trip details..."});var{id:l,title:o,tripLocations:d,generatedTripRequest:c}=n||{};return i("div",{children:[t(F,{variant:"title-04",marginBottom:"spacing-03",children:o}),t(F,{variant:"title-05",marginBottom:"spacing-01",children:"Trip ID"}),t(F,{variant:"body-01",children:t(Y,{theme:"inline",href:`${r}#/TripBuilder/${l}`,children:l})}),t(V,{marginY:"spacing-03"}),t(F,{variant:"title-05",marginBottom:"spacing-01",children:"Requested Params"}),t(rB,{data:c}),t(V,{marginY:"spacing-03"}),t(F,{variant:"title-05",marginBottom:"spacing-01",children:"Trip Locations"}),t(rB,{data:d})]})},r_=({tripId:e})=>(ef("GAI Trip",o(()=>t(rj,{tripId:e}),[e])),null);return e({GaiTripPreview:rk,SaveToTripButton:rP}),[()=>{eT=c(null),ey=ez,eI=c(null),eC=eY,ew=n.memo(eU),eN=eK,ek=e0,eP=e1,eS=e2,eE=e4,ex=e6,eD=ri,eM=v(function({step:e,title:r,content:a,isOpen:n,onExpandCollapseClick:l,onMouseEnter:o,onMouseLeave:d,isConnected:c=!0},s){var u=t("div",{className:rl.marker,children:t(F,{variant:"button-03",children:e})});return i("div",{className:rl.container,ref:s,onMouseEnter:o,onMouseLeave:d,children:[i("div",{className:rl.sidebar,children:[u,t("div",{className:c?rl.bar:void 0})]}),t("div",{className:rl.card,children:t(z,{question:i(F,{variant:"title-04",children:[t("span",{className:rl.titleMarker,children:u}),r]}),answer:a,answerType:"custom",onExpandCollapseClick:l,isExpanded:n})})]})}),eB=ro,ej=rd,e_=rs,eO=ru,eL=rv,eR=rh,eA=rf,eG=rb,eV=rI,eq=rN,eF=[...Array(15).fill(2e3),...Array(10).fill(3e3),...Array(12).fill(5e3),...Array(42).fill(1e4)],e({GaiTripDebugger:r_,GaiTripPreview:rk,IntermediateScreen:eq,SaveToTripButton:rP,getBookableExperienceId:e7,useGetGeneratedTrip:eD,useGetGeneratedTripStatus:rM})},[e=>(t=e.jsx,i=e.jsxs,a=e.Fragment),e=>(n=e,l=e.useState,o=e.useMemo,d=e.useContext,c=e.createContext,s=e.useRef,u=e.useEffect,p=e.useCallback,v=e.forwardRef,m=e.Suspense,h=e.Fragment,g=e.createRef),e=>(f=e.default,b=e.useIntlFormatter,T=e.useCurrency,y=e.useLocalize),e=>I=e.default,e=>(C=e.usePreviewInteractionLogger,w=e.usePreviewImpressionLogger),e=>(N=e.default,k=e.useTripsMapContext,P=e.TripsMapProvider),e=>S=e.useKeyboardNavigationMode,e=>E=e.default,e=>x=e.default,e=>D=e.default,e=>M=e.useViewportCategory,e=>(B=e.default,j=e.CircularButton),e=>_=e.ErrorBoundary,e=>O=e.ModalBase,e=>L=e.default,e=>R=e.default,e=>A=e.Skeleton,e=>G=e.default,e=>V=e.default,e=>q=e.default,e=>F=e.default,e=>z=e.ControlledCollapsibleListItem,e=>W=e.default,e=>Y=e.default,e=>H=e.default,e=>(Z=e.CardMedia,J=e.FlexCard,Q=e.CardContent,U=e.CardText),e=>$=e.default,e=>K=e.default,e=>(X=e.getSATDModalSaveObject,ee=e.getLocationPhotos),e=>er=e.GaiFeedback,e=>et=e.isLocationItemObject,e=>(ei=e.CardHeaderElement,ea=e.TripLocationIconContent),e=>en=e.default,e=>el=e.default,e=>eo=e.useImpressionLogger,e=>ed=e.useQuery,e=>(ec=e.default,es=e.getMarginProps,eu=e.margin),e=>ep=e.ChipButton,e=>ev=e.TabBar,e=>em=e.default,e=>eh=e.TripFlowSelector,e=>eg=e.usePollingQuery,e=>ef=e.useDebugPane,e=>eb=e.useRoute]]},["121h32","1o4yt4","17thqz","94v69w","ibebqy","amwhbz","12r4qu","fkji80","d6vj30","dsbyen","1ys6v1","jppfwt","183pm0","1uzmmz","17nq86","1bp96i","1qndsd","1ndszp","covaqn","1qk22a","1essqv","1ahn2t","34bu7w","lr6tb6","p9ucm8","6m9vgr","12rns1","1dpzon","xznza0","1af5eu","1r6ayw","19l2zs","s1ymgp","ec91du","sa2a6q","1mqwhq","gw8uw6","1b1clj","1227h6","1l75rc","9rb8bq","1fbuhs","1uvk21","fgwvq1"]]);
