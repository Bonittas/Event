(this.$WP=this.$WP||[]).push(["1iahto",(e,o)=>{var i,a,r,t,l,d,n,s,p,u,c,m,h,g,_,v,f,I,T,w,F,U,b,A,y,P,x,N,C,L,E,O,S,k,M,R,z,B,D,$,j,W,Z,q,V,Y,G,K,H,J,Q,X,ee,eo,ei,ea,er,et,el,ed,en,es,ep,eu,ec=[".mp4",".m4v",".mov"],em=(e,o,i)=>{var{localize:a}=v(),r=t(e=>"video"===i?`${e.name}: ${a.string("post_video_file_type_error")}`:`${e.name}: ${a.string("post_photo_unsupported_file")}`,[a,i]),l=t(e=>"video"===i?`${e.name}: ${a.string("post_video_size_error")}`:`${e.name}: ${a.string("file_size_too_big_photo_oops_message",{0:a.string("mobile_offline_megabyte_ffffec6c",{0:o/1024/1024})})}`,[a,o,i]);return t(a=>{if(a.size>o)return Promise.reject(new H(l(a)));var t=U(a.name);if(!t||!e.includes(t))return Promise.reject(new J(r(a)));var d=ec.includes(t);return"video"===i||void 0===i&&d?Promise.resolve():new Promise((e,o)=>{var i=new Image;i.onload=()=>{URL.revokeObjectURL(i.src),e()},i.onerror=()=>o(new J(r(a))),i.src=URL.createObjectURL(a)})},[e,o,r,l,i])},eh=(e,o)=>{var[i,a]=l(!1),r=w();return C("dragover",e=>{null!=e.dataTransfer&&[...e.dataTransfer.items].some(e=>"file"===e.kind)&&(e.dataTransfer.dropEffect="copy",e.preventDefault(),a(!0))}),C("dragleave",e=>{i&&(e.preventDefault(),a(!1))}),C("drop",t=>{if(i){t.preventDefault(),a(!1);var l=[];null!=t.dataTransfer&&(l=(t.dataTransfer.items?[...t.dataTransfer.items].map(e=>e.getAsFile()):[...t.dataTransfer.files]).filter(Boolean)),l.length>0&&(null!==o&&r({PhotoUploadFlow:{photoUploadWeb:{action:"fileSelectedDragDrop",description:o.length.toString()}}}),e(l))}}),{dragging:i}},eg={__key:0x98abf1e409a8,id:"98abf1e409a869100aa3814acb316b98",loc:{},definitions:[]},e_={__key:0x5df6eb18541e,id:"5df6eb18541ec9881fec65ad2ab088fe",loc:{},definitions:[]};function ev(e,o,i){return o in e?Object.defineProperty(e,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[o]=i,e}var ef=e=>new Promise((o,i)=>{var a=new Image;a.onload=()=>{URL.revokeObjectURL(a.src),o({width:a.width,height:a.height})},a.onerror=i,a.src=URL.createObjectURL(e)}),eI=(e,o,i,a)=>{e({PhotoUploadFlow:{photoUploadWeb:{action:"uploadFailStatus",description:o.statusText}}}),e({PhotoUploadFlow:{photoUploadWeb:{action:"uploadFailStatusCode",description:o.status}}}),e({PhotoUploadFlow:{photoUploadWeb:{action:"uploadFailResponse",description:o.response.toString()}}}),e({PhotoUploadFlow:{photoUploadWeb:{action:"uploadFail",description:`${i+1} of ${a}`}}}),console.error(`MEDIA_UPLOAD_ERROR: ${JSON.stringify({status:o.status,statusText:o.statusText,response:o.response.toString(),fileIndex:i+1,fileCount:a})}`)},eT=(e,o,i,a,r,t,l,d,n,s,p)=>new Promise((u,c)=>{var m=d=>{var m,g=!1,_=new Date().getTime(),v=()=>{null!==n&&(m&&clearTimeout(m),m=setTimeout(()=>{g=!0,a({PhotoUploadFlow:{photoUploadWeb:{action:"uploadFail",description:`${r+1} of ${t} upload has timed out after ${(new Date().getTime()-_)/1e3} seconds`}}}),console.error("MEDIA_UPLOAD_ERROR: Upload has timed out"),f.abort()},n))},f=new XMLHttpRequest;f.onload=()=>{m&&clearTimeout(m),200===f.status?(l||a({PhotoUploadFlow:{photoUploadWeb:{action:"uploadSuccess",description:`${r+1} of ${t}`}}}),u(o)):(p(),l||eI(a,f,r,t),c(Error(`Upload of file ${e.name} failed.`)))},f.onerror=()=>{p(),m&&clearTimeout(m),l||eI(a,f,r,t),c(Error(`Upload of file ${e.name} failed.`))},f.onabort=()=>(m&&clearTimeout(m),g)?h(d):(p(),c(Error(`Upload of file ${e.name} aborted.`))),f.upload.onprogress=e=>{v(),s(e.loaded)},f.open("PUT",i,!0),f.send(e),v()},h=e=>{var o=e-1;o<0?c(new Q):m(o)};h(d)}),ew={INITIALIZATION:19,UPLOAD:3,FINALIZE:19},eF=(e=null,o=1)=>{var i=w(),[a,r]=l(),[s,p]=l({queue:[],counts:{INITIALIZATION:0,UPLOAD:0,FINALIZE:0}}),u=d(!1);n(()=>(u.current=!0,()=>{u.current=!1}),[]);var[,c]=L(eg),[,m]=L(e_),h=O(S),g=k(S),_=M(S),v=R(S),f=z(S),I=B(S),T=t(e=>{if(u.current)return e;throw f(),Error("upload aborted")},[f]),F=t((e,o)=>new Promise(o=>{p(i=>({...i,queue:[...i.queue,{uploaderStep:e,resolve:()=>o(!0),uid:E()}]}))}).then(o),[]),U=t(e=>{p(o=>({...o,counts:{...o.counts,[e]:o.counts[e]-1}}))},[]);n(()=>{if(s.queue.length>0){var e={...s.counts},o={...s.counts},i=[],a=[];Object.keys(s.counts).forEach(o=>{var r=s.queue.filter(e=>e.uploaderStep===o);if(s.counts[o]<ew[o]){var t=ew[o]-s.counts[o],l=r.slice(0,t);a.push(...l),i.push(...l.map(e=>e.uid)),e[o]+=l.length}}),a.length>0&&(p(a=>({...a,queue:a.queue.filter(e=>!i.includes(e.uid)),counts:{INITIALIZATION:e.INITIALIZATION-(o.INITIALIZATION-a.counts.INITIALIZATION),UPLOAD:e.UPLOAD-(o.UPLOAD-a.counts.UPLOAD),FINALIZE:e.FINALIZE-(o.FINALIZE-a.counts.FINALIZE)}})),a.forEach(e=>e.resolve()))}},[s]);var b=t(({mediaType:a,file:t,description:l,locationId:d,isForCuration:n,isForUserReview:s,isAllowedNonLoggedInUpload:p,pid:u,pidAttr:f,uploaderProgressData:w},b,A)=>{var y=w?.uploaderStep||"INITIALIZATION",P=w?.mediaId,x=w?.uploadUrl,N={description:l,mediaType:"video"===a?"VIDEO":"PHOTO",mimeType:t.type,mediaProvider:"TRIPADVISOR",mediaUploadProvider:"USER",fileName:t.name,fileSize:t.size,locationIds:null!=d&&d>0?[d]:[],isForCuration:n,isForUserReview:s,isAllowedNonLoggedInUpload:p,pid:u,pidAttr:f},C=e=>(h(e.length),c({request:e})),L=()=>{var e=[N],o="video"!==a;return("video"===a?C(e):ef(t).then(({width:e,height:i})=>(e&&i&&e>0&&i>0&&(o=!1),C([{...N,width:e,height:i}])))).then(T).then(({data:e,error:i})=>{if(i||e?.MediaSvcClient_initiateMediaBatchUploadWithProvidedFields?.[0]?.status!=="OK"||e?.MediaSvcClient_initiateMediaBatchUploadWithProvidedFields?.[0]?.mediaId==null||e?.MediaSvcClient_initiateMediaBatchUploadWithProvidedFields?.[0]?.uploadUrl==null){if(i&&console.error(`MEDIA_UPLOAD_ERROR: ${i.toString()}`),e?.MediaSvcClient_initiateMediaBatchUploadWithProvidedFields?.[0]?.status==="RATE_LIMITED")throw v(),new X;throw _(),console.error(`Upload media error (internal): ${i}`),Error("Upload failed")}var{mediaId:a,uploadUrl:r}=e?.MediaSvcClient_initiateMediaBatchUploadWithProvidedFields?.[0];P=a,x=r,o&&console.error(`Upload media does not have dimensions mediaId/Url: ${P}/${x}`)}).then(e=>(U("INITIALIZATION"),e)).then(O)},E=()=>{if(y="UPLOAD",!P||!x)throw Error("Upload failed, mediaId or uploadUrl not provided");return eT(t,P,x,i,b,A.length,"video"===a,o,e,e=>r(o=>{var i=null==o?[]:[...o];return i[b]=e,i}),I).then(T).then(e=>(U("UPLOAD"),e)).then(e=>k(e))},O=()=>F("UPLOAD",E),S=(e=P)=>{if(y="FINALIZE",e)return m({request:{mediaId:e}}).then(()=>(g(1),{mediaId:e,mediaType:a})).then(e=>(U("FINALIZE"),e));throw Error("Finalization failed, mediaId not provided")},k=e=>F("FINALIZE",()=>S(e));return({INITIALIZATION:()=>F("INITIALIZATION",L),UPLOAD:O,FINALIZE:k})[y]().catch(e=>{throw U(y),new ee({mediaId:P,uploaderStep:y,uploadUrl:x},e)}).finally(()=>{r(null)})},[m,c,h,_,g,I,v,T,F,U,i,o,e]);return[{progress:a},t(e=>e.map(b),[b])]},eU=(e,o)=>e.name===o.name&&e.size===o.size,eb={media:[],error:null},eA=({mediaType:e,withMetadata:o,isForCuration:i,allowedFileTypes:a,maxFileSize:r,maxAllowedFiles:d,locationId:n})=>{var s=w(),{localize:p}=v(),u=em(a,r,e),[c,m]=l(eb),h=t(e=>{m(o=>({...o,error:e}))},[]),[g,_]=l(!1),f="video"===e,I=f?ei.maxAllowedFiles:eo.maxAllowedFiles,T=t(o=>{u(o).then(()=>{m(a=>a.media.some(e=>eU(e.file,o))?a:a.media.length>=d?d!==I?a:{error:f?p.string("video_upload_max_number",{nVideos:d}):p.string("post_photo_tips_guidelines"),media:a.media}:{error:a.error,media:[...a.media,{mediaType:e,file:o,description:"",locationId:n,isForCuration:i}]})}).catch(e=>{f||s({PhotoUploadFlow:{photoUploadWeb:{action:"invalidFile",description:e.message}}}),h(e.message)})},[u,d,i,n,p,h,e,I,f,s]),F=t(e=>{h(null),e.preventDefault(),[...e.target.files??[]].forEach(T),f||s({PhotoUploadFlow:{photoUploadWeb:{action:"fileSelectedFilePicker",description:c.media.length.toString()}}}),e.currentTarget.value=""},[T,h,s,f,c.media.length]),U=t((e,o)=>{m(i=>{var a=[...i.media];return a[e]=o,{error:null,media:a}})},[]),b=t(e=>{m(o=>{var i=[...o.media];return i.splice(e,1),{error:null,media:i}})},[]),{dragging:A}=eh(e=>{h(null),e.forEach(T)},f?null:c.media),y=!g&&c.media.length>0&&(!o||!f&&i||c.media.every(e=>e.description&&null!=e.locationId&&e.locationId>0)),[{progress:P},x]=eF(),N=t(()=>y?(f||s({PhotoUploadFlow:{photoUploadWeb:{action:"submitClicked"}}}),_(!0),h(null),Promise.all(x(c.media)).then(e=>(f||s({PhotoUploadFlow:{photoUploadWeb:{action:"uploadedAll"}}}),_(!1),e)).catch(()=>{f||s({PhotoUploadFlow:{photoUploadWeb:{action:"uploadedErrorExists"}}}),h(f?p.string("video_upload_fail"):p.string("post_photo_upload_failed")),_(!1)})):Promise.reject(),[x,y,c.media,h,p,f,s]);return{media:c.media,error:c.error,uploading:g,progress:P,canAddMore:c.media.length<d,canSubmit:y,dragging:A,onFileSelected:F,onMediaChanged:U,onMediaDeleted:b,onSubmit:N,resetMediaState:()=>m(eb)}},ey=({children:e,timeout:o,retryCount:r,mediaType:u,onRateLimitedError:c,beforePhotoUploadCheck:m,handleErrorsManually:h,...g})=>{var[v,T]=s(f),w=d(null),F={...er,..."photo"===u&&eo,..."video"===u&&ei,...g},[b,A]=l([]),[P,N]=l([]),[{progress:C},L]=eF(o,r),O=em(F.allowedFileTypes,F.maxFileSize),S=d([]),k=t(e=>{S.current.splice(0,0,e)},[]),M=t(e=>{var o=S.current.findIndex(o=>e===o);S.current.splice(o,1)},[]),R=t(()=>{var e=w.current;if(null==e)throw Error("useCustomPhotoUploadFlow: must render the supplied element");e.click()},[]),z=t(e=>{A(e),L(e).forEach((o,i)=>{o.then(o=>{N(a=>a.map(a=>a.uploadId===e[i].uploadId?{...a,result:o}:a))}).catch(o=>{var a=o?.uploaderProgressData,r=o?.originalError||o;N(o=>o.map(o=>o.uploadId===e[i].uploadId?{...o,result:{definition:{...e[i],uploadId:o.uploadId,uploaderProgressData:a},error:r}}:o))})})},[L]),B=t(e=>{var o=e.map(e=>({...e,uploadId:e.uploadId||E()})),i=o.filter(e=>!e?.error);m&&!1===m(i)||(N(e=>[...e,...o.map(e=>({uploadId:e.uploadId,result:e?.error?{fileName:e?.fileName,error:e?.error}:null}))]),z(i))},[z,m]),D=t(e=>{var o=e.map(e=>({...e,uploadId:e.uploadId||E()}));m&&!1===m(o)||(N(e=>[...e,...o.map(e=>({uploadId:e.uploadId,result:null}))]),z(o))},[z,m]);n(()=>{if(P.length>0&&P.every(e=>!!e.result)){var e=P.filter(e=>e.result?.mediaId).map(e=>e.result),o=P.filter(e=>e.result?.error).map(e=>e.result).map(e=>e.error);!h&&o[0]&&(o[0]instanceof Q?v({node:i(I,{cta:i(x,{trailing:!0,variant:"on-dark",onClick:()=>{D(b),T()},icon:y,children:"Click to retry"}),children:"Upload failed."}),timeout:1e4}):o[0]instanceof X&&c?c(R):v({node:i(I,{children:o[0].message||i(_,{id:"post_photo_upload_failed"})})})),h&&o.find(e=>e instanceof X)&&c&&c(R),(h||!o[0])&&S.current.find(o=>!1!==o(e,P)),A([]),N([])}},[P,b.length,h,T,v,c,R,b,D]);var $=t(e=>{Promise.allSettled(e.map(e=>O(e))).then(o=>{var i=e.map((e,i)=>"fulfilled"===o[i].status?{mediaType:ei.allowedFileTypes.includes(U(e.name))?"video":"photo",file:e,locationId:-1===F.locationId?null:F.locationId,description:"",isForCuration:F.isForCuration,isForUserReview:F.isForUserReview,isAllowedNonLoggedInUpload:F.isAllowedNonLoggedInUpload,pid:F.pid,pidAttr:F.pidAttr,uploadId:E()}:{fileName:e.name,error:o[i].reason,uploadId:E()}),a=i.find(e=>!!e?.error);if(a&&!h)throw a.error;(!a||h)&&B(i)})},[O,B,F.isForCuration,F.isForUserReview,F.isAllowedNonLoggedInUpload,F.locationId,F.pid,F.pidAttr,h]),{dragging:j}=eh($,b),W=p(()=>({photos:b,photosResultQueue:P,open:R,dragging:j,progress:C,selectFiles:$,uploadFiles:D,addPhotosUploadedCallback:k,removePhotosUploadedCallback:M}),[b,P,R,j,C,k,$,M,D]);return a(ea.Provider,{value:W,children:[e,i("input",{ref:w,type:"file",multiple:!F?.maxAllowedFiles||F.maxAllowedFiles>1,accept:F.allowedFileTypes.join(","),style:{display:"none"},onChange:e=>{e.preventDefault(),$(e.currentTarget.files?[...e.currentTarget.files].filter(Boolean):[]),e.currentTarget.value=""},"aria-hidden":!0,tabIndex:-1})]})},eP=e=>{var{addPhotosUploadedCallback:o,removePhotosUploadedCallback:i,...a}=s(ea),r=d(e);return r.current=e,n(()=>{if(null==r.current)return()=>{};var e=(e,o)=>!!r.current&&r.current(e,o);return o(e),()=>{i(e)}},[o,i]),a},ex=(e,o,i=e=>e)=>{var t=e.match(o);return t?.index!=null?a(r,{children:[e.substring(0,t.index),i(t[1]||t[0]),e.substring(t.index+t[0].length)]}):e},eN={dropZone:"wWxsJ e u j c z _E B2 BC",small:"GLyFA",large:"OlQdl",fileInput:"bAYEn Xd",disabled:"AxRyl",dragging:"kQZzc",cosmeticButton:"ViJpi Rd _S",cosmeticBorderlessButton:"GOYkZ Wd _S",keyboardMode:"kIOnU",touchOnly:"tMKCA",mouseOnly:"lVrpX"},eC=({plural:e})=>e?i(_,{id:"post_photo_upload_photos_button"}):i(_,{id:"confirmed_booker_upload_photo"}),eL=({variant:e="large",dragging:o,disabled:r,allowedFileTypes:t=[],onFileSelected:l,mediaType:d,multiple:n=!1,...s})=>{var p=j(),{localize:u}=v();return a("label",{className:W(eN.dropZone,Z(s),{[eN.small]:"small"===e,[eN.large]:"large"===e,[eN.dragging]:!r&&o,[eN.disabled]:r,[eN.keyboardMode]:p}),children:[i("input",{type:"file",multiple:n,accept:t.join(","),disabled:r,className:eN.fileInput,onChange:l,tabIndex:r?-1:0}),"small"===e&&a($,{variant:"supporting-01",children:[i("span",{className:eN.mouseOnly,children:et("video"===d?u.string("post_video_upload_another_video"):u.string("post_photo_upload_another_video"),/<\/> <span class="{sColorClass1}">(.*)<\/span>/,e=>i("span",{className:eN.cosmeticBorderlessButton,children:e}))}),i("span",{className:W(eN.touchOnly,eN.cosmeticBorderlessButton),children:"video"===d?i(_,{id:"add_more_videos_mw_uploader"}):i(_,{id:"add_more_photos_mw_uploader"})})]}),"large"===e&&a("div",{children:[i($,{variant:"button-01",marginY:"spacing-03",children:i("div",{className:eN.cosmeticButton,children:"video"===d?i(_,{id:"add_more_videos_mw_uploader"}):i(el,{plural:n})})}),a("div",{className:eN.mouseOnly,"aria-hidden":!0,children:[i($,{variant:"supporting-01",marginY:"spacing-03",children:i(_,{id:"post_photo_or_just_text"})}),i($,{variant:"title-05",marginY:"spacing-03",children:i(_,{id:"post_photo_drag_and_drop_from_desktop"})})]})]})]})},eE=({multipleMedia:e,mediaType:o,...a})=>{var r,{localize:t}=v();return r=e?"video"===o?t.string("new_videos_terms_of_use"):t.string("new_photos_terms_of_use"):"video"===o?t.string("new_video_terms_of_use"):t.string("new_photo_terms_of_use"),i("div",{className:W("yNxWj",Z(a)),children:i($,{variant:"supporting-01",elementType:"span",children:et(r,/<a .*>(.*)<\/a>/,e=>i(q,{theme:"inline",href:"/pages/terms.html",target:"_blank",children:e}))})})},eO=({mediaType:e,maxAllowedFiles:o,allowedFileTypes:r,maxFileSize:t,...l})=>{var{localize:d}=v(),n=w(),s="video"===e,p=`${d.string("mobile_help_center_url")}${s?"/articles/360024933773-Video-Guidelines":"/articles/200615067"}`,u=o>1?i(_,{id:"post_photo_tips_guidelines"}):null;return a("div",{className:Z(l),children:[i($,{variant:"title-05",marginBottom:"spacing-02",children:i(_,{id:"flash_uploader_tips_and_guidelines_10d8"})}),a("ul",{children:[i("li",{children:i($,{variant:"supporting-02",marginY:"spacing-01",children:s?i(_,{id:"video_upload_max_number",args:{nVideos:o}}):u})}),i("li",{children:i($,{variant:"supporting-02",marginY:"spacing-01",children:s?i(_,{id:"video_upload_video_formats_accepted",args:{sFileExtentions:r.join(" ")}}):i(_,{id:"post_photo_accepted_formats"})})}),i("li",{children:i($,{variant:"supporting-02",marginY:"spacing-01",children:i(_,{id:"file_size_limit_photo",args:{0:t/1024/1024}})})})]}),i($,{variant:"supporting-02",marginTop:"spacing-03",marginBottom:"spacing-05",children:et(s?d.string("video_upload_more_info_guidelines_link"):d.string("post_photo_more_info_2"),/<span>(.*)<\/span>/,e=>i(q,{theme:"inline",href:p,onClick:()=>{s||n({PhotoUploadFlow:{photoUploadWeb:{action:"guidelinesClick"}}})},target:"_blank",children:e}))})]})},eS={mediaUploadItem:"Cmrpl",withMetadata:"KZHqm",preview:"NxRph",mediaWrapper:"hakMy",media:"ONDNs _R Gp w",deleteButton:"RAxBx",progress:"WBEFN",metadata:"wvYam",locationSelector:"FrvbG"},ek=({media:e,index:o,mediaCount:r,withMetadata:d=!0,isForCuration:s=!1,hasPresetLocation:u=!1,progress:c,onChange:m,onDelete:h})=>{var{localize:g}=v(),[f,I]=l(!1),[T,w]=l(!1),F=p(()=>URL.createObjectURL(e.file),[e.file]);n(()=>()=>URL.revokeObjectURL(F),[F]);var[U,b]=l(null),A=t(()=>h&&h(o),[h,o]),y=t(i=>{I(!1),m(o,{...e,description:i.currentTarget.value})},[o,e,m]),P=t(i=>{b(i),w(!0),m(o,{...e,locationId:i?.locationId})},[o,e,m]),x=t(()=>{b(null),w(!1),m(o,{...e,locationId:null})},[o,e,m]),C=f&&!e.description?i(_,{id:"uploader_error_required_field"}):null,L=T&&(null==e.locationId||e.locationId<=0)?i(_,{id:"uploader_error_required_field"}):null,E=null!=c,O="video"===e.mediaType?i(_,{id:"post_video_video_count_text",args:{nCurrentVideoCount:o+1,nTotalVideoCount:r}}):i(_,{id:"post_photo_video_count_text",args:{nCurrentphotoCount:o+1,nTotalphotoCount:r}});return a("div",{className:W(eS.mediaUploadItem,{[eS.withMetadata]:d}),children:[a("div",{className:eS.preview,children:[r>1&&i($,{variant:"title-05",marginBottom:"spacing-02",children:O}),a("div",{className:eS.mediaWrapper,children:["photo"===e.mediaType&&i("img",{className:eS.media,src:F,alt:""}),"video"===e.mediaType&&a("video",{controls:!0,controlsList:"nodownload nofullscreen",className:eS.media,children:[i("track",{default:!0,kind:"captions"}),i("source",{src:F,type:"video/mp4"})]}),!E&&i("div",{className:eS.deleteButton,children:i(N,{size:"small",variant:"dark",icon:Y,"aria-label":g.string("mobile_delete"),onClick:A})}),null!=c&&i("div",{className:eS.progress,children:i(G,{numSteps:e.file.size,currentStep:c})})]})]}),d&&a("div",{className:eS.metadata,children:[i(K,{id:`media-upload-description-${o}`,variant:"five-line",label:i($,{variant:"title-05",children:i(_,{id:"post_photo_add_description_v2_part_1"})}),placeholder:"video"===e.mediaType?g.string("post_video_add_description_v2_part_2"):g.string("post_photo_add_description_v2_part_2"),maxLength:500,characterCountType:C?void 0:"max",required:!0,value:e.description,state:E?"disabled":C?"error":"enabled",errorText:C,onChange:y,onBlur:()=>I(!0),marginBottom:"spacing-03"}),!s&&!u&&i("div",{className:eS.locationSelector,children:null==U?i(V,{size:"small",errorText:L,placeholder:g.string("photo_uploader_add_a_location_tag"),onTextInputChanged:()=>w(!1),onBlur:()=>w(!0),onSelect:P}):i(N,{size:"small",variant:"dark",icon:Y,textPosition:"lead","aria-label":`${U.searchText}. ${g.string("remove_location_cf6")}`,disabled:E,onClick:x,children:U.title})})]})]})},eM=({locationId:e=-1})=>{var[o]=s(f),l=D(),d={...eo,locationId:e},{media:p,error:u,dragging:m,uploading:h,progress:g,canAddMore:v,canSubmit:T,onFileSelected:w,onMediaChanged:F,onMediaDeleted:U,onSubmit:b,resetMediaState:A}=eA(d),y=p.length>0,x=p.length>1;n(()=>{-1===e&&A()},[A,e]);var N=t(()=>{l({}).then(()=>{b().then(e=>{null!=e&&(A(),o({node:i(I,{children:i(_,{id:"success_repost_photo"})})}))})})},[b,o,A,l]),C=x?i(_,{id:"ugc_uploader_photo_v3"}):i(_,{id:"ugc_uploader_photo_v2"});return a(r,{children:[v&&i(ed,{variant:y?"small":"large",dragging:m,disabled:h||-1===e,onFileSelected:w,marginBottom:"spacing-05",mediaType:d.mediaType,multiple:!0}),null!=u&&i($,{variant:"supporting-01",color:"dangerText",marginY:"spacing-05",children:u}),p.map((e,o)=>i(c,{children:i(ep,{media:e,index:o,mediaCount:p.length,withMetadata:d.withMetadata,isForCuration:d.isForCuration,hasPresetLocation:null!=d.locationId&&d.locationId>0,progress:h&&null!=g?g[o]:void 0,onChange:F,onDelete:U})},`${e.file.name}/${e.file.size}`)),y?a(r,{children:[i(en,{multipleMedia:x,mediaType:d.mediaType,marginTop:"spacing-05",marginBottom:"spacing-03"}),i(P,{variant:"primary",size:"medium",disabled:!T,onClick:N,children:C})]}):i(es,{mediaType:d.mediaType,maxAllowedFiles:d.maxAllowedFiles,allowedFileTypes:d.allowedFileTypes,maxFileSize:d.maxFileSize,marginTop:"spacing-05"})]})},eR=({onUploadSuccess:e,onUploadCanceled:o,...l})=>{var d={...ei,...l},{media:n,error:s,dragging:p,uploading:u,progress:m,canAddMore:h,canSubmit:g,onFileSelected:v,onMediaChanged:f,onMediaDeleted:I,onSubmit:T}=eA(d),w=n.length>0,F=n.length>1,U=t(()=>{T().then(o=>{null!=e&&null!=o&&e(o)})},[T,e]);return a(r,{children:[h&&i(ed,{variant:"large",dragging:p,disabled:u,onFileSelected:v,marginBottom:"spacing-05",mediaType:d.mediaType}),null!=s&&i($,{variant:"supporting-01",color:"dangerText",marginY:"spacing-05",children:s}),n.map((e,o)=>i(c,{children:i(ep,{media:e,index:o,mediaCount:n.length,withMetadata:d.withMetadata,isForCuration:d.isForCuration,hasPresetLocation:null!=d.locationId&&d.locationId>0,progress:u&&null!=m?m[o]:void 0,onChange:f,onDelete:I})},`${e.file.name}/${e.file.size}`)),w?a(r,{children:[i(en,{multipleMedia:F,mediaType:d.mediaType,marginTop:"spacing-05",marginBottom:"spacing-03"}),i(P,{variant:"primary",size:"medium",disabled:!g,onClick:U,children:i(_,{id:"b2b_media_upload_text"})})]}):i(es,{mediaType:d.mediaType,maxAllowedFiles:d.maxAllowedFiles,allowedFileTypes:d.allowedFileTypes,maxFileSize:d.maxFileSize,marginTop:"spacing-05"}),i(P,{variant:"primary",size:"medium",onClick:o,marginLeft:w?"spacing-01":void 0,children:i(_,{id:"mc_plus_cancel"})})]})},ez=(e=Object.freeze({}))=>{var o=w(),{login:a}=T(),[r]=s(f),l=d(()=>{}),{open:n}=g(({close:o})=>i(F,{children:i(m,{children:i(eu,{...e,onUploadCanceled:()=>{o(),l.current([])},onUploadSuccess:(...a)=>{o(),r({node:i(I,{children:"video"===e.mediaType?i(_,{id:"success_repost_video"}):i(_,{id:"success_repost_photo"})})}),l.current(...a)}})})}),{},[e,r]);return t(()=>a({flow:"CORE_COMBINED"}).then(()=>(n(),"video"!==e.mediaType&&o({PhotoUploadFlow:{photoUploadWeb:{action:"opened"}}}),new Promise(e=>{l.current=e}))),[a,n,o,e.mediaType])};return[()=>{e("FileSizeError",H=class extends Error{}),e("FileTypeError",J=class extends Error{}),Q=class extends Error{},X=class extends Error{},ee=class extends Error{constructor(e,o){super(),ev(this,"uploaderProgressData",void 0),ev(this,"originalError",void 0),this.uploaderProgressData=e,this.originalError=o}},eo={mediaType:"photo",withMetadata:!0,isForCuration:!1,allowedFileTypes:[".jpg",".jpeg",".gif",".png"],maxFileSize:b,maxAllowedFiles:10,locationId:-1},ei={mediaType:"video",withMetadata:!0,isForCuration:!1,allowedFileTypes:[".mp4",".m4v",".mov"],maxFileSize:A,maxAllowedFiles:5,locationId:-1},ea=u({photos:[],photosResultQueue:[],open:()=>{},dragging:!1,progress:null,selectFiles:()=>{},uploadFiles:()=>{},addPhotosUploadedCallback:()=>{},removePhotosUploadedCallback:()=>{}}),er={withMetadata:!0,isForCuration:!1,allowedFileTypes:[...eo.allowedFileTypes,...ei.allowedFileTypes],maxFileSize:A,locationId:-1},et=ex,el=eC,ed=eL,en=eE,es=eO,ep=ek,eu=h(()=>o("1vdjnw")),e({CustomPhotoUploadProvider:ey,D:ed,FileSizeError:H,FileTypeError:J,M:ep,PostPhotosUploader:eM,T:en,VideoUploader:eR,a:eo,b:es,d:ei,u:eA,useCustomPhotoUpload:eP,useMediaUploader:ez})},[e=>(i=e.jsx,a=e.jsxs,r=e.Fragment),e=>(t=e.useCallback,l=e.useState,d=e.useRef,n=e.useEffect,s=e.useContext,p=e.useMemo,u=e.createContext,c=e.Fragment,m=e.Suspense,h=e.lazy),e=>g=e.useVDOMPortal,e=>(_=e.default,v=e.useLocalize),e=>(f=e.Toast,I=e.ToastItem),e=>T=e.default,e=>w=e.useInteractionLogger,e=>F=e.ErrorBoundary,e=>(U=e.fileExtension,b=e.maxImageUploadSizeInBytes,A=e.maxVideoUploadSizeInBytes),e=>y=e.default,e=>(P=e.default,x=e.BorderlessButton,N=e.CircularButton),e=>C=e.useWindow,e=>L=e.useMutation,e=>E=e.uuid,e=>(O=e.useAddAttempt,S=e.WarPhotoCounter,k=e.useMarkAsSuccess,M=e.useMarkAsFailure,R=e.useMarkAsRateLimitedError,z=e.useMarkAsClientAborted,B=e.useMarkAsClientError),e=>D=e.default,e=>$=e.default,e=>j=e.useKeyboardNavigationMode,e=>W=e.default,e=>Z=e.margin,e=>q=e.default,e=>V=e.LocationSelector,e=>Y=e.default,e=>G=e.default,e=>K=e.TextArea]]},["121h32","1o4yt4","14euae","17thqz","tr3542","rdycz1","32pwc7","183pm0","714tj5","1v5ce8","jppfwt","ltllz9","1mqwhq","1eww82","27fomg","lchj5q","1essqv","12r4qu","fkji80","gw8uw6","lr6tb6","132kj4","1qkjm8","1qndsd","1u3aio"]]);
