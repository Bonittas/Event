(this.$WP=this.$WP||[]).push(["1iyqcw",(e,t)=>{var r,o,i,n,a,s,p,c,l,u,d,f=e=>e.photo&&e.photo.photoSizes[e.photo.photoSizes.length-1]?e.photo.photoSizes[e.photo.photoSizes.length-1]:null,m=e=>[e.owner||e.userProfile,...(e.collaborators||[]).map(e=>e.user)].filter(Boolean),v=(e,t)=>m(e).some(e=>e.isMe||e.userId&&e.userId===t||e.id&&e.id===t),y=e=>e.owner?.isMe?"OWNER":e&&v(e)?"COLLABORATOR":"PUBLIC",h=(e,t,r,o)=>{var i=m(e);if(i=i.slice(0,t),r>0){var n=0;i=i.filter(e=>(n=e.displayName.length+n)<r)}return o&&(i=i.reverse()),i},P=(e,t)=>[...t||[]].sort((e,t)=>e.created>t.created?1:-1),T=e=>e?.owner?.isMe,_=e=>e.owner&&e.owner.isMe?"OWNER":v(e)?"COLLABORATOR":"VIEWER",I=(e,t)=>(e.items||[]).find(e=>{var r=e.reference&&e.reference.type&&e.reference.type.toLowerCase(),o=e.reference?.id,i=t.type.toLowerCase(),n=t.id.toString(),a="originalObject"in t&&t.originalObject?.type?.toLowerCase(),s="originalObject"in t&&t.originalObject?.id?.toString();return r===i&&o===n||r===a&&o===s}),O=(e,t)=>{var r=I(e,t);return r?r.id:null},w={locationinformation:"location",attractionproductinformation:"attractionProduct",forumpost:"post",tripitem:"savesItem",linkpost:"link",linkpost_linkpostv2:"link",photo:"photo",video:"video",review:"review",repost:"repost",trip:"bundleSave",tripnotes_tripnote:"note"},b={locationinformation:"LOCATION",attractionproductinformation:"ATTRACTIONPRODUCT",forumpost:"POST",tripitem:"SAVESITEM",linkpost:"LINK",photo:"PHOTO",video:"VIDEO",review:"REVIEW",repost:"REPOST",trip:"TRIPCONTENT"},g=e=>({statQuery:e}),S=e=>w[e.toLowerCase()],R=e=>b[e.toLowerCase()],L=["LocationInformation","AttractionProductInformation","ForumPost","LinkPost","LinkPost_LinkPostV2","Review","Photo","Video","Repost","Trip","TripNotes_TripNote"],k=e=>e.locationId??e.attractionProductId??e.postId??e.repostId??e.linkPostId??e.id??void 0,j=e=>{switch(e.__typename){case"AttractionProductInformation":case"LocationInformation":return[e];case"Photo":case"Review":return[e.location];case"Video":return e.orderedLocations;default:return[]}},C=(e,t)=>{if(!e)return null;var r=k(e),o=e.__typename?S(e.__typename):null;if(null!=r&&null!=o){if(L.includes(e.__typename))return{type:o,id:r};var i={id:e.reference.id,type:"attractionproduct"===e.reference.type?"attractionProduct":e.reference.type};if("TripItem"===e.__typename&&e.reference&&e.reference.id&&e.reference.type)return t&&"note"!==i.type?i:{type:o,id:r,originalObject:i}}return null},A=e=>({id:`${e.id}`,type:e.type}),E=(e,t,r)=>`/Trips/${e}${t?`?itemId=${t}`:""}${r?`#/Tab/${r}`:""}`,N=e=>{var[,t,r]=e.split("/");return"Tab"!==t?null:Object.values(u).includes(r)?r:null},F=e=>{var t=d[e.type];return t?{...e,query:t.statQuery,variables:{ids:[Number(e.id)]}}:null},V=e=>["LinkPost","Photo","Review","Video"].includes(e?.object?.repostedObject?.__typename),z=(e,t)=>{if("_blank"===t){var r=window.open("about:blank",t);return()=>{null!=r&&(r.location=e)}}return()=>{window.open(e,t)}};function B(e,t){return e.reduce((e,r)=>(t(r)?e[0].push(r):e[1].push(r),e),[[],[]])}var $=e=>{if(!("__typename"in e))return[];if("LinkPost_LinkPostV2"===e.__typename){var t=e.preview?.media??[];if(!t.length)return[];var[r,o]=B(t.reduce((e,t)=>t&&t.object?[...e,t]:e,[]).sort((e,t)=>t.id-e.id),e=>"LinkPreview_PhotoRefV2"===e.__typename);if(r.length)return r[0]?.object?.photoSizes??[];if(o.length)return[o[0].object]}if("LinkPost"===e.__typename){var i=e.preview&&e.preview.media||[];if(0===i.length)return[];var n=e=>("Photo"===e.__typename?e.photoId:e.previewId)??0,[a,s]=B(i.filter(Boolean).sort((e,t)=>n(t)-n(e)),e=>e?.__typename==="Photo");if(a.length)return a[0]?.photoSizes??[];if(s.length)return[s[0]]}return[]};return[()=>{d=Object.freeze({location:g(r),attractionProduct:g(o),post:g(i),savesItem:g(n),link:g(a),review:g(s),photo:g(p),video:g(c),repost:g(l)}),e({buildPublicTripShareUrl:E,getCommentsForDisplay:P,getItemByReference:I,getItemIdByReference:O,getPhotoSizesForLinkPost:$,getQueryReferenceTypeFromObjectType:R,getReferenceTypeFromObjectType:S,getTripCoverPhoto:f,getTripPageTabFromFragment:N,getTripUsers:m,getTripUsersForDisplay:h,isOwner:T,isRepostSaveable:V,isTripUser:v,locationsForItem:j,objectStatisticQuery:F,toReference:A,toSavesObject:C,userRelation:_,userTypeFromTrip:y,windowOpener:z})},[e=>(r=e.LocationStatistics,o=e.AttractionStatistics,i=e.ForumStatistics,n=e.TripItemStatistics,a=e.LinkPostStatistics,s=e.ReviewStatistics,p=e.PhotoStatistics,c=e.VideoStatistics,l=e.RepostStatistics),e=>u=e.TRIP_PAGE_TAB_OPTIONS]]},["ag9b0s","3309mt"]]);
